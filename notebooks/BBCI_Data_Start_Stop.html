

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Read and Decode BBCI Data with Start-Stop-Markers &mdash; Braindecode 0.2.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Braindecode 0.2.1 documentation" href="../index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Braindecode
          

          
          </a>

          
            
            
              <div class="version">
                0.2.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="TrialWise_Decoding.html">Trialwise Decoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cropped_Decoding.html">Cropped Decoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="Experiment_Class.html">Using the Experiment Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization/Perturbation.html">Amplitude Perturbation Visualization</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.datautil.html">braindecode.datautil package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.experiments.html">braindecode.experiments package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.mne_ext.html">braindecode.mne_ext package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.models.html">braindecode.models package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.torch_ext.html">braindecode.torch_ext package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.visualization.html">braindecode.visualization package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Braindecode</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Read and Decode BBCI Data with Start-Stop-Markers</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/BBCI_Data_Start_Stop.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Read-and-Decode-BBCI-Data-with-Start-Stop-Markers">
<h1>Read and Decode BBCI Data with Start-Stop-Markers<a class="headerlink" href="#Read-and-Decode-BBCI-Data-with-Start-Stop-Markers" title="Permalink to this headline">¶</a></h1>
<p>This tutorial shows how to read and decode BBCI data with start and stop
markers. The data loading part is more complicated and it is advised to
read the other tutorials before.</p>
<div class="section" id="Setup-logging-to-see-outputs">
<h2>Setup logging to see outputs<a class="headerlink" href="#Setup-logging-to-see-outputs" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> </span><span class="si">%(levelname)s</span><span class="s1"> : </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
                     <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>

</pre></div>
</div>
</div>
</div>
<div class="section" id="Load-and-preprocess-data">
<h2>Load and preprocess data<a class="headerlink" href="#Load-and-preprocess-data" title="Permalink to this headline">¶</a></h2>
<p>This is a bit more complicated than before since we have to add breaks
etc. Here I now opt to add breaks do all preprocessings per run and only
later combine them together.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.datautil.splitters</span> <span class="k">import</span> <span class="n">concatenate_sets</span>
<span class="kn">from</span> <span class="nn">braindecode.datautil.trial_segment</span> <span class="k">import</span> <span class="n">create_signal_target_from_raw_mne</span><span class="p">,</span> <span class="n">add_breaks</span>
<span class="kn">from</span> <span class="nn">braindecode.datasets.bbci</span> <span class="k">import</span> <span class="n">load_bbci_sets_from_folder</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="k">import</span> <span class="n">deepcopy</span>
<span class="kn">from</span> <span class="nn">braindecode.mne_ext.signalproc</span> <span class="k">import</span> <span class="n">resample_cnt</span><span class="p">,</span> <span class="n">mne_apply</span>
<span class="kn">from</span> <span class="nn">braindecode.datautil.signalproc</span> <span class="k">import</span> <span class="n">lowpass_cnt</span>
<span class="kn">from</span> <span class="nn">braindecode.datautil.signalproc</span> <span class="k">import</span> <span class="n">exponential_running_standardize</span>

<span class="k">def</span> <span class="nf">create_cnts</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">runs</span><span class="p">,</span> <span class="n">name_to_start_code</span><span class="p">,</span> <span class="n">name_to_stop_code</span><span class="p">,</span> <span class="n">break_start_offset_ms</span><span class="p">,</span>
              <span class="n">break_stop_offset_ms</span><span class="p">,</span> <span class="n">break_start_code</span><span class="p">,</span> <span class="n">break_stop_code</span><span class="p">):</span>
    <span class="c1"># Load data</span>
    <span class="n">cnts</span> <span class="o">=</span> <span class="n">load_bbci_sets_from_folder</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">runs</span><span class="p">)</span>

    <span class="c1"># Now do some preprocessings:</span>
    <span class="c1"># Adding breaks, resampling to 250 Hz, lowpass below 38, eponential standardization</span>
    <span class="n">break_start_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">break_stop_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>

    <span class="n">new_cnts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">cnt</span> <span class="ow">in</span> <span class="n">cnts</span><span class="p">:</span>
        <span class="c1"># Only take some channels</span>
        <span class="c1">#cnt = cnt.drop_channels([&#39;STI 014&#39;]) # This would remove stimulus channel</span>
        <span class="n">cnt</span> <span class="o">=</span> <span class="n">cnt</span><span class="o">.</span><span class="n">pick_channels</span><span class="p">([</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;CPz&#39;</span> <span class="s1">&#39;C4&#39;</span><span class="p">])</span>
        <span class="c1"># add breaks</span>
        <span class="n">new_events</span> <span class="o">=</span> <span class="n">add_breaks</span><span class="p">(</span>
            <span class="n">cnt</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;events&#39;</span><span class="p">],</span> <span class="n">cnt</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;sfreq&#39;</span><span class="p">],</span>
            <span class="n">break_start_code</span><span class="o">=</span><span class="n">break_start_code</span><span class="p">,</span> <span class="n">break_stop_code</span><span class="o">=</span><span class="n">break_stop_code</span><span class="p">,</span>
            <span class="n">name_to_start_codes</span><span class="o">=</span><span class="n">name_to_start_code</span><span class="p">,</span> <span class="n">name_to_stop_codes</span><span class="o">=</span><span class="n">name_to_stop_code</span><span class="p">,</span>
            <span class="n">min_break_length_ms</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">max_break_length_ms</span><span class="o">=</span><span class="mi">9000</span><span class="p">)</span>
        <span class="n">n_break_start_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cnt</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;sfreq&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">break_start_offset_ms</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">)</span>
        <span class="n">n_break_stop_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cnt</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;sfreq&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">break_stop_offset_ms</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">)</span>
        <span class="c1"># lets add some offset to break start and stop</span>
        <span class="c1"># new_events[:,2] contains event codes, new_events[:,0] the sample indices</span>
        <span class="c1"># new_events[:,1] is always 0 for my loading of BBCI data</span>
        <span class="n">new_events</span><span class="p">[</span><span class="n">new_events</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">break_start_code</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">n_break_start_offset</span>
        <span class="c1"># 0.5 sec for break stop</span>
        <span class="n">new_events</span><span class="p">[</span><span class="n">new_events</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">break_stop_code</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+=</span>  <span class="n">n_break_stop_offset</span>
        <span class="n">cnt</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;events&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_events</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Preprocessing....&quot;</span><span class="p">)</span>
        <span class="n">cnt</span> <span class="o">=</span> <span class="n">mne_apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">lowpass_cnt</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span><span class="n">cnt</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;sfreq&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">cnt</span><span class="p">)</span>
        <span class="n">cnt</span> <span class="o">=</span> <span class="n">resample_cnt</span><span class="p">(</span><span class="n">cnt</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>
        <span class="c1"># mne apply will apply the function to the data (a 2d-numpy-array)</span>
        <span class="c1"># have to transpose data back and forth, since</span>
        <span class="c1"># exponential_running_standardize expects time x chans order</span>
        <span class="c1"># while mne object has chans x time order</span>
        <span class="n">cnt</span> <span class="o">=</span> <span class="n">mne_apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">exponential_running_standardize</span><span class="p">(</span>
            <span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">init_block_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">factor_new</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
            <span class="n">cnt</span><span class="p">)</span>
        <span class="n">new_cnts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cnt</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_cnts</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>
<span class="n">name_to_start_code</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;Right Hand&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Feet&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;Rotation&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Words&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">])])</span>

<span class="n">name_to_stop_code</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;Right Hand&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">30</span><span class="p">]),</span>
        <span class="p">(</span><span class="s1">&#39;Feet&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">30</span><span class="p">]),</span>
        <span class="p">(</span><span class="s1">&#39;Rotation&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">30</span><span class="p">]),</span>
        <span class="p">(</span><span class="s1">&#39;Words&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">30</span><span class="p">])])</span>

<span class="n">break_start_offset_ms</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">break_stop_offset_ms</span> <span class="o">=</span> <span class="o">-</span><span class="mi">500</span>
<span class="c1"># pick some numbers that were not used before/do not exist in markers</span>
<span class="n">break_start_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">break_stop_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="n">train_runs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">train_cnts</span> <span class="o">=</span> <span class="n">create_cnts</span><span class="p">(</span><span class="s1">&#39;/home/schirrmr/data/robot-hall/AnLa/AnLaNBD1R01-8/&#39;</span><span class="p">,</span>
                         <span class="n">train_runs</span><span class="p">,</span>
                         <span class="n">name_to_start_code</span><span class="p">,</span>
                         <span class="n">name_to_stop_code</span><span class="p">,</span> <span class="n">break_start_offset_ms</span><span class="p">,</span>
                         <span class="n">break_stop_offset_ms</span><span class="p">,</span> <span class="n">break_start_code</span><span class="p">,</span> <span class="n">break_stop_code</span><span class="p">)</span>

<span class="n">name_to_code_with_breaks</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">name_to_start_code</span><span class="p">)</span>
<span class="n">name_to_code_with_breaks</span><span class="p">[</span><span class="s1">&#39;Break&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">break_start_code</span>
<span class="n">name_to_stop_code_with_breaks</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">name_to_stop_code</span><span class="p">)</span>
<span class="n">name_to_stop_code_with_breaks</span><span class="p">[</span><span class="s1">&#39;Break&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">break_stop_code</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2017-09-04 17:17:37,895 INFO : Loading /home/schirrmr/data/robot-hall/AnLa/AnLaNBD1R01-8/AnLaNBD1S001R01_1-1_250Hz.BBCI.mat
Creating RawArray with float64 data, n_channels=64, n_times=151350
    Range : 0 ... 151349 =      0.000 ...   605.396 secs
Ready.
2017-09-04 17:17:38,880 INFO : Loading /home/schirrmr/data/robot-hall/AnLa/AnLaNBD1R01-8/AnLaNBD1S001R02_1-1_250Hz.BBCI.mat
Creating RawArray with float64 data, n_channels=64, n_times=153500
    Range : 0 ... 153499 =      0.000 ...   613.996 secs
Ready.
2017-09-04 17:17:39,855 INFO : Loading /home/schirrmr/data/robot-hall/AnLa/AnLaNBD1R01-8/AnLaNBD1S001R03_1-1_250Hz.BBCI.mat
Creating RawArray with float64 data, n_channels=64, n_times=180700
    Range : 0 ... 180699 =      0.000 ...   722.796 secs
Ready.
2017-09-04 17:17:41,062 INFO : Preprocessing....
2017-09-04 17:17:41,070 INFO : Just copying data, no resampling, since new sampling rate same.
2017-09-04 17:17:41,166 INFO : Preprocessing....
2017-09-04 17:17:41,171 INFO : Just copying data, no resampling, since new sampling rate same.
2017-09-04 17:17:41,277 INFO : Preprocessing....
2017-09-04 17:17:41,282 INFO : Just copying data, no resampling, since new sampling rate same.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">test_runs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>
<span class="n">test_cnts</span> <span class="o">=</span> <span class="n">create_cnts</span><span class="p">(</span><span class="s1">&#39;/home/schirrmr/data/robot-hall/AnLa/AnLaNBD1R09-10/&#39;</span><span class="p">,</span> <span class="n">test_runs</span><span class="p">,</span> <span class="n">name_to_start_code</span><span class="p">,</span>
           <span class="n">name_to_stop_code</span><span class="p">,</span> <span class="n">break_start_offset_ms</span><span class="p">,</span>
              <span class="n">break_stop_offset_ms</span><span class="p">,</span> <span class="n">break_start_code</span><span class="p">,</span> <span class="n">break_stop_code</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2017-09-04 17:17:41,349 INFO : Loading /home/schirrmr/data/robot-hall/AnLa/AnLaNBD1R09-10/AnLaNBD1S001R09_1-1_250Hz.BBCI.mat
Creating RawArray with float64 data, n_channels=64, n_times=152050
    Range : 0 ... 152049 =      0.000 ...   608.196 secs
Ready.
2017-09-04 17:17:42,321 INFO : Loading /home/schirrmr/data/robot-hall/AnLa/AnLaNBD1R09-10/AnLaNBD1S001R10_1-1_250Hz.BBCI.mat
Creating RawArray with float64 data, n_channels=64, n_times=151100
    Range : 0 ... 151099 =      0.000 ...   604.396 secs
Ready.
2017-09-04 17:17:43,336 INFO : Preprocessing....
2017-09-04 17:17:43,340 INFO : Just copying data, no resampling, since new sampling rate same.
2017-09-04 17:17:43,436 INFO : Preprocessing....
2017-09-04 17:17:43,440 INFO : Just copying data, no resampling, since new sampling rate same.
</pre></div></div>
</div>
</div>
<div class="section" id="Create-the-model">
<h2>Create the model<a class="headerlink" href="#Create-the-model" title="Permalink to this headline">¶</a></h2>
<p>We already create the model now, since we need to know the receptive
field size for properly cutting out the data to predict. We need to cut
out data starting at -receptive_field_size samples before the first
sample we want to predict.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.models.shallow_fbcsp</span> <span class="k">import</span> <span class="n">ShallowFBCSPNet</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="k">import</span> <span class="n">nn</span>
<span class="kn">from</span> <span class="nn">braindecode.torch_ext.util</span> <span class="k">import</span> <span class="n">set_random_seeds</span>
<span class="kn">from</span> <span class="nn">braindecode.models.util</span> <span class="k">import</span> <span class="n">to_dense_prediction_model</span>

<span class="c1"># Set if you want to use GPU</span>
<span class="c1"># You can also use torch.cuda.is_available() to determine if cuda is available on your machine.</span>
<span class="n">cuda</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">set_random_seeds</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">20170629</span><span class="p">,</span> <span class="n">cuda</span><span class="o">=</span><span class="n">cuda</span><span class="p">)</span>

<span class="c1"># This will determine how many crops are processed in parallel</span>
<span class="n">input_time_length</span> <span class="o">=</span> <span class="mi">650</span>
<span class="n">in_chans</span> <span class="o">=</span> <span class="n">train_cnts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># final_conv_length determines the size of the receptive field of the ConvNet</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ShallowFBCSPNet</span><span class="p">(</span><span class="n">in_chans</span><span class="o">=</span><span class="n">in_chans</span><span class="p">,</span> <span class="n">n_classes</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">input_time_length</span><span class="o">=</span><span class="n">input_time_length</span><span class="p">,</span>
                        <span class="n">final_conv_length</span><span class="o">=</span><span class="mi">29</span><span class="p">)</span><span class="o">.</span><span class="n">create_network</span><span class="p">()</span>
<span class="n">to_dense_prediction_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="k">if</span> <span class="n">cuda</span><span class="p">:</span>
    <span class="n">model</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<span class="kn">from</span> <span class="nn">braindecode.torch_ext.util</span> <span class="k">import</span> <span class="n">np_to_var</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># determine output size</span>
<span class="n">test_input</span> <span class="o">=</span> <span class="n">np_to_var</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">in_chans</span><span class="p">,</span> <span class="n">input_time_length</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="k">if</span> <span class="n">cuda</span><span class="p">:</span>
    <span class="n">test_input</span> <span class="o">=</span> <span class="n">test_input</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">test_input</span><span class="p">)</span>
<span class="n">n_preds_per_input</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:d}</span><span class="s2"> predictions per input/trial&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n_preds_per_input</span><span class="p">))</span>
<span class="n">n_receptive_field</span> <span class="o">=</span> <span class="n">input_time_length</span> <span class="o">-</span> <span class="n">n_preds_per_input</span>
<span class="n">receptive_field_ms</span> <span class="o">=</span> <span class="n">n_receptive_field</span> <span class="o">*</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="n">train_cnts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;sfreq&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Receptive field: </span><span class="si">{:d}</span><span class="s2">/</span><span class="si">{:.2f}</span><span class="s2"> (samples/ms)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n_receptive_field</span><span class="p">,</span>
                                                      <span class="n">receptive_field_ms</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
132 predictions per input/trial
Receptive field: 518/2072.00 (samples/ms)
</pre></div></div>
</div>
<div class="section" id="Create-SignalAndTarget-Sets">
<h3>Create SignalAndTarget Sets<a class="headerlink" href="#Create-SignalAndTarget-Sets" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">train_sets</span> <span class="o">=</span> <span class="p">[</span><span class="n">create_signal_target_from_raw_mne</span><span class="p">(</span><span class="n">cnt</span><span class="p">,</span> <span class="n">name_to_code_with_breaks</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="n">receptive_field_ms</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                                         <span class="n">name_to_stop_code_with_breaks</span><span class="p">)</span> <span class="k">for</span> <span class="n">cnt</span> <span class="ow">in</span> <span class="n">train_cnts</span><span class="p">]</span>
<span class="n">train_set</span> <span class="o">=</span> <span class="n">concatenate_sets</span><span class="p">(</span><span class="n">train_sets</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2017-09-04 17:17:47,054 WARNING : No end marker for start marker code 1 at sample 150051 found.
2017-09-04 17:17:47,054 INFO : Trial per class:
Counter({&#39;Right Hand&#39;: 29, &#39;Words&#39;: 21, &#39;Feet&#39;: 19, &#39;Break&#39;: 18, &#39;Rotation&#39;: 4})
2017-09-04 17:17:47,059 WARNING : No end marker for start marker code 4 at sample 152701 found.
2017-09-04 17:17:47,060 INFO : Trial per class:
Counter({&#39;Feet&#39;: 31, &#39;Words&#39;: 26, &#39;Break&#39;: 20, &#39;Right Hand&#39;: 18, &#39;Rotation&#39;: 6})
2017-09-04 17:17:47,064 WARNING : No end marker for start marker code 1 at sample 179301 found.
2017-09-04 17:17:47,065 INFO : Trial per class:
Counter({&#39;Feet&#39;: 38, &#39;Words&#39;: 29, &#39;Break&#39;: 23, &#39;Right Hand&#39;: 22, &#39;Rotation&#39;: 7})
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">test_sets</span> <span class="o">=</span> <span class="p">[</span><span class="n">create_signal_target_from_raw_mne</span><span class="p">(</span><span class="n">cnt</span><span class="p">,</span> <span class="n">name_to_code_with_breaks</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="n">receptive_field_ms</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                                         <span class="n">name_to_stop_code_with_breaks</span><span class="p">)</span> <span class="k">for</span> <span class="n">cnt</span> <span class="ow">in</span> <span class="n">test_cnts</span><span class="p">]</span>
<span class="n">test_set</span> <span class="o">=</span> <span class="n">concatenate_sets</span><span class="p">(</span><span class="n">test_sets</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2017-09-04 17:17:47,090 WARNING : No end marker for start marker code 4 at sample 150601 found.
2017-09-04 17:17:47,091 INFO : Trial per class:
Counter({&#39;Feet&#39;: 24, &#39;Right Hand&#39;: 24, &#39;Words&#39;: 19, &#39;Break&#39;: 19, &#39;Rotation&#39;: 10})
2017-09-04 17:17:47,095 WARNING : No end marker for start marker code 4 at sample 149601 found.
2017-09-04 17:17:47,096 INFO : Trial per class:
Counter({&#39;Feet&#39;: 30, &#39;Right Hand&#39;: 22, &#39;Words&#39;: 21, &#39;Break&#39;: 20, &#39;Rotation&#39;: 8})
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.datautil.splitters</span> <span class="k">import</span> <span class="n">split_into_two_sets</span>

<span class="n">train_set</span><span class="p">,</span> <span class="n">valid_set</span> <span class="o">=</span> <span class="n">split_into_two_sets</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> <span class="n">first_set_fraction</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Setup-optimizer-and-iterator">
<h2>Setup optimizer and iterator<a class="headerlink" href="#Setup-optimizer-and-iterator" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">torch</span> <span class="k">import</span> <span class="n">optim</span>

<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.datautil.iterators</span> <span class="k">import</span> <span class="n">CropsFromTrialsIterator</span>
<span class="n">iterator</span> <span class="o">=</span> <span class="n">CropsFromTrialsIterator</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span><span class="n">input_time_length</span><span class="o">=</span><span class="n">input_time_length</span><span class="p">,</span>
                                  <span class="n">n_preds_per_input</span><span class="o">=</span><span class="n">n_preds_per_input</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Setup-Monitors,-Loss-function,-Stop-Criteria">
<h2>Setup Monitors, Loss function, Stop Criteria<a class="headerlink" href="#Setup-Monitors,-Loss-function,-Stop-Criteria" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.experiments.experiment</span> <span class="k">import</span> <span class="n">Experiment</span>
<span class="kn">from</span> <span class="nn">braindecode.experiments.monitors</span> <span class="k">import</span> <span class="n">RuntimeMonitor</span><span class="p">,</span> <span class="n">LossMonitor</span><span class="p">,</span> <span class="n">CroppedTrialMisclassMonitor</span><span class="p">,</span> <span class="n">MisclassMonitor</span>
<span class="kn">from</span> <span class="nn">braindecode.experiments.stopcriteria</span> <span class="k">import</span> <span class="n">MaxEpochs</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">torch</span> <span class="k">as</span> <span class="nn">th</span>
<span class="kn">from</span> <span class="nn">braindecode.torch_ext.modules</span> <span class="k">import</span> <span class="n">Expression</span>


<span class="n">loss_function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">preds</span><span class="p">,</span> <span class="n">targets</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">targets</span><span class="p">)</span>

<span class="n">model_constraint</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">monitors</span> <span class="o">=</span> <span class="p">[</span><span class="n">LossMonitor</span><span class="p">(),</span> <span class="n">MisclassMonitor</span><span class="p">(</span><span class="n">col_suffix</span><span class="o">=</span><span class="s1">&#39;sample_misclass&#39;</span><span class="p">),</span>
            <span class="n">CroppedTrialMisclassMonitor</span><span class="p">(</span><span class="n">input_time_length</span><span class="p">),</span> <span class="n">RuntimeMonitor</span><span class="p">(),]</span>
<span class="n">stop_criterion</span> <span class="o">=</span> <span class="n">MaxEpochs</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">Experiment</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train_set</span><span class="p">,</span> <span class="n">valid_set</span><span class="p">,</span> <span class="n">test_set</span><span class="p">,</span> <span class="n">iterator</span><span class="p">,</span> <span class="n">loss_function</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">model_constraint</span><span class="p">,</span>
          <span class="n">monitors</span><span class="p">,</span> <span class="n">stop_criterion</span><span class="p">,</span> <span class="n">remember_best_column</span><span class="o">=</span><span class="s1">&#39;valid_misclass&#39;</span><span class="p">,</span>
          <span class="n">run_after_early_stop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">batch_modifier</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cuda</span><span class="o">=</span><span class="n">cuda</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Run-experiment">
<h2>Run experiment<a class="headerlink" href="#Run-experiment" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">exp</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2017-09-04 17:17:47,219 INFO : Run until first stop...
2017-09-04 17:17:47,865 INFO : Epoch 0
2017-09-04 17:17:47,866 INFO : train_loss                11.53333
2017-09-04 17:17:47,867 INFO : valid_loss                12.37084
2017-09-04 17:17:47,868 INFO : test_loss                 11.33717
2017-09-04 17:17:47,869 INFO : train_sample_misclass     0.93548
2017-09-04 17:17:47,869 INFO : valid_sample_misclass     0.98502
2017-09-04 17:17:47,870 INFO : test_sample_misclass      0.91691
2017-09-04 17:17:47,871 INFO : train_misclass            0.93976
2017-09-04 17:17:47,871 INFO : valid_misclass            0.96774
2017-09-04 17:17:47,872 INFO : test_misclass             0.90863
2017-09-04 17:17:47,873 INFO : runtime                   0.00000
2017-09-04 17:17:47,874 INFO :
2017-09-04 17:17:47,875 INFO : New best valid_misclass: 0.967742
2017-09-04 17:17:47,876 INFO :
2017-09-04 17:17:48,405 INFO : Time only for training updates: 0.40s
2017-09-04 17:17:49,011 INFO : Epoch 1
2017-09-04 17:17:49,012 INFO : train_loss                1.50393
2017-09-04 17:17:49,013 INFO : valid_loss                1.45453
2017-09-04 17:17:49,014 INFO : test_loss                 1.55869
2017-09-04 17:17:49,014 INFO : train_sample_misclass     0.64498
2017-09-04 17:17:49,015 INFO : valid_sample_misclass     0.62718
2017-09-04 17:17:49,016 INFO : test_sample_misclass      0.66700
2017-09-04 17:17:49,017 INFO : train_misclass            0.58233
2017-09-04 17:17:49,017 INFO : valid_misclass            0.58065
2017-09-04 17:17:49,018 INFO : test_misclass             0.62437
2017-09-04 17:17:49,019 INFO : runtime                   1.18624
2017-09-04 17:17:49,019 INFO :
2017-09-04 17:17:49,021 INFO : New best valid_misclass: 0.580645
2017-09-04 17:17:49,022 INFO :
2017-09-04 17:17:49,545 INFO : Time only for training updates: 0.40s
2017-09-04 17:17:50,151 INFO : Epoch 2
2017-09-04 17:17:50,152 INFO : train_loss                1.41951
2017-09-04 17:17:50,153 INFO : valid_loss                1.48343
2017-09-04 17:17:50,154 INFO : test_loss                 1.53018
2017-09-04 17:17:50,155 INFO : train_sample_misclass     0.60707
2017-09-04 17:17:50,155 INFO : valid_sample_misclass     0.62290
2017-09-04 17:17:50,156 INFO : test_sample_misclass      0.64429
2017-09-04 17:17:50,157 INFO : train_misclass            0.56627
2017-09-04 17:17:50,157 INFO : valid_misclass            0.62903
2017-09-04 17:17:50,158 INFO : test_misclass             0.64975
2017-09-04 17:17:50,159 INFO : runtime                   1.13945
2017-09-04 17:17:50,160 INFO :
2017-09-04 17:17:50,684 INFO : Time only for training updates: 0.40s
2017-09-04 17:17:51,291 INFO : Epoch 3
2017-09-04 17:17:51,292 INFO : train_loss                1.42581
2017-09-04 17:17:51,293 INFO : valid_loss                1.49817
2017-09-04 17:17:51,294 INFO : test_loss                 1.61901
2017-09-04 17:17:51,294 INFO : train_sample_misclass     0.61668
2017-09-04 17:17:51,295 INFO : valid_sample_misclass     0.65217
2017-09-04 17:17:51,296 INFO : test_sample_misclass      0.67644
2017-09-04 17:17:51,297 INFO : train_misclass            0.60241
2017-09-04 17:17:51,297 INFO : valid_misclass            0.72581
2017-09-04 17:17:51,298 INFO : test_misclass             0.67513
2017-09-04 17:17:51,299 INFO : runtime                   1.13913
2017-09-04 17:17:51,299 INFO :
2017-09-04 17:17:51,823 INFO : Time only for training updates: 0.40s
2017-09-04 17:17:52,429 INFO : Epoch 4
2017-09-04 17:17:52,430 INFO : train_loss                1.38586
2017-09-04 17:17:52,431 INFO : valid_loss                1.48687
2017-09-04 17:17:52,432 INFO : test_loss                 1.55094
2017-09-04 17:17:52,433 INFO : train_sample_misclass     0.59819
2017-09-04 17:17:52,433 INFO : valid_sample_misclass     0.64463
2017-09-04 17:17:52,434 INFO : test_sample_misclass      0.65671
2017-09-04 17:17:52,435 INFO : train_misclass            0.52610
2017-09-04 17:17:52,435 INFO : valid_misclass            0.67742
2017-09-04 17:17:52,436 INFO : test_misclass             0.62944
2017-09-04 17:17:52,437 INFO : runtime                   1.13857
2017-09-04 17:17:52,438 INFO :
2017-09-04 17:17:52,961 INFO : Time only for training updates: 0.40s
2017-09-04 17:17:53,569 INFO : Epoch 5
2017-09-04 17:17:53,570 INFO : train_loss                1.41485
2017-09-04 17:17:53,570 INFO : valid_loss                1.44874
2017-09-04 17:17:53,571 INFO : test_loss                 1.55589
2017-09-04 17:17:53,572 INFO : train_sample_misclass     0.60224
2017-09-04 17:17:53,573 INFO : valid_sample_misclass     0.62897
2017-09-04 17:17:53,573 INFO : test_sample_misclass      0.65083
2017-09-04 17:17:53,574 INFO : train_misclass            0.51406
2017-09-04 17:17:53,575 INFO : valid_misclass            0.58065
2017-09-04 17:17:53,575 INFO : test_misclass             0.63452
2017-09-04 17:17:53,576 INFO : runtime                   1.13840
2017-09-04 17:17:53,577 INFO :
2017-09-04 17:17:53,579 INFO : New best valid_misclass: 0.580645
2017-09-04 17:17:53,580 INFO :
2017-09-04 17:17:54,102 INFO : Time only for training updates: 0.40s
2017-09-04 17:17:54,708 INFO : Epoch 6
2017-09-04 17:17:54,709 INFO : train_loss                1.36745
2017-09-04 17:17:54,710 INFO : valid_loss                1.41226
2017-09-04 17:17:54,711 INFO : test_loss                 1.52581
2017-09-04 17:17:54,712 INFO : train_sample_misclass     0.58987
2017-09-04 17:17:54,712 INFO : valid_sample_misclass     0.63906
2017-09-04 17:17:54,713 INFO : test_sample_misclass      0.64640
2017-09-04 17:17:54,714 INFO : train_misclass            0.49398
2017-09-04 17:17:54,714 INFO : valid_misclass            0.61290
2017-09-04 17:17:54,715 INFO : test_misclass             0.60406
2017-09-04 17:17:54,716 INFO : runtime                   1.14130
2017-09-04 17:17:54,717 INFO :
2017-09-04 17:17:55,240 INFO : Time only for training updates: 0.40s
2017-09-04 17:17:55,847 INFO : Epoch 7
2017-09-04 17:17:55,848 INFO : train_loss                1.37782
2017-09-04 17:17:55,849 INFO : valid_loss                1.43321
2017-09-04 17:17:55,850 INFO : test_loss                 1.50327
2017-09-04 17:17:55,851 INFO : train_sample_misclass     0.57490
2017-09-04 17:17:55,852 INFO : valid_sample_misclass     0.62826
2017-09-04 17:17:55,852 INFO : test_sample_misclass      0.63315
2017-09-04 17:17:55,853 INFO : train_misclass            0.51406
2017-09-04 17:17:55,854 INFO : valid_misclass            0.70968
2017-09-04 17:17:55,854 INFO : test_misclass             0.63452
2017-09-04 17:17:55,855 INFO : runtime                   1.13720
2017-09-04 17:17:55,856 INFO :
2017-09-04 17:17:56,380 INFO : Time only for training updates: 0.40s
2017-09-04 17:17:56,989 INFO : Epoch 8
2017-09-04 17:17:56,990 INFO : train_loss                1.37211
2017-09-04 17:17:56,991 INFO : valid_loss                1.42880
2017-09-04 17:17:56,992 INFO : test_loss                 1.53159
2017-09-04 17:17:56,993 INFO : train_sample_misclass     0.58581
2017-09-04 17:17:56,993 INFO : valid_sample_misclass     0.65533
2017-09-04 17:17:56,994 INFO : test_sample_misclass      0.67241
2017-09-04 17:17:56,995 INFO : train_misclass            0.56225
2017-09-04 17:17:56,996 INFO : valid_misclass            0.67742
2017-09-04 17:17:56,996 INFO : test_misclass             0.66497
2017-09-04 17:17:56,997 INFO : runtime                   1.14047
2017-09-04 17:17:56,998 INFO :
2017-09-04 17:17:57,520 INFO : Time only for training updates: 0.40s
2017-09-04 17:17:58,127 INFO : Epoch 9
2017-09-04 17:17:58,128 INFO : train_loss                1.36910
2017-09-04 17:17:58,128 INFO : valid_loss                1.43300
2017-09-04 17:17:58,129 INFO : test_loss                 1.54117
2017-09-04 17:17:58,130 INFO : train_sample_misclass     0.59271
2017-09-04 17:17:58,131 INFO : valid_sample_misclass     0.65435
2017-09-04 17:17:58,131 INFO : test_sample_misclass      0.67089
2017-09-04 17:17:58,132 INFO : train_misclass            0.57831
2017-09-04 17:17:58,133 INFO : valid_misclass            0.67742
2017-09-04 17:17:58,134 INFO : test_misclass             0.66497
2017-09-04 17:17:58,134 INFO : runtime                   1.14038
2017-09-04 17:17:58,135 INFO :
2017-09-04 17:17:58,659 INFO : Time only for training updates: 0.40s
2017-09-04 17:17:59,268 INFO : Epoch 10
2017-09-04 17:17:59,270 INFO : train_loss                1.34061
2017-09-04 17:17:59,270 INFO : valid_loss                1.47586
2017-09-04 17:17:59,271 INFO : test_loss                 1.52879
2017-09-04 17:17:59,272 INFO : train_sample_misclass     0.57797
2017-09-04 17:17:59,273 INFO : valid_sample_misclass     0.64290
2017-09-04 17:17:59,273 INFO : test_sample_misclass      0.65074
2017-09-04 17:17:59,274 INFO : train_misclass            0.48594
2017-09-04 17:17:59,275 INFO : valid_misclass            0.56452
2017-09-04 17:17:59,275 INFO : test_misclass             0.60406
2017-09-04 17:17:59,276 INFO : runtime                   1.13859
2017-09-04 17:17:59,277 INFO :
2017-09-04 17:17:59,279 INFO : New best valid_misclass: 0.564516
2017-09-04 17:17:59,279 INFO :
2017-09-04 17:17:59,809 INFO : Time only for training updates: 0.40s
2017-09-04 17:18:00,417 INFO : Epoch 11
2017-09-04 17:18:00,418 INFO : train_loss                1.37122
2017-09-04 17:18:00,418 INFO : valid_loss                1.39534
2017-09-04 17:18:00,419 INFO : test_loss                 1.57000
2017-09-04 17:18:00,420 INFO : train_sample_misclass     0.58240
2017-09-04 17:18:00,420 INFO : valid_sample_misclass     0.64185
2017-09-04 17:18:00,421 INFO : test_sample_misclass      0.67935
2017-09-04 17:18:00,422 INFO : train_misclass            0.51004
2017-09-04 17:18:00,423 INFO : valid_misclass            0.64516
2017-09-04 17:18:00,423 INFO : test_misclass             0.64467
2017-09-04 17:18:00,424 INFO : runtime                   1.15042
2017-09-04 17:18:00,425 INFO :
2017-09-04 17:18:00,955 INFO : Time only for training updates: 0.40s
2017-09-04 17:18:01,563 INFO : Epoch 12
2017-09-04 17:18:01,564 INFO : train_loss                1.38608
2017-09-04 17:18:01,565 INFO : valid_loss                1.48440
2017-09-04 17:18:01,565 INFO : test_loss                 1.57658
2017-09-04 17:18:01,566 INFO : train_sample_misclass     0.60330
2017-09-04 17:18:01,567 INFO : valid_sample_misclass     0.62552
2017-09-04 17:18:01,568 INFO : test_sample_misclass      0.66465
2017-09-04 17:18:01,568 INFO : train_misclass            0.56225
2017-09-04 17:18:01,569 INFO : valid_misclass            0.61290
2017-09-04 17:18:01,570 INFO : test_misclass             0.66497
2017-09-04 17:18:01,570 INFO : runtime                   1.14569
2017-09-04 17:18:01,571 INFO :
2017-09-04 17:18:02,101 INFO : Time only for training updates: 0.40s
2017-09-04 17:18:02,709 INFO : Epoch 13
2017-09-04 17:18:02,710 INFO : train_loss                1.34758
2017-09-04 17:18:02,711 INFO : valid_loss                1.47008
2017-09-04 17:18:02,712 INFO : test_loss                 1.57330
2017-09-04 17:18:02,713 INFO : train_sample_misclass     0.56943
2017-09-04 17:18:02,713 INFO : valid_sample_misclass     0.63394
2017-09-04 17:18:02,714 INFO : test_sample_misclass      0.65246
2017-09-04 17:18:02,715 INFO : train_misclass            0.50201
2017-09-04 17:18:02,715 INFO : valid_misclass            0.56452
2017-09-04 17:18:02,716 INFO : test_misclass             0.58883
2017-09-04 17:18:02,717 INFO : runtime                   1.14636
2017-09-04 17:18:02,718 INFO :
2017-09-04 17:18:02,719 INFO : New best valid_misclass: 0.564516
2017-09-04 17:18:02,720 INFO :
2017-09-04 17:18:03,248 INFO : Time only for training updates: 0.40s
2017-09-04 17:18:03,857 INFO : Epoch 14
2017-09-04 17:18:03,858 INFO : train_loss                1.35378
2017-09-04 17:18:03,859 INFO : valid_loss                1.45730
2017-09-04 17:18:03,860 INFO : test_loss                 1.53986
2017-09-04 17:18:03,861 INFO : train_sample_misclass     0.58917
2017-09-04 17:18:03,861 INFO : valid_sample_misclass     0.63594
2017-09-04 17:18:03,862 INFO : test_sample_misclass      0.65305
2017-09-04 17:18:03,863 INFO : train_misclass            0.48594
2017-09-04 17:18:03,864 INFO : valid_misclass            0.59677
2017-09-04 17:18:03,864 INFO : test_misclass             0.63452
2017-09-04 17:18:03,865 INFO : runtime                   1.14647
2017-09-04 17:18:03,866 INFO :
2017-09-04 17:18:04,395 INFO : Time only for training updates: 0.40s
2017-09-04 17:18:05,004 INFO : Epoch 15
2017-09-04 17:18:05,005 INFO : train_loss                1.32959
2017-09-04 17:18:05,006 INFO : valid_loss                1.39044
2017-09-04 17:18:05,007 INFO : test_loss                 1.51507
2017-09-04 17:18:05,007 INFO : train_sample_misclass     0.56187
2017-09-04 17:18:05,008 INFO : valid_sample_misclass     0.62517
2017-09-04 17:18:05,009 INFO : test_sample_misclass      0.64205
2017-09-04 17:18:05,010 INFO : train_misclass            0.46586
2017-09-04 17:18:05,010 INFO : valid_misclass            0.56452
2017-09-04 17:18:05,011 INFO : test_misclass             0.61929
2017-09-04 17:18:05,012 INFO : runtime                   1.14746
2017-09-04 17:18:05,012 INFO :
2017-09-04 17:18:05,014 INFO : New best valid_misclass: 0.564516
2017-09-04 17:18:05,015 INFO :
2017-09-04 17:18:05,545 INFO : Time only for training updates: 0.40s
2017-09-04 17:18:06,153 INFO : Epoch 16
2017-09-04 17:18:06,154 INFO : train_loss                1.35525
2017-09-04 17:18:06,155 INFO : valid_loss                1.47013
2017-09-04 17:18:06,156 INFO : test_loss                 1.55756
2017-09-04 17:18:06,156 INFO : train_sample_misclass     0.58248
2017-09-04 17:18:06,157 INFO : valid_sample_misclass     0.61846
2017-09-04 17:18:06,158 INFO : test_sample_misclass      0.64876
2017-09-04 17:18:06,159 INFO : train_misclass            0.54618
2017-09-04 17:18:06,159 INFO : valid_misclass            0.61290
2017-09-04 17:18:06,160 INFO : test_misclass             0.65482
2017-09-04 17:18:06,161 INFO : runtime                   1.14928
2017-09-04 17:18:06,162 INFO :
2017-09-04 17:18:06,693 INFO : Time only for training updates: 0.40s
2017-09-04 17:18:07,308 INFO : Epoch 17
2017-09-04 17:18:07,309 INFO : train_loss                1.33435
2017-09-04 17:18:07,310 INFO : valid_loss                1.43416
2017-09-04 17:18:07,310 INFO : test_loss                 1.50396
2017-09-04 17:18:07,311 INFO : train_sample_misclass     0.57857
2017-09-04 17:18:07,312 INFO : valid_sample_misclass     0.63746
2017-09-04 17:18:07,313 INFO : test_sample_misclass      0.64018
2017-09-04 17:18:07,313 INFO : train_misclass            0.51807
2017-09-04 17:18:07,314 INFO : valid_misclass            0.56452
2017-09-04 17:18:07,315 INFO : test_misclass             0.63452
2017-09-04 17:18:07,316 INFO : runtime                   1.14819
2017-09-04 17:18:07,316 INFO :
2017-09-04 17:18:07,318 INFO : New best valid_misclass: 0.564516
2017-09-04 17:18:07,319 INFO :
2017-09-04 17:18:07,845 INFO : Time only for training updates: 0.40s
2017-09-04 17:18:08,455 INFO : Epoch 18
2017-09-04 17:18:08,456 INFO : train_loss                1.37355
2017-09-04 17:18:08,456 INFO : valid_loss                1.48895
2017-09-04 17:18:08,457 INFO : test_loss                 1.61437
2017-09-04 17:18:08,458 INFO : train_sample_misclass     0.60029
2017-09-04 17:18:08,459 INFO : valid_sample_misclass     0.63202
2017-09-04 17:18:08,459 INFO : test_sample_misclass      0.66740
2017-09-04 17:18:08,460 INFO : train_misclass            0.53414
2017-09-04 17:18:08,461 INFO : valid_misclass            0.54839
2017-09-04 17:18:08,462 INFO : test_misclass             0.63959
2017-09-04 17:18:08,462 INFO : runtime                   1.15258
2017-09-04 17:18:08,463 INFO :
2017-09-04 17:18:08,465 INFO : New best valid_misclass: 0.548387
2017-09-04 17:18:08,465 INFO :
2017-09-04 17:18:08,997 INFO : Time only for training updates: 0.40s
2017-09-04 17:18:09,605 INFO : Epoch 19
2017-09-04 17:18:09,606 INFO : train_loss                1.38204
2017-09-04 17:18:09,607 INFO : valid_loss                1.45591
2017-09-04 17:18:09,608 INFO : test_loss                 1.53040
2017-09-04 17:18:09,608 INFO : train_sample_misclass     0.58602
2017-09-04 17:18:09,609 INFO : valid_sample_misclass     0.62653
2017-09-04 17:18:09,610 INFO : test_sample_misclass      0.64120
2017-09-04 17:18:09,611 INFO : train_misclass            0.50602
2017-09-04 17:18:09,611 INFO : valid_misclass            0.67742
2017-09-04 17:18:09,612 INFO : test_misclass             0.59898
2017-09-04 17:18:09,613 INFO : runtime                   1.15132
2017-09-04 17:18:09,614 INFO :
2017-09-04 17:18:10,146 INFO : Time only for training updates: 0.41s
2017-09-04 17:18:10,754 INFO : Epoch 20
2017-09-04 17:18:10,755 INFO : train_loss                1.33167
2017-09-04 17:18:10,755 INFO : valid_loss                1.36411
2017-09-04 17:18:10,756 INFO : test_loss                 1.50689
2017-09-04 17:18:10,757 INFO : train_sample_misclass     0.56731
2017-09-04 17:18:10,758 INFO : valid_sample_misclass     0.60955
2017-09-04 17:18:10,758 INFO : test_sample_misclass      0.63849
2017-09-04 17:18:10,759 INFO : train_misclass            0.47390
2017-09-04 17:18:10,760 INFO : valid_misclass            0.62903
2017-09-04 17:18:10,760 INFO : test_misclass             0.58883
2017-09-04 17:18:10,761 INFO : runtime                   1.14884
2017-09-04 17:18:10,762 INFO :
2017-09-04 17:18:10,763 INFO : Setup for second stop...
2017-09-04 17:18:10,765 INFO : Train loss to reach 1.37355
2017-09-04 17:18:10,766 INFO : Run until second stop...
2017-09-04 17:18:11,460 INFO : Epoch 19
2017-09-04 17:18:11,461 INFO : train_loss                1.39583
2017-09-04 17:18:11,462 INFO : valid_loss                1.48895
2017-09-04 17:18:11,463 INFO : test_loss                 1.61437
2017-09-04 17:18:11,464 INFO : train_sample_misclass     0.60642
2017-09-04 17:18:11,464 INFO : valid_sample_misclass     0.63202
2017-09-04 17:18:11,465 INFO : test_sample_misclass      0.66740
2017-09-04 17:18:11,466 INFO : train_misclass            0.53698
2017-09-04 17:18:11,467 INFO : valid_misclass            0.54839
2017-09-04 17:18:11,467 INFO : test_misclass             0.63959
2017-09-04 17:18:11,468 INFO : runtime                   0.62059
2017-09-04 17:18:11,469 INFO :
2017-09-04 17:18:12,117 INFO : Time only for training updates: 0.49s
2017-09-04 17:18:12,797 INFO : Epoch 20
2017-09-04 17:18:12,798 INFO : train_loss                1.35322
2017-09-04 17:18:12,799 INFO : valid_loss                1.33134
2017-09-04 17:18:12,799 INFO : test_loss                 1.58535
2017-09-04 17:18:12,800 INFO : train_sample_misclass     0.57861
2017-09-04 17:18:12,801 INFO : valid_sample_misclass     0.61952
2017-09-04 17:18:12,802 INFO : test_sample_misclass      0.69420
2017-09-04 17:18:12,802 INFO : train_misclass            0.47910
2017-09-04 17:18:12,803 INFO : valid_misclass            0.56452
2017-09-04 17:18:12,804 INFO : test_misclass             0.69543
2017-09-04 17:18:12,805 INFO : runtime                   1.35119
2017-09-04 17:18:12,805 INFO :
</pre></div></div>
</div>
<p>We arrive only at 31% accuracy. With only 3 sensors and 3 training runs,
cannot expect too much great performance :)</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Robin Tibor Schirrmeister.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.2.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>