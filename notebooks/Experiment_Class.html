

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using the Experiment Class &mdash; Braindecode 0.3.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Braindecode 0.3.0 documentation" href="../index.html"/>
        <link rel="next" title="Amplitude Perturbation Visualization" href="visualization/Perturbation.html"/>
        <link rel="prev" title="Cropped Decoding" href="Cropped_Decoding.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Braindecode
          

          
          </a>

          
            
            
              <div class="version">
                0.3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="TrialWise_Decoding.html">Trialwise Decoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cropped_Decoding.html">Cropped Decoding</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using the Experiment Class</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Load-data">Load data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Convert-data-to-Braindecode-Format">Convert data to Braindecode Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Create-the-model">Create the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Setup-Experiment">Setup Experiment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Run-experiment">Run experiment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Dataset-References">Dataset References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="visualization/Perturbation.html">Amplitude Perturbation Visualization</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.datautil.html">braindecode.datautil package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.experiments.html">braindecode.experiments package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.mne_ext.html">braindecode.mne_ext package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.models.html">braindecode.models package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.torch_ext.html">braindecode.torch_ext package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.visualization.html">braindecode.visualization package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Braindecode</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Using the Experiment Class</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/Experiment_Class.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Using-the-Experiment-Class">
<h1>Using the Experiment Class<a class="headerlink" href="#Using-the-Experiment-Class" title="Permalink to this headline">Â¶</a></h1>
<p>Braindecode provides a convenience <code class="docutils literal"><span class="pre">Experiment</span></code> class, which removes
the necessity to write your own training loop. It expects a training, a
validation and a test set and trains as follows:</p>
<ol class="arabic simple">
<li>Train on training set until a given stop criterion is fulfilled</li>
<li>Reset to the best epoch, i.e. reset parameters of the model and the
optimizer to the state at the best epoch (âbestâ according to a given
criterion)</li>
<li>Continue training on the combined training + validation set until the
loss on the validation set is as low as it was on the best epoch for
the training set. (or until the ConvNet was trained twice as many
epochs as the best epoch to prevent infinite training)</li>
</ol>
<div class="admonition warning">
It is not necessary to use the Experiment class to use the remaning
functionality of Braindecode. Feel free to ignore it :)</div>
<div class="section" id="Load-data">
<h2>Load data<a class="headerlink" href="#Load-data" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">from</span> <span class="nn">mne.io</span> <span class="k">import</span> <span class="n">concatenate_raws</span>

<span class="c1"># 5,6,7,10,13,14 are codes for executed and imagined hands/feet</span>
<span class="n">subject_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">event_codes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">]</span>

<span class="c1"># This will download the files if you don&#39;t have them yet,</span>
<span class="c1"># and then return the paths to the files.</span>
<span class="n">physionet_paths</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">eegbci</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">subject_id</span><span class="p">,</span> <span class="n">event_codes</span><span class="p">)</span>

<span class="c1"># Load each of the files</span>
<span class="n">parts</span> <span class="o">=</span> <span class="p">[</span><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_edf</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="s1">&#39;WARNING&#39;</span><span class="p">)</span>
         <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">physionet_paths</span><span class="p">]</span>

<span class="c1"># Concatenate them</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">concatenate_raws</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span>

<span class="c1"># Find the events in this dataset</span>
<span class="n">events</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">find_events</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">shortest_event</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;STI 014&#39;</span><span class="p">)</span>

<span class="c1"># Use only EEG channels</span>
<span class="n">eeg_channel_inds</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">exclude</span><span class="o">=</span><span class="s1">&#39;bads&#39;</span><span class="p">)</span>

<span class="c1"># Extract trials, only using EEG channels</span>
<span class="n">epoched</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">hands</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">feet</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span> <span class="n">tmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">4.1</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">eeg_channel_inds</span><span class="p">,</span>
                <span class="n">baseline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Removing orphaned offset at the beginning of the file.
179 events found
Events id: [1 2 3]
90 matching events found
Loading data for 90 events and 497 original time points ...
0 bad epochs dropped
</pre></div></div>
</div>
</div>
<div class="section" id="Convert-data-to-Braindecode-Format">
<h2>Convert data to Braindecode Format<a class="headerlink" href="#Convert-data-to-Braindecode-Format" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">braindecode.datautil.signal_target</span> <span class="k">import</span> <span class="n">SignalAndTarget</span>
<span class="kn">from</span> <span class="nn">braindecode.datautil.splitters</span> <span class="k">import</span> <span class="n">split_into_two_sets</span>
<span class="c1"># Convert data from volt to millivolt</span>
<span class="c1"># Pytorch expects float32 for input and int64 for labels.</span>
<span class="n">X</span> <span class="o">=</span> <span class="p">(</span><span class="n">epoched</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">epoched</span><span class="o">.</span><span class="n">events</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span> <span class="c1">#2,3 -&gt; 0,1</span>

<span class="n">train_set</span> <span class="o">=</span> <span class="n">SignalAndTarget</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">60</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">[:</span><span class="mi">60</span><span class="p">])</span>
<span class="n">test_set</span> <span class="o">=</span> <span class="n">SignalAndTarget</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">60</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">60</span><span class="p">:])</span>

<span class="n">train_set</span><span class="p">,</span> <span class="n">valid_set</span> <span class="o">=</span> <span class="n">split_into_two_sets</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> <span class="n">first_set_fraction</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Create-the-model">
<h2>Create the model<a class="headerlink" href="#Create-the-model" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.models.shallow_fbcsp</span> <span class="k">import</span> <span class="n">ShallowFBCSPNet</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="k">import</span> <span class="n">nn</span>
<span class="kn">from</span> <span class="nn">braindecode.torch_ext.util</span> <span class="k">import</span> <span class="n">set_random_seeds</span>
<span class="kn">from</span> <span class="nn">braindecode.models.util</span> <span class="k">import</span> <span class="n">to_dense_prediction_model</span>

<span class="c1"># Set if you want to use GPU</span>
<span class="c1"># You can also use torch.cuda.is_available() to determine if cuda is available on your machine.</span>
<span class="n">cuda</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">set_random_seeds</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">20170629</span><span class="p">,</span> <span class="n">cuda</span><span class="o">=</span><span class="n">cuda</span><span class="p">)</span>

<span class="c1"># This will determine how many crops are processed in parallel</span>
<span class="n">input_time_length</span> <span class="o">=</span> <span class="mi">450</span>
<span class="n">n_classes</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">in_chans</span> <span class="o">=</span> <span class="n">train_set</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># final_conv_length determines the size of the receptive field of the ConvNet</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ShallowFBCSPNet</span><span class="p">(</span><span class="n">in_chans</span><span class="o">=</span><span class="n">in_chans</span><span class="p">,</span> <span class="n">n_classes</span><span class="o">=</span><span class="n">n_classes</span><span class="p">,</span> <span class="n">input_time_length</span><span class="o">=</span><span class="n">input_time_length</span><span class="p">,</span>
                        <span class="n">final_conv_length</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">create_network</span><span class="p">()</span>
<span class="n">to_dense_prediction_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="k">if</span> <span class="n">cuda</span><span class="p">:</span>
    <span class="n">model</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">torch</span> <span class="k">import</span> <span class="n">optim</span>

<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.torch_ext.util</span> <span class="k">import</span> <span class="n">np_to_var</span>
<span class="c1"># determine output size</span>
<span class="n">test_input</span> <span class="o">=</span> <span class="n">np_to_var</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">in_chans</span><span class="p">,</span> <span class="n">input_time_length</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="k">if</span> <span class="n">cuda</span><span class="p">:</span>
    <span class="n">test_input</span> <span class="o">=</span> <span class="n">test_input</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">test_input</span><span class="p">)</span>
<span class="n">n_preds_per_input</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:d}</span><span class="s2"> predictions per input/trial&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n_preds_per_input</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
187 predictions per input/trial
</pre></div></div>
</div>
</div>
<div class="section" id="Setup-Experiment">
<h2>Setup Experiment<a class="headerlink" href="#Setup-Experiment" title="Permalink to this headline">Â¶</a></h2>
<p>Now we need to setup everything for the experiment: Iterator, loss
function, monitors and stop criterion.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.experiments.experiment</span> <span class="k">import</span> <span class="n">Experiment</span>
<span class="kn">from</span> <span class="nn">braindecode.datautil.iterators</span> <span class="k">import</span> <span class="n">CropsFromTrialsIterator</span>
<span class="kn">from</span> <span class="nn">braindecode.experiments.monitors</span> <span class="k">import</span> <span class="n">RuntimeMonitor</span><span class="p">,</span> <span class="n">LossMonitor</span><span class="p">,</span> <span class="n">CroppedTrialMisclassMonitor</span><span class="p">,</span> <span class="n">MisclassMonitor</span>
<span class="kn">from</span> <span class="nn">braindecode.experiments.stopcriteria</span> <span class="k">import</span> <span class="n">MaxEpochs</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">torch</span> <span class="k">as</span> <span class="nn">th</span>
<span class="kn">from</span> <span class="nn">braindecode.torch_ext.modules</span> <span class="k">import</span> <span class="n">Expression</span>
<span class="c1"># Iterator is used to iterate over datasets both for training</span>
<span class="c1"># and evaluation</span>
<span class="n">iterator</span> <span class="o">=</span> <span class="n">CropsFromTrialsIterator</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span><span class="n">input_time_length</span><span class="o">=</span><span class="n">input_time_length</span><span class="p">,</span>
                                  <span class="n">n_preds_per_input</span><span class="o">=</span><span class="n">n_preds_per_input</span><span class="p">)</span>

<span class="c1"># Loss function takes predictions as they come out of the network and the targets</span>
<span class="c1"># and returns a loss</span>
<span class="n">loss_function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">preds</span><span class="p">,</span> <span class="n">targets</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">targets</span><span class="p">)</span>

<span class="c1"># Could be used to apply some constraint on the models, then should be object</span>
<span class="c1"># with apply method that accepts a module</span>
<span class="n">model_constraint</span> <span class="o">=</span> <span class="kc">None</span>
<span class="c1"># Monitors log the training progress</span>
<span class="n">monitors</span> <span class="o">=</span> <span class="p">[</span><span class="n">LossMonitor</span><span class="p">(),</span> <span class="n">MisclassMonitor</span><span class="p">(</span><span class="n">col_suffix</span><span class="o">=</span><span class="s1">&#39;sample_misclass&#39;</span><span class="p">),</span>
            <span class="n">CroppedTrialMisclassMonitor</span><span class="p">(</span><span class="n">input_time_length</span><span class="p">),</span> <span class="n">RuntimeMonitor</span><span class="p">(),]</span>
<span class="c1"># Stop criterion determines when the first stop happens</span>
<span class="n">stop_criterion</span> <span class="o">=</span> <span class="n">MaxEpochs</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">Experiment</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train_set</span><span class="p">,</span> <span class="n">valid_set</span><span class="p">,</span> <span class="n">test_set</span><span class="p">,</span> <span class="n">iterator</span><span class="p">,</span> <span class="n">loss_function</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">model_constraint</span><span class="p">,</span>
          <span class="n">monitors</span><span class="p">,</span> <span class="n">stop_criterion</span><span class="p">,</span> <span class="n">remember_best_column</span><span class="o">=</span><span class="s1">&#39;valid_misclass&#39;</span><span class="p">,</span>
          <span class="n">run_after_early_stop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">batch_modifier</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cuda</span><span class="o">=</span><span class="n">cuda</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Run-experiment">
<h2>Run experiment<a class="headerlink" href="#Run-experiment" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># need to setup python logging before to be able to see anything</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> </span><span class="si">%(levelname)s</span><span class="s1"> : </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
                     <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
<span class="n">exp</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2017-10-18 14:35:26,018 INFO : Run until first stop...
2017-10-18 14:35:27,899 INFO : Epoch 0
2017-10-18 14:35:27,904 INFO : train_loss                0.86930
2017-10-18 14:35:27,908 INFO : valid_loss                0.74838
2017-10-18 14:35:27,909 INFO : test_loss                 0.69756
2017-10-18 14:35:27,910 INFO : train_sample_misclass     0.53894
2017-10-18 14:35:27,912 INFO : valid_sample_misclass     0.47103
2017-10-18 14:35:27,913 INFO : test_sample_misclass      0.44251
2017-10-18 14:35:27,914 INFO : train_misclass            0.60417
2017-10-18 14:35:27,915 INFO : valid_misclass            0.50000
2017-10-18 14:35:27,916 INFO : test_misclass             0.40000
2017-10-18 14:35:27,917 INFO : runtime                   0.00000
2017-10-18 14:35:27,919 INFO :
2017-10-18 14:35:27,922 INFO : New best valid_misclass: 0.500000
2017-10-18 14:35:27,924 INFO :
2017-10-18 14:35:30,830 INFO : Time only for training updates: 2.87s
2017-10-18 14:35:32,663 INFO : Epoch 1
2017-10-18 14:35:32,667 INFO : train_loss                2.33626
2017-10-18 14:35:32,671 INFO : valid_loss                2.31771
2017-10-18 14:35:32,674 INFO : test_loss                 2.14077
2017-10-18 14:35:32,677 INFO : train_sample_misclass     0.48279
2017-10-18 14:35:32,681 INFO : valid_sample_misclass     0.50000
2017-10-18 14:35:32,684 INFO : test_sample_misclass      0.46667
2017-10-18 14:35:32,687 INFO : train_misclass            0.50000
2017-10-18 14:35:32,688 INFO : valid_misclass            0.50000
2017-10-18 14:35:32,690 INFO : test_misclass             0.46667
2017-10-18 14:35:32,691 INFO : runtime                   4.81331
2017-10-18 14:35:32,694 INFO :
2017-10-18 14:35:32,697 INFO : New best valid_misclass: 0.500000
2017-10-18 14:35:32,698 INFO :
2017-10-18 14:35:35,105 INFO : Time only for training updates: 2.39s
2017-10-18 14:35:37,198 INFO : Epoch 2
2017-10-18 14:35:37,203 INFO : train_loss                0.59815
2017-10-18 14:35:37,206 INFO : valid_loss                0.78503
2017-10-18 14:35:37,208 INFO : test_loss                 0.70060
2017-10-18 14:35:37,209 INFO : train_sample_misclass     0.33918
2017-10-18 14:35:37,210 INFO : valid_sample_misclass     0.47995
2017-10-18 14:35:37,212 INFO : test_sample_misclass      0.41996
2017-10-18 14:35:37,213 INFO : train_misclass            0.22917
2017-10-18 14:35:37,214 INFO : valid_misclass            0.41667
2017-10-18 14:35:37,215 INFO : test_misclass             0.43333
2017-10-18 14:35:37,217 INFO : runtime                   4.29139
2017-10-18 14:35:37,218 INFO :
2017-10-18 14:35:37,221 INFO : New best valid_misclass: 0.416667
2017-10-18 14:35:37,222 INFO :
2017-10-18 14:35:39,655 INFO : Time only for training updates: 2.42s
2017-10-18 14:35:41,575 INFO : Epoch 3
2017-10-18 14:35:41,577 INFO : train_loss                0.53122
2017-10-18 14:35:41,578 INFO : valid_loss                0.87284
2017-10-18 14:35:41,579 INFO : test_loss                 0.69774
2017-10-18 14:35:41,580 INFO : train_sample_misclass     0.24588
2017-10-18 14:35:41,581 INFO : valid_sample_misclass     0.55548
2017-10-18 14:35:41,582 INFO : test_sample_misclass      0.42709
2017-10-18 14:35:41,583 INFO : train_misclass            0.22917
2017-10-18 14:35:41,585 INFO : valid_misclass            0.50000
2017-10-18 14:35:41,586 INFO : test_misclass             0.36667
2017-10-18 14:35:41,587 INFO : runtime                   4.53691
2017-10-18 14:35:41,588 INFO :
2017-10-18 14:35:44,007 INFO : Time only for training updates: 2.40s
2017-10-18 14:35:45,935 INFO : Epoch 4
2017-10-18 14:35:45,939 INFO : train_loss                0.51574
2017-10-18 14:35:45,943 INFO : valid_loss                1.10377
2017-10-18 14:35:45,946 INFO : test_loss                 0.80095
2017-10-18 14:35:45,949 INFO : train_sample_misclass     0.25869
2017-10-18 14:35:45,952 INFO : valid_sample_misclass     0.60094
2017-10-18 14:35:45,956 INFO : test_sample_misclass      0.42727
2017-10-18 14:35:45,959 INFO : train_misclass            0.27083
2017-10-18 14:35:45,960 INFO : valid_misclass            0.58333
2017-10-18 14:35:45,961 INFO : test_misclass             0.46667
2017-10-18 14:35:45,966 INFO : runtime                   4.35103
2017-10-18 14:35:45,967 INFO :
2017-10-18 14:35:48,389 INFO : Time only for training updates: 2.40s
2017-10-18 14:35:50,406 INFO : Epoch 5
2017-10-18 14:35:50,417 INFO : train_loss                0.52613
2017-10-18 14:35:50,419 INFO : valid_loss                1.22322
2017-10-18 14:35:50,421 INFO : test_loss                 0.86285
2017-10-18 14:35:50,423 INFO : train_sample_misclass     0.27635
2017-10-18 14:35:50,425 INFO : valid_sample_misclass     0.58445
2017-10-18 14:35:50,426 INFO : test_sample_misclass      0.43841
2017-10-18 14:35:50,428 INFO : train_misclass            0.33333
2017-10-18 14:35:50,430 INFO : valid_misclass            0.58333
2017-10-18 14:35:50,432 INFO : test_misclass             0.46667
2017-10-18 14:35:50,433 INFO : runtime                   4.38171
2017-10-18 14:35:50,435 INFO :
2017-10-18 14:35:53,064 INFO : Time only for training updates: 2.61s
2017-10-18 14:35:55,069 INFO : Epoch 6
2017-10-18 14:35:55,074 INFO : train_loss                0.54906
2017-10-18 14:35:55,077 INFO : valid_loss                1.23573
2017-10-18 14:35:55,080 INFO : test_loss                 0.92210
2017-10-18 14:35:55,082 INFO : train_sample_misclass     0.28816
2017-10-18 14:35:55,083 INFO : valid_sample_misclass     0.53810
2017-10-18 14:35:55,084 INFO : test_sample_misclass      0.45205
2017-10-18 14:35:55,085 INFO : train_misclass            0.33333
2017-10-18 14:35:55,086 INFO : valid_misclass            0.58333
2017-10-18 14:35:55,087 INFO : test_misclass             0.46667
2017-10-18 14:35:55,089 INFO : runtime                   4.67268
2017-10-18 14:35:55,090 INFO :
2017-10-18 14:35:57,534 INFO : Time only for training updates: 2.42s
2017-10-18 14:35:59,286 INFO : Epoch 7
2017-10-18 14:35:59,287 INFO : train_loss                0.59627
2017-10-18 14:35:59,289 INFO : valid_loss                1.16602
2017-10-18 14:35:59,290 INFO : test_loss                 0.95655
2017-10-18 14:35:59,291 INFO : train_sample_misclass     0.32253
2017-10-18 14:35:59,292 INFO : valid_sample_misclass     0.53053
2017-10-18 14:35:59,293 INFO : test_sample_misclass      0.46346
2017-10-18 14:35:59,294 INFO : train_misclass            0.37500
2017-10-18 14:35:59,295 INFO : valid_misclass            0.58333
2017-10-18 14:35:59,296 INFO : test_misclass             0.46667
2017-10-18 14:35:59,297 INFO : runtime                   4.47253
2017-10-18 14:35:59,298 INFO :
2017-10-18 14:36:01,422 INFO : Time only for training updates: 2.11s
2017-10-18 14:36:02,798 INFO : Epoch 8
2017-10-18 14:36:02,800 INFO : train_loss                0.40527
2017-10-18 14:36:02,801 INFO : valid_loss                0.95821
2017-10-18 14:36:02,802 INFO : test_loss                 0.79267
2017-10-18 14:36:02,802 INFO : train_sample_misclass     0.19112
2017-10-18 14:36:02,803 INFO : valid_sample_misclass     0.52607
2017-10-18 14:36:02,804 INFO : test_sample_misclass      0.43351
2017-10-18 14:36:02,805 INFO : train_misclass            0.16667
2017-10-18 14:36:02,806 INFO : valid_misclass            0.58333
2017-10-18 14:36:02,807 INFO : test_misclass             0.40000
2017-10-18 14:36:02,808 INFO : runtime                   3.88520
2017-10-18 14:36:02,809 INFO :
2017-10-18 14:36:04,816 INFO : Time only for training updates: 2.00s
2017-10-18 14:36:06,168 INFO : Epoch 9
2017-10-18 14:36:06,169 INFO : train_loss                0.30290
2017-10-18 14:36:06,171 INFO : valid_loss                0.89595
2017-10-18 14:36:06,172 INFO : test_loss                 0.75205
2017-10-18 14:36:06,172 INFO : train_sample_misclass     0.10968
2017-10-18 14:36:06,173 INFO : valid_sample_misclass     0.56684
2017-10-18 14:36:06,174 INFO : test_sample_misclass      0.43119
2017-10-18 14:36:06,175 INFO : train_misclass            0.08333
2017-10-18 14:36:06,176 INFO : valid_misclass            0.58333
2017-10-18 14:36:06,177 INFO : test_misclass             0.36667
2017-10-18 14:36:06,178 INFO : runtime                   3.39363
2017-10-18 14:36:06,179 INFO :
2017-10-18 14:36:08,220 INFO : Time only for training updates: 2.03s
2017-10-18 14:36:09,672 INFO : Epoch 10
2017-10-18 14:36:09,674 INFO : train_loss                0.25623
2017-10-18 14:36:09,675 INFO : valid_loss                0.89555
2017-10-18 14:36:09,676 INFO : test_loss                 0.75208
2017-10-18 14:36:09,678 INFO : train_sample_misclass     0.06088
2017-10-18 14:36:09,679 INFO : valid_sample_misclass     0.55637
2017-10-18 14:36:09,680 INFO : test_sample_misclass      0.41765
2017-10-18 14:36:09,681 INFO : train_misclass            0.02083
2017-10-18 14:36:09,682 INFO : valid_misclass            0.58333
2017-10-18 14:36:09,683 INFO : test_misclass             0.33333
2017-10-18 14:36:09,684 INFO : runtime                   3.40419
2017-10-18 14:36:09,685 INFO :
2017-10-18 14:36:11,601 INFO : Time only for training updates: 1.90s
2017-10-18 14:36:12,948 INFO : Epoch 11
2017-10-18 14:36:12,950 INFO : train_loss                0.24021
2017-10-18 14:36:12,951 INFO : valid_loss                0.90580
2017-10-18 14:36:12,953 INFO : test_loss                 0.75648
2017-10-18 14:36:12,954 INFO : train_sample_misclass     0.06205
2017-10-18 14:36:12,956 INFO : valid_sample_misclass     0.54256
2017-10-18 14:36:12,957 INFO : test_sample_misclass      0.39804
2017-10-18 14:36:12,958 INFO : train_misclass            0.02083
2017-10-18 14:36:12,960 INFO : valid_misclass            0.58333
2017-10-18 14:36:12,961 INFO : test_misclass             0.33333
2017-10-18 14:36:12,963 INFO : runtime                   3.38414
2017-10-18 14:36:12,964 INFO :
2017-10-18 14:36:14,862 INFO : Time only for training updates: 1.88s
2017-10-18 14:36:16,237 INFO : Epoch 12
2017-10-18 14:36:16,238 INFO : train_loss                0.20491
2017-10-18 14:36:16,240 INFO : valid_loss                0.90257
2017-10-18 14:36:16,241 INFO : test_loss                 0.75600
2017-10-18 14:36:16,242 INFO : train_sample_misclass     0.05041
2017-10-18 14:36:16,244 INFO : valid_sample_misclass     0.54100
2017-10-18 14:36:16,245 INFO : test_sample_misclass      0.39501
2017-10-18 14:36:16,247 INFO : train_misclass            0.00000
2017-10-18 14:36:16,248 INFO : valid_misclass            0.58333
2017-10-18 14:36:16,250 INFO : test_misclass             0.33333
2017-10-18 14:36:16,251 INFO : runtime                   3.26028
2017-10-18 14:36:16,253 INFO :
2017-10-18 14:36:18,224 INFO : Time only for training updates: 1.95s
2017-10-18 14:36:19,583 INFO : Epoch 13
2017-10-18 14:36:19,584 INFO : train_loss                0.17244
2017-10-18 14:36:19,585 INFO : valid_loss                0.90562
2017-10-18 14:36:19,588 INFO : test_loss                 0.76539
2017-10-18 14:36:19,590 INFO : train_sample_misclass     0.03793
2017-10-18 14:36:19,592 INFO : valid_sample_misclass     0.56194
2017-10-18 14:36:19,594 INFO : test_sample_misclass      0.38752
2017-10-18 14:36:19,595 INFO : train_misclass            0.00000
2017-10-18 14:36:19,596 INFO : valid_misclass            0.66667
2017-10-18 14:36:19,600 INFO : test_misclass             0.36667
2017-10-18 14:36:19,601 INFO : runtime                   3.35971
2017-10-18 14:36:19,602 INFO :
2017-10-18 14:36:21,657 INFO : Time only for training updates: 2.04s
2017-10-18 14:36:23,308 INFO : Epoch 14
2017-10-18 14:36:23,310 INFO : train_loss                0.15207
2017-10-18 14:36:23,311 INFO : valid_loss                0.90600
2017-10-18 14:36:23,312 INFO : test_loss                 0.76428
2017-10-18 14:36:23,313 INFO : train_sample_misclass     0.02969
2017-10-18 14:36:23,315 INFO : valid_sample_misclass     0.54924
2017-10-18 14:36:23,316 INFO : test_sample_misclass      0.36551
2017-10-18 14:36:23,317 INFO : train_misclass            0.00000
2017-10-18 14:36:23,318 INFO : valid_misclass            0.58333
2017-10-18 14:36:23,319 INFO : test_misclass             0.36667
2017-10-18 14:36:23,320 INFO : runtime                   3.43644
2017-10-18 14:36:23,322 INFO :
2017-10-18 14:36:25,291 INFO : Time only for training updates: 1.95s
2017-10-18 14:36:26,659 INFO : Epoch 15
2017-10-18 14:36:26,660 INFO : train_loss                0.14998
2017-10-18 14:36:26,662 INFO : valid_loss                0.96410
2017-10-18 14:36:26,663 INFO : test_loss                 0.81256
2017-10-18 14:36:26,665 INFO : train_sample_misclass     0.04027
2017-10-18 14:36:26,666 INFO : valid_sample_misclass     0.48061
2017-10-18 14:36:26,668 INFO : test_sample_misclass      0.35811
2017-10-18 14:36:26,669 INFO : train_misclass            0.02083
2017-10-18 14:36:26,671 INFO : valid_misclass            0.50000
2017-10-18 14:36:26,672 INFO : test_misclass             0.33333
2017-10-18 14:36:26,674 INFO : runtime                   3.63001
2017-10-18 14:36:26,675 INFO :
2017-10-18 14:36:28,567 INFO : Time only for training updates: 1.88s
2017-10-18 14:36:29,934 INFO : Epoch 16
2017-10-18 14:36:29,935 INFO : train_loss                0.10915
2017-10-18 14:36:29,936 INFO : valid_loss                0.91489
2017-10-18 14:36:29,937 INFO : test_loss                 0.80608
2017-10-18 14:36:29,938 INFO : train_sample_misclass     0.01588
2017-10-18 14:36:29,939 INFO : valid_sample_misclass     0.54234
2017-10-18 14:36:29,940 INFO : test_sample_misclass      0.34537
2017-10-18 14:36:29,941 INFO : train_misclass            0.00000
2017-10-18 14:36:29,942 INFO : valid_misclass            0.33333
2017-10-18 14:36:29,943 INFO : test_misclass             0.33333
2017-10-18 14:36:29,943 INFO : runtime                   3.27961
2017-10-18 14:36:29,944 INFO :
2017-10-18 14:36:29,946 INFO : New best valid_misclass: 0.333333
2017-10-18 14:36:29,947 INFO :
2017-10-18 14:36:31,906 INFO : Time only for training updates: 1.95s
2017-10-18 14:36:33,248 INFO : Epoch 17
2017-10-18 14:36:33,249 INFO : train_loss                0.15003
2017-10-18 14:36:33,250 INFO : valid_loss                0.91323
2017-10-18 14:36:33,251 INFO : test_loss                 0.81002
2017-10-18 14:36:33,252 INFO : train_sample_misclass     0.05403
2017-10-18 14:36:33,253 INFO : valid_sample_misclass     0.51337
2017-10-18 14:36:33,254 INFO : test_sample_misclass      0.34403
2017-10-18 14:36:33,255 INFO : train_misclass            0.04167
2017-10-18 14:36:33,256 INFO : valid_misclass            0.50000
2017-10-18 14:36:33,256 INFO : test_misclass             0.23333
2017-10-18 14:36:33,257 INFO : runtime                   3.33830
2017-10-18 14:36:33,258 INFO :
2017-10-18 14:36:35,205 INFO : Time only for training updates: 1.94s
2017-10-18 14:36:36,576 INFO : Epoch 18
2017-10-18 14:36:36,577 INFO : train_loss                0.09315
2017-10-18 14:36:36,578 INFO : valid_loss                0.89064
2017-10-18 14:36:36,580 INFO : test_loss                 0.77360
2017-10-18 14:36:36,581 INFO : train_sample_misclass     0.01025
2017-10-18 14:36:36,583 INFO : valid_sample_misclass     0.49666
2017-10-18 14:36:36,584 INFO : test_sample_misclass      0.30873
2017-10-18 14:36:36,586 INFO : train_misclass            0.00000
2017-10-18 14:36:36,587 INFO : valid_misclass            0.33333
2017-10-18 14:36:36,588 INFO : test_misclass             0.33333
2017-10-18 14:36:36,589 INFO : runtime                   3.30138
2017-10-18 14:36:36,590 INFO :
2017-10-18 14:36:36,593 INFO : New best valid_misclass: 0.333333
2017-10-18 14:36:36,594 INFO :
2017-10-18 14:36:38,535 INFO : Time only for training updates: 1.93s
2017-10-18 14:36:39,895 INFO : Epoch 19
2017-10-18 14:36:39,896 INFO : train_loss                0.09408
2017-10-18 14:36:39,897 INFO : valid_loss                0.96349
2017-10-18 14:36:39,898 INFO : test_loss                 0.84831
2017-10-18 14:36:39,899 INFO : train_sample_misclass     0.02078
2017-10-18 14:36:39,900 INFO : valid_sample_misclass     0.49042
2017-10-18 14:36:39,901 INFO : test_sample_misclass      0.33137
2017-10-18 14:36:39,901 INFO : train_misclass            0.00000
2017-10-18 14:36:39,902 INFO : valid_misclass            0.50000
2017-10-18 14:36:39,903 INFO : test_misclass             0.30000
2017-10-18 14:36:39,904 INFO : runtime                   3.32518
2017-10-18 14:36:39,905 INFO :
2017-10-18 14:36:41,863 INFO : Time only for training updates: 1.95s
2017-10-18 14:36:43,294 INFO : Epoch 20
2017-10-18 14:36:43,295 INFO : train_loss                0.06822
2017-10-18 14:36:43,296 INFO : valid_loss                1.05598
2017-10-18 14:36:43,297 INFO : test_loss                 0.88760
2017-10-18 14:36:43,298 INFO : train_sample_misclass     0.00847
2017-10-18 14:36:43,300 INFO : valid_sample_misclass     0.51448
2017-10-18 14:36:43,301 INFO : test_sample_misclass      0.33066
2017-10-18 14:36:43,302 INFO : train_misclass            0.00000
2017-10-18 14:36:43,303 INFO : valid_misclass            0.50000
2017-10-18 14:36:43,305 INFO : test_misclass             0.36667
2017-10-18 14:36:43,306 INFO : runtime                   3.33038
2017-10-18 14:36:43,307 INFO :
2017-10-18 14:36:43,308 INFO : Setup for second stop...
2017-10-18 14:36:43,314 INFO : Train loss to reach 0.09315
2017-10-18 14:36:43,315 INFO : Run until second stop...
2017-10-18 14:36:44,773 INFO : Epoch 19
2017-10-18 14:36:44,774 INFO : train_loss                0.25265
2017-10-18 14:36:44,776 INFO : valid_loss                0.89064
2017-10-18 14:36:44,777 INFO : test_loss                 0.77360
2017-10-18 14:36:44,778 INFO : train_sample_misclass     0.10753
2017-10-18 14:36:44,779 INFO : valid_sample_misclass     0.49666
2017-10-18 14:36:44,780 INFO : test_sample_misclass      0.30873
2017-10-18 14:36:44,781 INFO : train_misclass            0.06667
2017-10-18 14:36:44,782 INFO : valid_misclass            0.33333
2017-10-18 14:36:44,783 INFO : test_misclass             0.33333
2017-10-18 14:36:44,784 INFO : runtime                   1.45227
2017-10-18 14:36:44,785 INFO :
2017-10-18 14:36:47,428 INFO : Time only for training updates: 2.62s
2017-10-18 14:36:49,022 INFO : Epoch 20
2017-10-18 14:36:49,024 INFO : train_loss                0.21080
2017-10-18 14:36:49,025 INFO : valid_loss                0.68103
2017-10-18 14:36:49,026 INFO : test_loss                 0.73509
2017-10-18 14:36:49,028 INFO : train_sample_misclass     0.08324
2017-10-18 14:36:49,028 INFO : valid_sample_misclass     0.34915
2017-10-18 14:36:49,029 INFO : test_sample_misclass      0.31025
2017-10-18 14:36:49,030 INFO : train_misclass            0.10000
2017-10-18 14:36:49,031 INFO : valid_misclass            0.50000
2017-10-18 14:36:49,032 INFO : test_misclass             0.26667
2017-10-18 14:36:49,033 INFO : runtime                   4.11350
2017-10-18 14:36:49,033 INFO :
2017-10-18 14:36:51,467 INFO : Time only for training updates: 2.42s
2017-10-18 14:36:53,069 INFO : Epoch 21
2017-10-18 14:36:53,071 INFO : train_loss                0.18816
2017-10-18 14:36:53,072 INFO : valid_loss                0.46174
2017-10-18 14:36:53,073 INFO : test_loss                 0.66965
2017-10-18 14:36:53,074 INFO : train_sample_misclass     0.07406
2017-10-18 14:36:53,075 INFO : valid_sample_misclass     0.24643
2017-10-18 14:36:53,076 INFO : test_sample_misclass      0.28066
2017-10-18 14:36:53,077 INFO : train_misclass            0.05000
2017-10-18 14:36:53,077 INFO : valid_misclass            0.16667
2017-10-18 14:36:53,078 INFO : test_misclass             0.26667
2017-10-18 14:36:53,079 INFO : runtime                   4.03852
2017-10-18 14:36:53,080 INFO :
2017-10-18 14:36:55,529 INFO : Time only for training updates: 2.44s
2017-10-18 14:36:57,074 INFO : Epoch 22
2017-10-18 14:36:57,076 INFO : train_loss                0.13663
2017-10-18 14:36:57,077 INFO : valid_loss                0.28806
2017-10-18 14:36:57,078 INFO : test_loss                 0.63336
2017-10-18 14:36:57,079 INFO : train_sample_misclass     0.02567
2017-10-18 14:36:57,080 INFO : valid_sample_misclass     0.06796
2017-10-18 14:36:57,081 INFO : test_sample_misclass      0.25677
2017-10-18 14:36:57,082 INFO : train_misclass            0.00000
2017-10-18 14:36:57,083 INFO : valid_misclass            0.00000
2017-10-18 14:36:57,084 INFO : test_misclass             0.23333
2017-10-18 14:36:57,085 INFO : runtime                   4.06202
2017-10-18 14:36:57,086 INFO :
2017-10-18 14:36:59,625 INFO : Time only for training updates: 2.53s
2017-10-18 14:37:01,160 INFO : Epoch 23
2017-10-18 14:37:01,161 INFO : train_loss                0.18469
2017-10-18 14:37:01,162 INFO : valid_loss                0.33505
2017-10-18 14:37:01,163 INFO : test_loss                 0.74569
2017-10-18 14:37:01,164 INFO : train_sample_misclass     0.07469
2017-10-18 14:37:01,165 INFO : valid_sample_misclass     0.15575
2017-10-18 14:37:01,166 INFO : test_sample_misclass      0.29652
2017-10-18 14:37:01,167 INFO : train_misclass            0.05000
2017-10-18 14:37:01,168 INFO : valid_misclass            0.08333
2017-10-18 14:37:01,168 INFO : test_misclass             0.26667
2017-10-18 14:37:01,169 INFO : runtime                   4.09383
2017-10-18 14:37:01,170 INFO :
2017-10-18 14:37:03,695 INFO : Time only for training updates: 2.51s
2017-10-18 14:37:05,297 INFO : Epoch 24
2017-10-18 14:37:05,299 INFO : train_loss                0.12348
2017-10-18 14:37:05,300 INFO : valid_loss                0.28360
2017-10-18 14:37:05,301 INFO : test_loss                 0.78044
2017-10-18 14:37:05,302 INFO : train_sample_misclass     0.03632
2017-10-18 14:37:05,303 INFO : valid_sample_misclass     0.10495
2017-10-18 14:37:05,304 INFO : test_sample_misclass      0.28529
2017-10-18 14:37:05,305 INFO : train_misclass            0.03333
2017-10-18 14:37:05,306 INFO : valid_misclass            0.08333
2017-10-18 14:37:05,307 INFO : test_misclass             0.26667
2017-10-18 14:37:05,308 INFO : runtime                   4.06927
2017-10-18 14:37:05,310 INFO :
2017-10-18 14:37:07,772 INFO : Time only for training updates: 2.44s
2017-10-18 14:37:09,352 INFO : Epoch 25
2017-10-18 14:37:09,354 INFO : train_loss                0.14714
2017-10-18 14:37:09,355 INFO : valid_loss                0.19252
2017-10-18 14:37:09,356 INFO : test_loss                 0.77621
2017-10-18 14:37:09,357 INFO : train_sample_misclass     0.04635
2017-10-18 14:37:09,359 INFO : valid_sample_misclass     0.05660
2017-10-18 14:37:09,360 INFO : test_sample_misclass      0.26863
2017-10-18 14:37:09,362 INFO : train_misclass            0.05000
2017-10-18 14:37:09,363 INFO : valid_misclass            0.08333
2017-10-18 14:37:09,364 INFO : test_misclass             0.23333
2017-10-18 14:37:09,366 INFO : runtime                   4.08017
2017-10-18 14:37:09,367 INFO :
2017-10-18 14:37:11,754 INFO : Time only for training updates: 2.37s
2017-10-18 14:37:13,257 INFO : Epoch 26
2017-10-18 14:37:13,259 INFO : train_loss                0.33872
2017-10-18 14:37:13,260 INFO : valid_loss                0.33738
2017-10-18 14:37:13,262 INFO : test_loss                 0.75610
2017-10-18 14:37:13,264 INFO : train_sample_misclass     0.16430
2017-10-18 14:37:13,265 INFO : valid_sample_misclass     0.16689
2017-10-18 14:37:13,266 INFO : test_sample_misclass      0.27763
2017-10-18 14:37:13,267 INFO : train_misclass            0.11667
2017-10-18 14:37:13,269 INFO : valid_misclass            0.16667
2017-10-18 14:37:13,270 INFO : test_misclass             0.26667
2017-10-18 14:37:13,271 INFO : runtime                   3.98591
2017-10-18 14:37:13,272 INFO :
2017-10-18 14:37:15,774 INFO : Time only for training updates: 2.48s
2017-10-18 14:37:17,314 INFO : Epoch 27
2017-10-18 14:37:17,315 INFO : train_loss                0.12509
2017-10-18 14:37:17,316 INFO : valid_loss                0.14952
2017-10-18 14:37:17,317 INFO : test_loss                 0.60954
2017-10-18 14:37:17,318 INFO : train_sample_misclass     0.03111
2017-10-18 14:37:17,318 INFO : valid_sample_misclass     0.02718
2017-10-18 14:37:17,319 INFO : test_sample_misclass      0.23351
2017-10-18 14:37:17,320 INFO : train_misclass            0.01667
2017-10-18 14:37:17,321 INFO : valid_misclass            0.00000
2017-10-18 14:37:17,321 INFO : test_misclass             0.16667
2017-10-18 14:37:17,322 INFO : runtime                   4.01630
2017-10-18 14:37:17,323 INFO :
2017-10-18 14:37:19,768 INFO : Time only for training updates: 2.43s
2017-10-18 14:37:21,331 INFO : Epoch 28
2017-10-18 14:37:21,333 INFO : train_loss                0.09141
2017-10-18 14:37:21,334 INFO : valid_loss                0.15032
2017-10-18 14:37:21,335 INFO : test_loss                 0.64890
2017-10-18 14:37:21,336 INFO : train_sample_misclass     0.01239
2017-10-18 14:37:21,337 INFO : valid_sample_misclass     0.03387
2017-10-18 14:37:21,338 INFO : test_sample_misclass      0.25856
2017-10-18 14:37:21,339 INFO : train_misclass            0.00000
2017-10-18 14:37:21,339 INFO : valid_misclass            0.00000
2017-10-18 14:37:21,340 INFO : test_misclass             0.26667
2017-10-18 14:37:21,341 INFO : runtime                   3.99343
2017-10-18 14:37:21,342 INFO :
2017-10-18 14:37:23,868 INFO : Time only for training updates: 2.51s
2017-10-18 14:37:25,405 INFO : Epoch 29
2017-10-18 14:37:25,406 INFO : train_loss                0.12664
2017-10-18 14:37:25,407 INFO : valid_loss                0.21718
2017-10-18 14:37:25,408 INFO : test_loss                 0.74796
2017-10-18 14:37:25,409 INFO : train_sample_misclass     0.04274
2017-10-18 14:37:25,410 INFO : valid_sample_misclass     0.08623
2017-10-18 14:37:25,411 INFO : test_sample_misclass      0.26381
2017-10-18 14:37:25,411 INFO : train_misclass            0.03333
2017-10-18 14:37:25,412 INFO : valid_misclass            0.08333
2017-10-18 14:37:25,413 INFO : test_misclass             0.23333
2017-10-18 14:37:25,414 INFO : runtime                   4.09971
2017-10-18 14:37:25,415 INFO :
2017-10-18 14:37:27,883 INFO : Time only for training updates: 2.46s
2017-10-18 14:37:29,539 INFO : Epoch 30
2017-10-18 14:37:29,541 INFO : train_loss                0.07408
2017-10-18 14:37:29,542 INFO : valid_loss                0.15273
2017-10-18 14:37:29,543 INFO : test_loss                 0.67137
2017-10-18 14:37:29,544 INFO : train_sample_misclass     0.01497
2017-10-18 14:37:29,546 INFO : valid_sample_misclass     0.06061
2017-10-18 14:37:29,547 INFO : test_sample_misclass      0.23984
2017-10-18 14:37:29,548 INFO : train_misclass            0.01667
2017-10-18 14:37:29,549 INFO : valid_misclass            0.08333
2017-10-18 14:37:29,550 INFO : test_misclass             0.20000
2017-10-18 14:37:29,551 INFO : runtime                   4.01253
2017-10-18 14:37:29,552 INFO :
2017-10-18 14:37:32,114 INFO : Time only for training updates: 2.55s
2017-10-18 14:37:33,748 INFO : Epoch 31
2017-10-18 14:37:33,750 INFO : train_loss                0.05036
2017-10-18 14:37:33,751 INFO : valid_loss                0.09104
2017-10-18 14:37:33,752 INFO : test_loss                 0.66771
2017-10-18 14:37:33,753 INFO : train_sample_misclass     0.00744
2017-10-18 14:37:33,755 INFO : valid_sample_misclass     0.02317
2017-10-18 14:37:33,756 INFO : test_sample_misclass      0.20677
2017-10-18 14:37:33,757 INFO : train_misclass            0.00000
2017-10-18 14:37:33,758 INFO : valid_misclass            0.00000
2017-10-18 14:37:33,759 INFO : test_misclass             0.20000
2017-10-18 14:37:33,760 INFO : runtime                   4.23093
2017-10-18 14:37:33,761 INFO :
</pre></div></div>
</div>
<p>In this case, we arrive at 80.0% accuracy, the training stops after the
validation loss decreases below the training loss at the best epoch of
0.09315.</p>
</div>
<div class="section" id="Dataset-References">
<h2>Dataset References<a class="headerlink" href="#Dataset-References" title="Permalink to this headline">Â¶</a></h2>
<p>This dataset was created and contributed to PhysioNet by the developers
of the <a class="reference external" href="http://www.schalklab.org/research/bci2000">BCI2000</a>
instrumentation system, which they used in making these recordings. The
system is described in:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Schalk</span><span class="p">,</span> <span class="n">G</span><span class="o">.</span><span class="p">,</span> <span class="n">McFarland</span><span class="p">,</span> <span class="n">D</span><span class="o">.</span><span class="n">J</span><span class="o">.</span><span class="p">,</span> <span class="n">Hinterberger</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="p">,</span> <span class="n">Birbaumer</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="p">,</span> <span class="n">Wolpaw</span><span class="p">,</span> <span class="n">J</span><span class="o">.</span><span class="n">R</span><span class="o">.</span> <span class="p">(</span><span class="mi">2004</span><span class="p">)</span> <span class="n">BCI2000</span><span class="p">:</span> <span class="n">A</span> <span class="n">General</span><span class="o">-</span><span class="n">Purpose</span> <span class="n">Brain</span><span class="o">-</span><span class="n">Computer</span> <span class="n">Interface</span> <span class="p">(</span><span class="n">BCI</span><span class="p">)</span> <span class="n">System</span><span class="o">.</span> <span class="n">IEEE</span> <span class="n">TBME</span> <span class="mi">51</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span><span class="mi">1034</span><span class="o">-</span><span class="mf">1043.</span>
</pre></div>
</div>
<p><a class="reference external" href="https://physionet.org/physiobank/">PhysioBank</a> is a large and
growing archive of well-characterized digital recordings of physiologic
signals and related data for use by the biomedical research community
and further described in:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Goldberger</span> <span class="n">AL</span><span class="p">,</span> <span class="n">Amaral</span> <span class="n">LAN</span><span class="p">,</span> <span class="n">Glass</span> <span class="n">L</span><span class="p">,</span> <span class="n">Hausdorff</span> <span class="n">JM</span><span class="p">,</span> <span class="n">Ivanov</span> <span class="n">PCh</span><span class="p">,</span> <span class="n">Mark</span> <span class="n">RG</span><span class="p">,</span> <span class="n">Mietus</span> <span class="n">JE</span><span class="p">,</span> <span class="n">Moody</span> <span class="n">GB</span><span class="p">,</span> <span class="n">Peng</span> <span class="n">C</span><span class="o">-</span><span class="n">K</span><span class="p">,</span> <span class="n">Stanley</span> <span class="n">HE</span><span class="o">.</span> <span class="p">(</span><span class="mi">2000</span><span class="p">)</span> <span class="n">PhysioBank</span><span class="p">,</span> <span class="n">PhysioToolkit</span><span class="p">,</span> <span class="ow">and</span> <span class="n">PhysioNet</span><span class="p">:</span> <span class="n">Components</span> <span class="n">of</span> <span class="n">a</span> <span class="n">New</span> <span class="n">Research</span> <span class="n">Resource</span> <span class="k">for</span> <span class="n">Complex</span> <span class="n">Physiologic</span> <span class="n">Signals</span><span class="o">.</span> <span class="n">Circulation</span> <span class="mi">101</span><span class="p">(</span><span class="mi">23</span><span class="p">):</span><span class="n">e215</span><span class="o">-</span><span class="n">e220</span><span class="o">.</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="visualization/Perturbation.html" class="btn btn-neutral float-right" title="Amplitude Perturbation Visualization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Cropped_Decoding.html" class="btn btn-neutral" title="Cropped Decoding" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Robin Tibor Schirrmeister.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.3.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>