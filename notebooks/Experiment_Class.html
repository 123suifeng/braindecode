

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using the Experiment Class &mdash; Braindecode 0.1.5 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Braindecode 0.1.5 documentation" href="../index.html"/>
        <link rel="next" title="braindecode.datautil package" href="../source/braindecode.datautil.html"/>
        <link rel="prev" title="Cropped Decoding" href="Cropped_Decoding.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Braindecode
          

          
          </a>

          
            
            
              <div class="version">
                0.1.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="TrialWise_Decoding.html">Trialwise Decoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cropped_Decoding.html">Cropped Decoding</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using the Experiment Class</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Load-data">Load data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Convert-data-to-Braindecode-Format">Convert data to Braindecode Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Create-the-model">Create the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Setup-Experiment">Setup Experiment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Run-experiment">Run experiment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Dataset-References">Dataset References</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.datautil.html">braindecode.datautil package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.experiments.html">braindecode.experiments package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.mne_ext.html">braindecode.mne_ext package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.models.html">braindecode.models package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.torch_ext.html">braindecode.torch_ext package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Braindecode</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Using the Experiment Class</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/Experiment_Class.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Using-the-Experiment-Class">
<h1>Using the Experiment Class<a class="headerlink" href="#Using-the-Experiment-Class" title="Permalink to this headline">¶</a></h1>
<p>Braindecode provides a convenience <code class="docutils literal"><span class="pre">Experiment</span></code> class, which removes
the necessity to write your own training loop. It expects a training, a
validation and a test set and trains as follows:</p>
<ol class="arabic simple">
<li>Train on training set until a given stop criterion is fulfilled</li>
<li>Reset to the best epoch, i.e. reset parameters of the model and the
optimizer to the state at the best epoch (“best” according to a given
criterion)</li>
<li>Continue training on the combined training + validation set until the
loss on the validation set is as low as it was on the best epoch for
the training set. (or until the ConvNet was trained twice as many
epochs as the best epoch to prevent infinite training)</li>
</ol>
<div class="admonition warning">
It is not necessary to use the Experiment class to use the remaning
functionality of Braindecode. Feel free to ignore it :)</div>
<div class="section" id="Load-data">
<h2>Load data<a class="headerlink" href="#Load-data" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">from</span> <span class="nn">mne.io</span> <span class="k">import</span> <span class="n">concatenate_raws</span>

<span class="c1"># 5,6,7,10,13,14 are codes for executed and imagined hands/feet</span>
<span class="n">subject_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">event_codes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">]</span>

<span class="c1"># This will download the files if you don&#39;t have them yet,</span>
<span class="c1"># and then return the paths to the files.</span>
<span class="n">physionet_paths</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">eegbci</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">subject_id</span><span class="p">,</span> <span class="n">event_codes</span><span class="p">)</span>

<span class="c1"># Load each of the files</span>
<span class="n">parts</span> <span class="o">=</span> <span class="p">[</span><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_edf</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="s1">&#39;WARNING&#39;</span><span class="p">)</span>
         <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">physionet_paths</span><span class="p">]</span>

<span class="c1"># Concatenate them</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">concatenate_raws</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span>

<span class="c1"># Find the events in this dataset</span>
<span class="n">events</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">find_events</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">shortest_event</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;STI 014&#39;</span><span class="p">)</span>

<span class="c1"># Use only EEG channels</span>
<span class="n">eeg_channel_inds</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">exclude</span><span class="o">=</span><span class="s1">&#39;bads&#39;</span><span class="p">)</span>

<span class="c1"># Extract trials, only using EEG channels</span>
<span class="n">epoched</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">hands</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">feet</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span> <span class="n">tmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">4.1</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">eeg_channel_inds</span><span class="p">,</span>
                <span class="n">baseline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Removing orphaned offset at the beginning of the file.
179 events found
Events id: [1 2 3]
90 matching events found
Loading data for 90 events and 497 original time points ...
0 bad epochs dropped
</pre></div></div>
</div>
</div>
<div class="section" id="Convert-data-to-Braindecode-Format">
<h2>Convert data to Braindecode Format<a class="headerlink" href="#Convert-data-to-Braindecode-Format" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">braindecode.datautil.signal_target</span> <span class="k">import</span> <span class="n">SignalAndTarget</span>
<span class="kn">from</span> <span class="nn">braindecode.datautil.splitters</span> <span class="k">import</span> <span class="n">split_into_two_sets</span>
<span class="c1"># Convert data from volt to millivolt</span>
<span class="c1"># Pytorch expects float32 for input and int64 for labels.</span>
<span class="n">X</span> <span class="o">=</span> <span class="p">(</span><span class="n">epoched</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">epoched</span><span class="o">.</span><span class="n">events</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span> <span class="c1">#2,3 -&gt; 0,1</span>

<span class="n">train_set</span> <span class="o">=</span> <span class="n">SignalAndTarget</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">60</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">[:</span><span class="mi">60</span><span class="p">])</span>
<span class="n">test_set</span> <span class="o">=</span> <span class="n">SignalAndTarget</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">60</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">60</span><span class="p">:])</span>

<span class="n">train_set</span><span class="p">,</span> <span class="n">valid_set</span> <span class="o">=</span> <span class="n">split_into_two_sets</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> <span class="n">first_set_fraction</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Create-the-model">
<h2>Create the model<a class="headerlink" href="#Create-the-model" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.models.shallow_fbcsp</span> <span class="k">import</span> <span class="n">ShallowFBCSPNet</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="k">import</span> <span class="n">nn</span>
<span class="kn">from</span> <span class="nn">braindecode.torch_ext.util</span> <span class="k">import</span> <span class="n">set_random_seeds</span>
<span class="kn">from</span> <span class="nn">braindecode.models.util</span> <span class="k">import</span> <span class="n">to_dense_prediction_model</span>

<span class="c1"># Set if you want to use GPU</span>
<span class="c1"># You can also use torch.cuda.is_available() to determine if cuda is available on your machine.</span>
<span class="n">cuda</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">set_random_seeds</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">20170629</span><span class="p">,</span> <span class="n">cuda</span><span class="o">=</span><span class="n">cuda</span><span class="p">)</span>

<span class="c1"># This will determine how many crops are processed in parallel</span>
<span class="n">input_time_length</span> <span class="o">=</span> <span class="mi">450</span>
<span class="n">n_classes</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">in_chans</span> <span class="o">=</span> <span class="n">train_set</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># final_conv_length determines the size of the receptive field of the ConvNet</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ShallowFBCSPNet</span><span class="p">(</span><span class="n">in_chans</span><span class="o">=</span><span class="n">in_chans</span><span class="p">,</span> <span class="n">n_classes</span><span class="o">=</span><span class="n">n_classes</span><span class="p">,</span> <span class="n">input_time_length</span><span class="o">=</span><span class="n">input_time_length</span><span class="p">,</span>
                        <span class="n">final_conv_length</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">create_network</span><span class="p">()</span>
<span class="n">to_dense_prediction_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="k">if</span> <span class="n">cuda</span><span class="p">:</span>
    <span class="n">model</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">torch</span> <span class="k">import</span> <span class="n">optim</span>

<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.torch_ext.util</span> <span class="k">import</span> <span class="n">np_to_var</span>
<span class="c1"># determine output size</span>
<span class="n">test_input</span> <span class="o">=</span> <span class="n">np_to_var</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">in_chans</span><span class="p">,</span> <span class="n">input_time_length</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="k">if</span> <span class="n">cuda</span><span class="p">:</span>
    <span class="n">test_input</span> <span class="o">=</span> <span class="n">test_input</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">test_input</span><span class="p">)</span>
<span class="n">n_preds_per_input</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:d}</span><span class="s2"> predictions per input/trial&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n_preds_per_input</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
187 predictions per input/trial
</pre></div></div>
</div>
</div>
<div class="section" id="Setup-Experiment">
<h2>Setup Experiment<a class="headerlink" href="#Setup-Experiment" title="Permalink to this headline">¶</a></h2>
<p>Now we need to setup everything for the experiment: Iterator, loss
function, monitors and stop criterion.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.experiments.experiment</span> <span class="k">import</span> <span class="n">Experiment</span>
<span class="kn">from</span> <span class="nn">braindecode.datautil.iterators</span> <span class="k">import</span> <span class="n">CropsFromTrialsIterator</span>
<span class="kn">from</span> <span class="nn">braindecode.experiments.monitors</span> <span class="k">import</span> <span class="n">RuntimeMonitor</span><span class="p">,</span> <span class="n">LossMonitor</span><span class="p">,</span> <span class="n">CroppedTrialMisclassMonitor</span><span class="p">,</span> <span class="n">MisclassMonitor</span>
<span class="kn">from</span> <span class="nn">braindecode.experiments.stopcriteria</span> <span class="k">import</span> <span class="n">MaxEpochs</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">torch</span> <span class="k">as</span> <span class="nn">th</span>
<span class="kn">from</span> <span class="nn">braindecode.torch_ext.modules</span> <span class="k">import</span> <span class="n">Expression</span>
<span class="c1"># Iterator is used to iterate over datasets both for training</span>
<span class="c1"># and evaluation</span>
<span class="n">iterator</span> <span class="o">=</span> <span class="n">CropsFromTrialsIterator</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span><span class="n">input_time_length</span><span class="o">=</span><span class="n">input_time_length</span><span class="p">,</span>
                                  <span class="n">n_preds_per_input</span><span class="o">=</span><span class="n">n_preds_per_input</span><span class="p">)</span>

<span class="c1"># Loss function takes predictions as they come out of the network and the targets</span>
<span class="c1"># and returns a loss</span>
<span class="n">loss_function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">preds</span><span class="p">,</span> <span class="n">targets</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)[:,:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">targets</span><span class="p">)</span>

<span class="c1"># Could be used to apply some constraint on the models, then should be object</span>
<span class="c1"># with apply method that accepts a module</span>
<span class="n">model_constraint</span> <span class="o">=</span> <span class="kc">None</span>
<span class="c1"># Monitors log the training progress</span>
<span class="n">monitors</span> <span class="o">=</span> <span class="p">[</span><span class="n">LossMonitor</span><span class="p">(),</span> <span class="n">MisclassMonitor</span><span class="p">(</span><span class="n">col_suffix</span><span class="o">=</span><span class="s1">&#39;sample_misclass&#39;</span><span class="p">),</span>
            <span class="n">CroppedTrialMisclassMonitor</span><span class="p">(</span><span class="n">input_time_length</span><span class="p">),</span> <span class="n">RuntimeMonitor</span><span class="p">(),]</span>
<span class="c1"># Stop criterion determines when the first stop happens</span>
<span class="n">stop_criterion</span> <span class="o">=</span> <span class="n">MaxEpochs</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">Experiment</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train_set</span><span class="p">,</span> <span class="n">valid_set</span><span class="p">,</span> <span class="n">test_set</span><span class="p">,</span> <span class="n">iterator</span><span class="p">,</span> <span class="n">loss_function</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">model_constraint</span><span class="p">,</span>
          <span class="n">monitors</span><span class="p">,</span> <span class="n">stop_criterion</span><span class="p">,</span> <span class="n">remember_best_column</span><span class="o">=</span><span class="s1">&#39;valid_misclass&#39;</span><span class="p">,</span>
          <span class="n">run_after_early_stop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">batch_modifier</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cuda</span><span class="o">=</span><span class="n">cuda</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Run-experiment">
<h2>Run experiment<a class="headerlink" href="#Run-experiment" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># need to setup python logging before to be able to see anything</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> </span><span class="si">%(levelname)s</span><span class="s1"> : </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
                     <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
<span class="n">exp</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2017-07-05 21:31:32,786 INFO : Run until first stop...
2017-07-05 21:31:33,114 INFO : Epoch 0
2017-07-05 21:31:33,116 INFO : train_loss                0.86930
2017-07-05 21:31:33,118 INFO : valid_loss                0.74838
2017-07-05 21:31:33,119 INFO : test_loss                 0.69756
2017-07-05 21:31:33,121 INFO : train_sample_misclass     0.53894
2017-07-05 21:31:33,122 INFO : valid_sample_misclass     0.47103
2017-07-05 21:31:33,124 INFO : test_sample_misclass      0.44251
2017-07-05 21:31:33,125 INFO : train_misclass            0.60417
2017-07-05 21:31:33,127 INFO : valid_misclass            0.50000
2017-07-05 21:31:33,128 INFO : test_misclass             0.40000
2017-07-05 21:31:33,130 INFO : runtime                   0.00000
2017-07-05 21:31:33,131 INFO :
2017-07-05 21:31:33,133 INFO : New best valid_misclass: 0.500000
2017-07-05 21:31:33,135 INFO :
2017-07-05 21:31:34,533 INFO : Epoch 1
2017-07-05 21:31:34,540 INFO : train_loss                2.33626
2017-07-05 21:31:34,542 INFO : valid_loss                2.31771
2017-07-05 21:31:34,543 INFO : test_loss                 2.14077
2017-07-05 21:31:34,545 INFO : train_sample_misclass     0.48279
2017-07-05 21:31:34,546 INFO : valid_sample_misclass     0.50000
2017-07-05 21:31:34,547 INFO : test_sample_misclass      0.46667
2017-07-05 21:31:34,549 INFO : train_misclass            0.50000
2017-07-05 21:31:34,550 INFO : valid_misclass            0.50000
2017-07-05 21:31:34,552 INFO : test_misclass             0.46667
2017-07-05 21:31:34,553 INFO : runtime                   1.36540
2017-07-05 21:31:34,555 INFO :
2017-07-05 21:31:34,557 INFO : New best valid_misclass: 0.500000
2017-07-05 21:31:34,558 INFO :
2017-07-05 21:31:36,013 INFO : Epoch 2
2017-07-05 21:31:36,016 INFO : train_loss                0.59815
2017-07-05 21:31:36,017 INFO : valid_loss                0.78503
2017-07-05 21:31:36,019 INFO : test_loss                 0.70060
2017-07-05 21:31:36,020 INFO : train_sample_misclass     0.33918
2017-07-05 21:31:36,022 INFO : valid_sample_misclass     0.47995
2017-07-05 21:31:36,023 INFO : test_sample_misclass      0.41996
2017-07-05 21:31:36,025 INFO : train_misclass            0.22917
2017-07-05 21:31:36,026 INFO : valid_misclass            0.41667
2017-07-05 21:31:36,028 INFO : test_misclass             0.43333
2017-07-05 21:31:36,029 INFO : runtime                   1.42190
2017-07-05 21:31:36,031 INFO :
2017-07-05 21:31:36,033 INFO : New best valid_misclass: 0.416667
2017-07-05 21:31:36,035 INFO :
2017-07-05 21:31:37,526 INFO : Epoch 3
2017-07-05 21:31:37,528 INFO : train_loss                0.53121
2017-07-05 21:31:37,530 INFO : valid_loss                0.87284
2017-07-05 21:31:37,531 INFO : test_loss                 0.69774
2017-07-05 21:31:37,533 INFO : train_sample_misclass     0.24588
2017-07-05 21:31:37,534 INFO : valid_sample_misclass     0.55548
2017-07-05 21:31:37,535 INFO : test_sample_misclass      0.42709
2017-07-05 21:31:37,537 INFO : train_misclass            0.22917
2017-07-05 21:31:37,538 INFO : valid_misclass            0.50000
2017-07-05 21:31:37,540 INFO : test_misclass             0.36667
2017-07-05 21:31:37,541 INFO : runtime                   1.51079
2017-07-05 21:31:37,543 INFO :
2017-07-05 21:31:39,034 INFO : Epoch 4
2017-07-05 21:31:39,037 INFO : train_loss                0.51574
2017-07-05 21:31:39,038 INFO : valid_loss                1.10377
2017-07-05 21:31:39,039 INFO : test_loss                 0.80095
2017-07-05 21:31:39,041 INFO : train_sample_misclass     0.25869
2017-07-05 21:31:39,042 INFO : valid_sample_misclass     0.60094
2017-07-05 21:31:39,044 INFO : test_sample_misclass      0.42727
2017-07-05 21:31:39,045 INFO : train_misclass            0.27083
2017-07-05 21:31:39,047 INFO : valid_misclass            0.58333
2017-07-05 21:31:39,048 INFO : test_misclass             0.46667
2017-07-05 21:31:39,050 INFO : runtime                   1.50730
2017-07-05 21:31:39,051 INFO :
2017-07-05 21:31:40,540 INFO : Epoch 5
2017-07-05 21:31:40,543 INFO : train_loss                0.52613
2017-07-05 21:31:40,544 INFO : valid_loss                1.22322
2017-07-05 21:31:40,544 INFO : test_loss                 0.86285
2017-07-05 21:31:40,546 INFO : train_sample_misclass     0.27635
2017-07-05 21:31:40,548 INFO : valid_sample_misclass     0.58445
2017-07-05 21:31:40,549 INFO : test_sample_misclass      0.43841
2017-07-05 21:31:40,551 INFO : train_misclass            0.33333
2017-07-05 21:31:40,552 INFO : valid_misclass            0.58333
2017-07-05 21:31:40,554 INFO : test_misclass             0.46667
2017-07-05 21:31:40,555 INFO : runtime                   1.49828
2017-07-05 21:31:40,557 INFO :
2017-07-05 21:31:42,273 INFO : Epoch 6
2017-07-05 21:31:42,279 INFO : train_loss                0.54906
2017-07-05 21:31:42,279 INFO : valid_loss                1.23573
2017-07-05 21:31:42,280 INFO : test_loss                 0.92210
2017-07-05 21:31:42,282 INFO : train_sample_misclass     0.28816
2017-07-05 21:31:42,283 INFO : valid_sample_misclass     0.53810
2017-07-05 21:31:42,285 INFO : test_sample_misclass      0.45205
2017-07-05 21:31:42,286 INFO : train_misclass            0.33333
2017-07-05 21:31:42,288 INFO : valid_misclass            0.58333
2017-07-05 21:31:42,289 INFO : test_misclass             0.46667
2017-07-05 21:31:42,291 INFO : runtime                   1.71457
2017-07-05 21:31:42,292 INFO :
2017-07-05 21:31:44,067 INFO : Epoch 7
2017-07-05 21:31:44,069 INFO : train_loss                0.59627
2017-07-05 21:31:44,070 INFO : valid_loss                1.16602
2017-07-05 21:31:44,070 INFO : test_loss                 0.95655
2017-07-05 21:31:44,071 INFO : train_sample_misclass     0.32253
2017-07-05 21:31:44,073 INFO : valid_sample_misclass     0.53053
2017-07-05 21:31:44,074 INFO : test_sample_misclass      0.46346
2017-07-05 21:31:44,076 INFO : train_misclass            0.37500
2017-07-05 21:31:44,077 INFO : valid_misclass            0.58333
2017-07-05 21:31:44,079 INFO : test_misclass             0.46667
2017-07-05 21:31:44,080 INFO : runtime                   1.84267
2017-07-05 21:31:44,082 INFO :
2017-07-05 21:31:45,747 INFO : Epoch 8
2017-07-05 21:31:45,749 INFO : train_loss                0.40527
2017-07-05 21:31:45,749 INFO : valid_loss                0.95821
2017-07-05 21:31:45,750 INFO : test_loss                 0.79267
2017-07-05 21:31:45,751 INFO : train_sample_misclass     0.19112
2017-07-05 21:31:45,751 INFO : valid_sample_misclass     0.52607
2017-07-05 21:31:45,753 INFO : test_sample_misclass      0.43351
2017-07-05 21:31:45,755 INFO : train_misclass            0.16667
2017-07-05 21:31:45,756 INFO : valid_misclass            0.58333
2017-07-05 21:31:45,758 INFO : test_misclass             0.40000
2017-07-05 21:31:45,759 INFO : runtime                   1.61183
2017-07-05 21:31:45,760 INFO :
2017-07-05 21:31:47,554 INFO : Epoch 9
2017-07-05 21:31:47,556 INFO : train_loss                0.30290
2017-07-05 21:31:47,557 INFO : valid_loss                0.89596
2017-07-05 21:31:47,557 INFO : test_loss                 0.75205
2017-07-05 21:31:47,558 INFO : train_sample_misclass     0.10968
2017-07-05 21:31:47,559 INFO : valid_sample_misclass     0.56684
2017-07-05 21:31:47,559 INFO : test_sample_misclass      0.43119
2017-07-05 21:31:47,560 INFO : train_misclass            0.08333
2017-07-05 21:31:47,561 INFO : valid_misclass            0.58333
2017-07-05 21:31:47,561 INFO : test_misclass             0.36667
2017-07-05 21:31:47,562 INFO : runtime                   1.69427
2017-07-05 21:31:47,562 INFO :
2017-07-05 21:31:49,598 INFO : Epoch 10
2017-07-05 21:31:49,600 INFO : train_loss                0.25623
2017-07-05 21:31:49,602 INFO : valid_loss                0.89555
2017-07-05 21:31:49,604 INFO : test_loss                 0.75208
2017-07-05 21:31:49,605 INFO : train_sample_misclass     0.06088
2017-07-05 21:31:49,607 INFO : valid_sample_misclass     0.55637
2017-07-05 21:31:49,608 INFO : test_sample_misclass      0.41765
2017-07-05 21:31:49,610 INFO : train_misclass            0.02083
2017-07-05 21:31:49,611 INFO : valid_misclass            0.58333
2017-07-05 21:31:49,613 INFO : test_misclass             0.33333
2017-07-05 21:31:49,614 INFO : runtime                   2.20880
2017-07-05 21:31:49,616 INFO :
2017-07-05 21:31:51,481 INFO : Epoch 11
2017-07-05 21:31:51,484 INFO : train_loss                0.24021
2017-07-05 21:31:51,485 INFO : valid_loss                0.90581
2017-07-05 21:31:51,487 INFO : test_loss                 0.75648
2017-07-05 21:31:51,488 INFO : train_sample_misclass     0.06205
2017-07-05 21:31:51,490 INFO : valid_sample_misclass     0.54256
2017-07-05 21:31:51,491 INFO : test_sample_misclass      0.39804
2017-07-05 21:31:51,493 INFO : train_misclass            0.02083
2017-07-05 21:31:51,494 INFO : valid_misclass            0.58333
2017-07-05 21:31:51,496 INFO : test_misclass             0.33333
2017-07-05 21:31:51,497 INFO : runtime                   1.73855
2017-07-05 21:31:51,499 INFO :
2017-07-05 21:31:53,411 INFO : Epoch 12
2017-07-05 21:31:53,414 INFO : train_loss                0.20491
2017-07-05 21:31:53,416 INFO : valid_loss                0.90257
2017-07-05 21:31:53,417 INFO : test_loss                 0.75600
2017-07-05 21:31:53,419 INFO : train_sample_misclass     0.05041
2017-07-05 21:31:53,420 INFO : valid_sample_misclass     0.54055
2017-07-05 21:31:53,422 INFO : test_sample_misclass      0.39501
2017-07-05 21:31:53,423 INFO : train_misclass            0.00000
2017-07-05 21:31:53,424 INFO : valid_misclass            0.58333
2017-07-05 21:31:53,426 INFO : test_misclass             0.33333
2017-07-05 21:31:53,427 INFO : runtime                   2.05539
2017-07-05 21:31:53,429 INFO :
2017-07-05 21:31:55,404 INFO : Epoch 13
2017-07-05 21:31:55,406 INFO : train_loss                0.17244
2017-07-05 21:31:55,408 INFO : valid_loss                0.90562
2017-07-05 21:31:55,409 INFO : test_loss                 0.76539
2017-07-05 21:31:55,410 INFO : train_sample_misclass     0.03793
2017-07-05 21:31:55,412 INFO : valid_sample_misclass     0.56194
2017-07-05 21:31:55,413 INFO : test_sample_misclass      0.38752
2017-07-05 21:31:55,415 INFO : train_misclass            0.00000
2017-07-05 21:31:55,416 INFO : valid_misclass            0.66667
2017-07-05 21:31:55,418 INFO : test_misclass             0.36667
2017-07-05 21:31:55,419 INFO : runtime                   1.96334
2017-07-05 21:31:55,421 INFO :
2017-07-05 21:31:57,279 INFO : Epoch 14
2017-07-05 21:31:57,282 INFO : train_loss                0.15207
2017-07-05 21:31:57,284 INFO : valid_loss                0.90600
2017-07-05 21:31:57,285 INFO : test_loss                 0.76428
2017-07-05 21:31:57,287 INFO : train_sample_misclass     0.02969
2017-07-05 21:31:57,288 INFO : valid_sample_misclass     0.54924
2017-07-05 21:31:57,290 INFO : test_sample_misclass      0.36551
2017-07-05 21:31:57,291 INFO : train_misclass            0.00000
2017-07-05 21:31:57,293 INFO : valid_misclass            0.58333
2017-07-05 21:31:57,294 INFO : test_misclass             0.36667
2017-07-05 21:31:57,296 INFO : runtime                   1.93236
2017-07-05 21:31:57,297 INFO :
2017-07-05 21:31:59,000 INFO : Epoch 15
2017-07-05 21:31:59,002 INFO : train_loss                0.14998
2017-07-05 21:31:59,004 INFO : valid_loss                0.96411
2017-07-05 21:31:59,005 INFO : test_loss                 0.81256
2017-07-05 21:31:59,007 INFO : train_sample_misclass     0.04027
2017-07-05 21:31:59,008 INFO : valid_sample_misclass     0.48061
2017-07-05 21:31:59,010 INFO : test_sample_misclass      0.35811
2017-07-05 21:31:59,012 INFO : train_misclass            0.02083
2017-07-05 21:31:59,013 INFO : valid_misclass            0.50000
2017-07-05 21:31:59,015 INFO : test_misclass             0.33333
2017-07-05 21:31:59,016 INFO : runtime                   1.70471
2017-07-05 21:31:59,018 INFO :
2017-07-05 21:32:00,528 INFO : Epoch 16
2017-07-05 21:32:00,531 INFO : train_loss                0.10915
2017-07-05 21:32:00,532 INFO : valid_loss                0.91490
2017-07-05 21:32:00,534 INFO : test_loss                 0.80608
2017-07-05 21:32:00,535 INFO : train_sample_misclass     0.01588
2017-07-05 21:32:00,537 INFO : valid_sample_misclass     0.54234
2017-07-05 21:32:00,538 INFO : test_sample_misclass      0.34537
2017-07-05 21:32:00,540 INFO : train_misclass            0.00000
2017-07-05 21:32:00,541 INFO : valid_misclass            0.33333
2017-07-05 21:32:00,543 INFO : test_misclass             0.33333
2017-07-05 21:32:00,544 INFO : runtime                   1.54202
2017-07-05 21:32:00,546 INFO :
2017-07-05 21:32:00,548 INFO : New best valid_misclass: 0.333333
2017-07-05 21:32:00,550 INFO :
2017-07-05 21:32:02,388 INFO : Epoch 17
2017-07-05 21:32:02,391 INFO : train_loss                0.15003
2017-07-05 21:32:02,392 INFO : valid_loss                0.91323
2017-07-05 21:32:02,394 INFO : test_loss                 0.81002
2017-07-05 21:32:02,395 INFO : train_sample_misclass     0.05403
2017-07-05 21:32:02,397 INFO : valid_sample_misclass     0.51337
2017-07-05 21:32:02,398 INFO : test_sample_misclass      0.34403
2017-07-05 21:32:02,400 INFO : train_misclass            0.04167
2017-07-05 21:32:02,401 INFO : valid_misclass            0.50000
2017-07-05 21:32:02,403 INFO : test_misclass             0.23333
2017-07-05 21:32:02,404 INFO : runtime                   1.79031
2017-07-05 21:32:02,406 INFO :
2017-07-05 21:32:04,095 INFO : Epoch 18
2017-07-05 21:32:04,097 INFO : train_loss                0.09315
2017-07-05 21:32:04,099 INFO : valid_loss                0.89064
2017-07-05 21:32:04,100 INFO : test_loss                 0.77360
2017-07-05 21:32:04,102 INFO : train_sample_misclass     0.01025
2017-07-05 21:32:04,103 INFO : valid_sample_misclass     0.49666
2017-07-05 21:32:04,105 INFO : test_sample_misclass      0.30873
2017-07-05 21:32:04,106 INFO : train_misclass            0.00000
2017-07-05 21:32:04,107 INFO : valid_misclass            0.33333
2017-07-05 21:32:04,109 INFO : test_misclass             0.33333
2017-07-05 21:32:04,110 INFO : runtime                   1.76363
2017-07-05 21:32:04,112 INFO :
2017-07-05 21:32:04,114 INFO : New best valid_misclass: 0.333333
2017-07-05 21:32:04,116 INFO :
2017-07-05 21:32:05,930 INFO : Epoch 19
2017-07-05 21:32:05,938 INFO : train_loss                0.09407
2017-07-05 21:32:05,940 INFO : valid_loss                0.96350
2017-07-05 21:32:05,941 INFO : test_loss                 0.84831
2017-07-05 21:32:05,943 INFO : train_sample_misclass     0.02078
2017-07-05 21:32:05,945 INFO : valid_sample_misclass     0.49042
2017-07-05 21:32:05,946 INFO : test_sample_misclass      0.33137
2017-07-05 21:32:05,948 INFO : train_misclass            0.00000
2017-07-05 21:32:05,950 INFO : valid_misclass            0.50000
2017-07-05 21:32:05,951 INFO : test_misclass             0.30000
2017-07-05 21:32:05,953 INFO : runtime                   1.62952
2017-07-05 21:32:05,954 INFO :
2017-07-05 21:32:07,614 INFO : Epoch 20
2017-07-05 21:32:07,616 INFO : train_loss                0.06822
2017-07-05 21:32:07,618 INFO : valid_loss                1.05598
2017-07-05 21:32:07,620 INFO : test_loss                 0.88760
2017-07-05 21:32:07,621 INFO : train_sample_misclass     0.00847
2017-07-05 21:32:07,623 INFO : valid_sample_misclass     0.51448
2017-07-05 21:32:07,624 INFO : test_sample_misclass      0.33066
2017-07-05 21:32:07,626 INFO : train_misclass            0.00000
2017-07-05 21:32:07,627 INFO : valid_misclass            0.50000
2017-07-05 21:32:07,629 INFO : test_misclass             0.36667
2017-07-05 21:32:07,629 INFO : runtime                   1.89068
2017-07-05 21:32:07,630 INFO :
2017-07-05 21:32:07,631 INFO : Setup for second stop...
2017-07-05 21:32:07,635 INFO : Train loss to reach 0.09315
2017-07-05 21:32:07,637 INFO : Run until second stop...
2017-07-05 21:32:08,010 INFO : Epoch 19
2017-07-05 21:32:08,012 INFO : train_loss                0.25265
2017-07-05 21:32:08,014 INFO : valid_loss                0.89064
2017-07-05 21:32:08,015 INFO : test_loss                 0.77360
2017-07-05 21:32:08,016 INFO : train_sample_misclass     0.10753
2017-07-05 21:32:08,018 INFO : valid_sample_misclass     0.49666
2017-07-05 21:32:08,019 INFO : test_sample_misclass      0.30873
2017-07-05 21:32:08,021 INFO : train_misclass            0.06667
2017-07-05 21:32:08,022 INFO : valid_misclass            0.33333
2017-07-05 21:32:08,024 INFO : test_misclass             0.33333
2017-07-05 21:32:08,025 INFO : runtime                   0.46578
2017-07-05 21:32:08,027 INFO :
2017-07-05 21:32:10,279 INFO : Epoch 20
2017-07-05 21:32:10,281 INFO : train_loss                0.21080
2017-07-05 21:32:10,283 INFO : valid_loss                0.68103
2017-07-05 21:32:10,284 INFO : test_loss                 0.73508
2017-07-05 21:32:10,286 INFO : train_sample_misclass     0.08324
2017-07-05 21:32:10,287 INFO : valid_sample_misclass     0.34915
2017-07-05 21:32:10,289 INFO : test_sample_misclass      0.31025
2017-07-05 21:32:10,290 INFO : train_misclass            0.10000
2017-07-05 21:32:10,292 INFO : valid_misclass            0.50000
2017-07-05 21:32:10,293 INFO : test_misclass             0.26667
2017-07-05 21:32:10,294 INFO : runtime                   2.02426
2017-07-05 21:32:10,296 INFO :
2017-07-05 21:32:12,340 INFO : Epoch 21
2017-07-05 21:32:12,342 INFO : train_loss                0.18816
2017-07-05 21:32:12,344 INFO : valid_loss                0.46174
2017-07-05 21:32:12,345 INFO : test_loss                 0.66965
2017-07-05 21:32:12,347 INFO : train_sample_misclass     0.07406
2017-07-05 21:32:12,348 INFO : valid_sample_misclass     0.24643
2017-07-05 21:32:12,350 INFO : test_sample_misclass      0.28066
2017-07-05 21:32:12,351 INFO : train_misclass            0.05000
2017-07-05 21:32:12,353 INFO : valid_misclass            0.16667
2017-07-05 21:32:12,354 INFO : test_misclass             0.26667
2017-07-05 21:32:12,356 INFO : runtime                   2.13197
2017-07-05 21:32:12,357 INFO :
2017-07-05 21:32:14,114 INFO : Epoch 22
2017-07-05 21:32:14,116 INFO : train_loss                0.13663
2017-07-05 21:32:14,118 INFO : valid_loss                0.28806
2017-07-05 21:32:14,119 INFO : test_loss                 0.63335
2017-07-05 21:32:14,121 INFO : train_sample_misclass     0.02567
2017-07-05 21:32:14,122 INFO : valid_sample_misclass     0.06796
2017-07-05 21:32:14,124 INFO : test_sample_misclass      0.25677
2017-07-05 21:32:14,125 INFO : train_misclass            0.00000
2017-07-05 21:32:14,127 INFO : valid_misclass            0.00000
2017-07-05 21:32:14,128 INFO : test_misclass             0.23333
2017-07-05 21:32:14,130 INFO : runtime                   1.85825
2017-07-05 21:32:14,131 INFO :
2017-07-05 21:32:15,926 INFO : Epoch 23
2017-07-05 21:32:15,928 INFO : train_loss                0.18469
2017-07-05 21:32:15,930 INFO : valid_loss                0.33505
2017-07-05 21:32:15,931 INFO : test_loss                 0.74569
2017-07-05 21:32:15,933 INFO : train_sample_misclass     0.07469
2017-07-05 21:32:15,934 INFO : valid_sample_misclass     0.15575
2017-07-05 21:32:15,936 INFO : test_sample_misclass      0.29652
2017-07-05 21:32:15,937 INFO : train_misclass            0.05000
2017-07-05 21:32:15,939 INFO : valid_misclass            0.08333
2017-07-05 21:32:15,940 INFO : test_misclass             0.26667
2017-07-05 21:32:15,942 INFO : runtime                   1.79979
2017-07-05 21:32:15,943 INFO :
2017-07-05 21:32:17,737 INFO : Epoch 24
2017-07-05 21:32:17,739 INFO : train_loss                0.12348
2017-07-05 21:32:17,741 INFO : valid_loss                0.28360
2017-07-05 21:32:17,742 INFO : test_loss                 0.78044
2017-07-05 21:32:17,744 INFO : train_sample_misclass     0.03632
2017-07-05 21:32:17,745 INFO : valid_sample_misclass     0.10495
2017-07-05 21:32:17,746 INFO : test_sample_misclass      0.28529
2017-07-05 21:32:17,748 INFO : train_misclass            0.03333
2017-07-05 21:32:17,749 INFO : valid_misclass            0.08333
2017-07-05 21:32:17,751 INFO : test_misclass             0.26667
2017-07-05 21:32:17,752 INFO : runtime                   1.80127
2017-07-05 21:32:17,754 INFO :
2017-07-05 21:32:19,752 INFO : Epoch 25
2017-07-05 21:32:19,754 INFO : train_loss                0.14715
2017-07-05 21:32:19,755 INFO : valid_loss                0.19253
2017-07-05 21:32:19,757 INFO : test_loss                 0.77622
2017-07-05 21:32:19,758 INFO : train_sample_misclass     0.04635
2017-07-05 21:32:19,760 INFO : valid_sample_misclass     0.05660
2017-07-05 21:32:19,761 INFO : test_sample_misclass      0.26863
2017-07-05 21:32:19,763 INFO : train_misclass            0.05000
2017-07-05 21:32:19,764 INFO : valid_misclass            0.08333
2017-07-05 21:32:19,765 INFO : test_misclass             0.23333
2017-07-05 21:32:19,767 INFO : runtime                   1.98884
2017-07-05 21:32:19,768 INFO :
2017-07-05 21:32:21,591 INFO : Epoch 26
2017-07-05 21:32:21,593 INFO : train_loss                0.33871
2017-07-05 21:32:21,595 INFO : valid_loss                0.33738
2017-07-05 21:32:21,597 INFO : test_loss                 0.75611
2017-07-05 21:32:21,598 INFO : train_sample_misclass     0.16430
2017-07-05 21:32:21,600 INFO : valid_sample_misclass     0.16689
2017-07-05 21:32:21,601 INFO : test_sample_misclass      0.27763
2017-07-05 21:32:21,603 INFO : train_misclass            0.11667
2017-07-05 21:32:21,604 INFO : valid_misclass            0.16667
2017-07-05 21:32:21,606 INFO : test_misclass             0.26667
2017-07-05 21:32:21,607 INFO : runtime                   1.87949
2017-07-05 21:32:21,609 INFO :
2017-07-05 21:32:23,731 INFO : Epoch 27
2017-07-05 21:32:23,734 INFO : train_loss                0.12510
2017-07-05 21:32:23,735 INFO : valid_loss                0.14954
2017-07-05 21:32:23,736 INFO : test_loss                 0.60954
2017-07-05 21:32:23,738 INFO : train_sample_misclass     0.03111
2017-07-05 21:32:23,739 INFO : valid_sample_misclass     0.02718
2017-07-05 21:32:23,741 INFO : test_sample_misclass      0.23351
2017-07-05 21:32:23,742 INFO : train_misclass            0.01667
2017-07-05 21:32:23,744 INFO : valid_misclass            0.00000
2017-07-05 21:32:23,745 INFO : test_misclass             0.16667
2017-07-05 21:32:23,747 INFO : runtime                   2.06328
2017-07-05 21:32:23,748 INFO :
2017-07-05 21:32:25,989 INFO : Epoch 28
2017-07-05 21:32:25,991 INFO : train_loss                0.09142
2017-07-05 21:32:25,993 INFO : valid_loss                0.15033
2017-07-05 21:32:25,994 INFO : test_loss                 0.64889
2017-07-05 21:32:25,996 INFO : train_sample_misclass     0.01239
2017-07-05 21:32:25,997 INFO : valid_sample_misclass     0.03387
2017-07-05 21:32:25,999 INFO : test_sample_misclass      0.25856
2017-07-05 21:32:26,000 INFO : train_misclass            0.00000
2017-07-05 21:32:26,002 INFO : valid_misclass            0.00000
2017-07-05 21:32:26,003 INFO : test_misclass             0.26667
2017-07-05 21:32:26,005 INFO : runtime                   2.22640
2017-07-05 21:32:26,006 INFO :
2017-07-05 21:32:28,246 INFO : Epoch 29
2017-07-05 21:32:28,249 INFO : train_loss                0.12668
2017-07-05 21:32:28,250 INFO : valid_loss                0.21722
2017-07-05 21:32:28,252 INFO : test_loss                 0.74796
2017-07-05 21:32:28,253 INFO : train_sample_misclass     0.04274
2017-07-05 21:32:28,255 INFO : valid_sample_misclass     0.08623
2017-07-05 21:32:28,256 INFO : test_sample_misclass      0.26399
2017-07-05 21:32:28,258 INFO : train_misclass            0.03333
2017-07-05 21:32:28,259 INFO : valid_misclass            0.08333
2017-07-05 21:32:28,260 INFO : test_misclass             0.23333
2017-07-05 21:32:28,262 INFO : runtime                   2.30829
2017-07-05 21:32:28,263 INFO :
2017-07-05 21:32:30,742 INFO : Epoch 30
2017-07-05 21:32:30,744 INFO : train_loss                0.07407
2017-07-05 21:32:30,746 INFO : valid_loss                0.15270
2017-07-05 21:32:30,748 INFO : test_loss                 0.67133
2017-07-05 21:32:30,749 INFO : train_sample_misclass     0.01497
2017-07-05 21:32:30,750 INFO : valid_sample_misclass     0.06061
2017-07-05 21:32:30,752 INFO : test_sample_misclass      0.23975
2017-07-05 21:32:30,753 INFO : train_misclass            0.01667
2017-07-05 21:32:30,755 INFO : valid_misclass            0.08333
2017-07-05 21:32:30,756 INFO : test_misclass             0.20000
2017-07-05 21:32:30,758 INFO : runtime                   2.47182
2017-07-05 21:32:30,759 INFO :
2017-07-05 21:32:33,074 INFO : Epoch 31
2017-07-05 21:32:33,076 INFO : train_loss                0.05036
2017-07-05 21:32:33,078 INFO : valid_loss                0.09103
2017-07-05 21:32:33,079 INFO : test_loss                 0.66769
2017-07-05 21:32:33,081 INFO : train_sample_misclass     0.00744
2017-07-05 21:32:33,082 INFO : valid_sample_misclass     0.02317
2017-07-05 21:32:33,084 INFO : test_sample_misclass      0.20677
2017-07-05 21:32:33,085 INFO : train_misclass            0.00000
2017-07-05 21:32:33,087 INFO : valid_misclass            0.00000
2017-07-05 21:32:33,088 INFO : test_misclass             0.20000
2017-07-05 21:32:33,090 INFO : runtime                   2.37550
2017-07-05 21:32:33,091 INFO :
</pre></div></div>
</div>
<p>In this case, we arrive at 80.0% accuracy, the training stops after the
validation loss decreases below the training loss at the best epoch of
0.09315.</p>
</div>
<div class="section" id="Dataset-References">
<h2>Dataset References<a class="headerlink" href="#Dataset-References" title="Permalink to this headline">¶</a></h2>
<p>This dataset was created and contributed to PhysioNet by the developers
of the <a class="reference external" href="http://www.schalklab.org/research/bci2000">BCI2000</a>
instrumentation system, which they used in making these recordings. The
system is described in:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Schalk</span><span class="p">,</span> <span class="n">G</span><span class="o">.</span><span class="p">,</span> <span class="n">McFarland</span><span class="p">,</span> <span class="n">D</span><span class="o">.</span><span class="n">J</span><span class="o">.</span><span class="p">,</span> <span class="n">Hinterberger</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="p">,</span> <span class="n">Birbaumer</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="p">,</span> <span class="n">Wolpaw</span><span class="p">,</span> <span class="n">J</span><span class="o">.</span><span class="n">R</span><span class="o">.</span> <span class="p">(</span><span class="mi">2004</span><span class="p">)</span> <span class="n">BCI2000</span><span class="p">:</span> <span class="n">A</span> <span class="n">General</span><span class="o">-</span><span class="n">Purpose</span> <span class="n">Brain</span><span class="o">-</span><span class="n">Computer</span> <span class="n">Interface</span> <span class="p">(</span><span class="n">BCI</span><span class="p">)</span> <span class="n">System</span><span class="o">.</span> <span class="n">IEEE</span> <span class="n">TBME</span> <span class="mi">51</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span><span class="mi">1034</span><span class="o">-</span><span class="mf">1043.</span>
</pre></div>
</div>
<p><a class="reference external" href="https://physionet.org/physiobank/">PhysioBank</a> is a large and
growing archive of well-characterized digital recordings of physiologic
signals and related data for use by the biomedical research community
and further described in:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Goldberger</span> <span class="n">AL</span><span class="p">,</span> <span class="n">Amaral</span> <span class="n">LAN</span><span class="p">,</span> <span class="n">Glass</span> <span class="n">L</span><span class="p">,</span> <span class="n">Hausdorff</span> <span class="n">JM</span><span class="p">,</span> <span class="n">Ivanov</span> <span class="n">PCh</span><span class="p">,</span> <span class="n">Mark</span> <span class="n">RG</span><span class="p">,</span> <span class="n">Mietus</span> <span class="n">JE</span><span class="p">,</span> <span class="n">Moody</span> <span class="n">GB</span><span class="p">,</span> <span class="n">Peng</span> <span class="n">C</span><span class="o">-</span><span class="n">K</span><span class="p">,</span> <span class="n">Stanley</span> <span class="n">HE</span><span class="o">.</span> <span class="p">(</span><span class="mi">2000</span><span class="p">)</span> <span class="n">PhysioBank</span><span class="p">,</span> <span class="n">PhysioToolkit</span><span class="p">,</span> <span class="ow">and</span> <span class="n">PhysioNet</span><span class="p">:</span> <span class="n">Components</span> <span class="n">of</span> <span class="n">a</span> <span class="n">New</span> <span class="n">Research</span> <span class="n">Resource</span> <span class="k">for</span> <span class="n">Complex</span> <span class="n">Physiologic</span> <span class="n">Signals</span><span class="o">.</span> <span class="n">Circulation</span> <span class="mi">101</span><span class="p">(</span><span class="mi">23</span><span class="p">):</span><span class="n">e215</span><span class="o">-</span><span class="n">e220</span><span class="o">.</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../source/braindecode.datautil.html" class="btn btn-neutral float-right" title="braindecode.datautil package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Cropped_Decoding.html" class="btn btn-neutral" title="Cropped Decoding" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Robin Tibor Schirrmeister.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1.5',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>