

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using the Experiment Class &mdash; Braindecode 0.1.8 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Braindecode 0.1.8 documentation" href="../index.html"/>
        <link rel="next" title="Amplitude Perturbation Visualization" href="visualization/Perturbation.html"/>
        <link rel="prev" title="Cropped Decoding" href="Cropped_Decoding.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Braindecode
          

          
          </a>

          
            
            
              <div class="version">
                0.1.8
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="TrialWise_Decoding.html">Trialwise Decoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cropped_Decoding.html">Cropped Decoding</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using the Experiment Class</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Load-data">Load data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Convert-data-to-Braindecode-Format">Convert data to Braindecode Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Create-the-model">Create the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Setup-Experiment">Setup Experiment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Run-experiment">Run experiment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Dataset-References">Dataset References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="visualization/Perturbation.html">Amplitude Perturbation Visualization</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.datautil.html">braindecode.datautil package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.experiments.html">braindecode.experiments package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.mne_ext.html">braindecode.mne_ext package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.models.html">braindecode.models package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.torch_ext.html">braindecode.torch_ext package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.visualization.html">braindecode.visualization package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Braindecode</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Using the Experiment Class</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/Experiment_Class.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Using-the-Experiment-Class">
<h1>Using the Experiment Class<a class="headerlink" href="#Using-the-Experiment-Class" title="Permalink to this headline">Â¶</a></h1>
<p>Braindecode provides a convenience <code class="docutils literal"><span class="pre">Experiment</span></code> class, which removes
the necessity to write your own training loop. It expects a training, a
validation and a test set and trains as follows:</p>
<ol class="arabic simple">
<li>Train on training set until a given stop criterion is fulfilled</li>
<li>Reset to the best epoch, i.e. reset parameters of the model and the
optimizer to the state at the best epoch (âbestâ according to a given
criterion)</li>
<li>Continue training on the combined training + validation set until the
loss on the validation set is as low as it was on the best epoch for
the training set. (or until the ConvNet was trained twice as many
epochs as the best epoch to prevent infinite training)</li>
</ol>
<div class="admonition warning">
It is not necessary to use the Experiment class to use the remaning
functionality of Braindecode. Feel free to ignore it :)</div>
<div class="section" id="Load-data">
<h2>Load data<a class="headerlink" href="#Load-data" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">from</span> <span class="nn">mne.io</span> <span class="k">import</span> <span class="n">concatenate_raws</span>

<span class="c1"># 5,6,7,10,13,14 are codes for executed and imagined hands/feet</span>
<span class="n">subject_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">event_codes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">]</span>

<span class="c1"># This will download the files if you don&#39;t have them yet,</span>
<span class="c1"># and then return the paths to the files.</span>
<span class="n">physionet_paths</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">eegbci</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">subject_id</span><span class="p">,</span> <span class="n">event_codes</span><span class="p">)</span>

<span class="c1"># Load each of the files</span>
<span class="n">parts</span> <span class="o">=</span> <span class="p">[</span><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_edf</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="s1">&#39;WARNING&#39;</span><span class="p">)</span>
         <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">physionet_paths</span><span class="p">]</span>

<span class="c1"># Concatenate them</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">concatenate_raws</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span>

<span class="c1"># Find the events in this dataset</span>
<span class="n">events</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">find_events</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">shortest_event</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;STI 014&#39;</span><span class="p">)</span>

<span class="c1"># Use only EEG channels</span>
<span class="n">eeg_channel_inds</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">exclude</span><span class="o">=</span><span class="s1">&#39;bads&#39;</span><span class="p">)</span>

<span class="c1"># Extract trials, only using EEG channels</span>
<span class="n">epoched</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">hands</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">feet</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span> <span class="n">tmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">4.1</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">eeg_channel_inds</span><span class="p">,</span>
                <span class="n">baseline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Removing orphaned offset at the beginning of the file.
179 events found
Events id: [1 2 3]
90 matching events found
Loading data for 90 events and 497 original time points ...
0 bad epochs dropped
</pre></div></div>
</div>
</div>
<div class="section" id="Convert-data-to-Braindecode-Format">
<h2>Convert data to Braindecode Format<a class="headerlink" href="#Convert-data-to-Braindecode-Format" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">braindecode.datautil.signal_target</span> <span class="k">import</span> <span class="n">SignalAndTarget</span>
<span class="kn">from</span> <span class="nn">braindecode.datautil.splitters</span> <span class="k">import</span> <span class="n">split_into_two_sets</span>
<span class="c1"># Convert data from volt to millivolt</span>
<span class="c1"># Pytorch expects float32 for input and int64 for labels.</span>
<span class="n">X</span> <span class="o">=</span> <span class="p">(</span><span class="n">epoched</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">epoched</span><span class="o">.</span><span class="n">events</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span> <span class="c1">#2,3 -&gt; 0,1</span>

<span class="n">train_set</span> <span class="o">=</span> <span class="n">SignalAndTarget</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">60</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">[:</span><span class="mi">60</span><span class="p">])</span>
<span class="n">test_set</span> <span class="o">=</span> <span class="n">SignalAndTarget</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">60</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">60</span><span class="p">:])</span>

<span class="n">train_set</span><span class="p">,</span> <span class="n">valid_set</span> <span class="o">=</span> <span class="n">split_into_two_sets</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> <span class="n">first_set_fraction</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Create-the-model">
<h2>Create the model<a class="headerlink" href="#Create-the-model" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.models.shallow_fbcsp</span> <span class="k">import</span> <span class="n">ShallowFBCSPNet</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="k">import</span> <span class="n">nn</span>
<span class="kn">from</span> <span class="nn">braindecode.torch_ext.util</span> <span class="k">import</span> <span class="n">set_random_seeds</span>
<span class="kn">from</span> <span class="nn">braindecode.models.util</span> <span class="k">import</span> <span class="n">to_dense_prediction_model</span>

<span class="c1"># Set if you want to use GPU</span>
<span class="c1"># You can also use torch.cuda.is_available() to determine if cuda is available on your machine.</span>
<span class="n">cuda</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">set_random_seeds</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">20170629</span><span class="p">,</span> <span class="n">cuda</span><span class="o">=</span><span class="n">cuda</span><span class="p">)</span>

<span class="c1"># This will determine how many crops are processed in parallel</span>
<span class="n">input_time_length</span> <span class="o">=</span> <span class="mi">450</span>
<span class="n">n_classes</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">in_chans</span> <span class="o">=</span> <span class="n">train_set</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># final_conv_length determines the size of the receptive field of the ConvNet</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ShallowFBCSPNet</span><span class="p">(</span><span class="n">in_chans</span><span class="o">=</span><span class="n">in_chans</span><span class="p">,</span> <span class="n">n_classes</span><span class="o">=</span><span class="n">n_classes</span><span class="p">,</span> <span class="n">input_time_length</span><span class="o">=</span><span class="n">input_time_length</span><span class="p">,</span>
                        <span class="n">final_conv_length</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">create_network</span><span class="p">()</span>
<span class="n">to_dense_prediction_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="k">if</span> <span class="n">cuda</span><span class="p">:</span>
    <span class="n">model</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">torch</span> <span class="k">import</span> <span class="n">optim</span>

<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.torch_ext.util</span> <span class="k">import</span> <span class="n">np_to_var</span>
<span class="c1"># determine output size</span>
<span class="n">test_input</span> <span class="o">=</span> <span class="n">np_to_var</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">in_chans</span><span class="p">,</span> <span class="n">input_time_length</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="k">if</span> <span class="n">cuda</span><span class="p">:</span>
    <span class="n">test_input</span> <span class="o">=</span> <span class="n">test_input</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">test_input</span><span class="p">)</span>
<span class="n">n_preds_per_input</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:d}</span><span class="s2"> predictions per input/trial&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n_preds_per_input</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
187 predictions per input/trial
</pre></div></div>
</div>
</div>
<div class="section" id="Setup-Experiment">
<h2>Setup Experiment<a class="headerlink" href="#Setup-Experiment" title="Permalink to this headline">Â¶</a></h2>
<p>Now we need to setup everything for the experiment: Iterator, loss
function, monitors and stop criterion.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.experiments.experiment</span> <span class="k">import</span> <span class="n">Experiment</span>
<span class="kn">from</span> <span class="nn">braindecode.datautil.iterators</span> <span class="k">import</span> <span class="n">CropsFromTrialsIterator</span>
<span class="kn">from</span> <span class="nn">braindecode.experiments.monitors</span> <span class="k">import</span> <span class="n">RuntimeMonitor</span><span class="p">,</span> <span class="n">LossMonitor</span><span class="p">,</span> <span class="n">CroppedTrialMisclassMonitor</span><span class="p">,</span> <span class="n">MisclassMonitor</span>
<span class="kn">from</span> <span class="nn">braindecode.experiments.stopcriteria</span> <span class="k">import</span> <span class="n">MaxEpochs</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">torch</span> <span class="k">as</span> <span class="nn">th</span>
<span class="kn">from</span> <span class="nn">braindecode.torch_ext.modules</span> <span class="k">import</span> <span class="n">Expression</span>
<span class="c1"># Iterator is used to iterate over datasets both for training</span>
<span class="c1"># and evaluation</span>
<span class="n">iterator</span> <span class="o">=</span> <span class="n">CropsFromTrialsIterator</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span><span class="n">input_time_length</span><span class="o">=</span><span class="n">input_time_length</span><span class="p">,</span>
                                  <span class="n">n_preds_per_input</span><span class="o">=</span><span class="n">n_preds_per_input</span><span class="p">)</span>

<span class="c1"># Loss function takes predictions as they come out of the network and the targets</span>
<span class="c1"># and returns a loss</span>
<span class="n">loss_function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">preds</span><span class="p">,</span> <span class="n">targets</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">targets</span><span class="p">)</span>

<span class="c1"># Could be used to apply some constraint on the models, then should be object</span>
<span class="c1"># with apply method that accepts a module</span>
<span class="n">model_constraint</span> <span class="o">=</span> <span class="kc">None</span>
<span class="c1"># Monitors log the training progress</span>
<span class="n">monitors</span> <span class="o">=</span> <span class="p">[</span><span class="n">LossMonitor</span><span class="p">(),</span> <span class="n">MisclassMonitor</span><span class="p">(</span><span class="n">col_suffix</span><span class="o">=</span><span class="s1">&#39;sample_misclass&#39;</span><span class="p">),</span>
            <span class="n">CroppedTrialMisclassMonitor</span><span class="p">(</span><span class="n">input_time_length</span><span class="p">),</span> <span class="n">RuntimeMonitor</span><span class="p">(),]</span>
<span class="c1"># Stop criterion determines when the first stop happens</span>
<span class="n">stop_criterion</span> <span class="o">=</span> <span class="n">MaxEpochs</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">Experiment</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train_set</span><span class="p">,</span> <span class="n">valid_set</span><span class="p">,</span> <span class="n">test_set</span><span class="p">,</span> <span class="n">iterator</span><span class="p">,</span> <span class="n">loss_function</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">model_constraint</span><span class="p">,</span>
          <span class="n">monitors</span><span class="p">,</span> <span class="n">stop_criterion</span><span class="p">,</span> <span class="n">remember_best_column</span><span class="o">=</span><span class="s1">&#39;valid_misclass&#39;</span><span class="p">,</span>
          <span class="n">run_after_early_stop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">batch_modifier</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cuda</span><span class="o">=</span><span class="n">cuda</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Run-experiment">
<h2>Run experiment<a class="headerlink" href="#Run-experiment" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># need to setup python logging before to be able to see anything</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> </span><span class="si">%(levelname)s</span><span class="s1"> : </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
                     <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
<span class="n">exp</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2017-09-04 17:22:05,656 INFO : Run until first stop...
2017-09-04 17:22:06,578 INFO : Epoch 0
2017-09-04 17:22:06,581 INFO : train_loss                0.86930
2017-09-04 17:22:06,583 INFO : valid_loss                0.74838
2017-09-04 17:22:06,585 INFO : test_loss                 0.69756
2017-09-04 17:22:06,588 INFO : train_sample_misclass     0.53894
2017-09-04 17:22:06,590 INFO : valid_sample_misclass     0.47103
2017-09-04 17:22:06,592 INFO : test_sample_misclass      0.44251
2017-09-04 17:22:06,594 INFO : train_misclass            0.60417
2017-09-04 17:22:06,597 INFO : valid_misclass            0.50000
2017-09-04 17:22:06,599 INFO : test_misclass             0.40000
2017-09-04 17:22:06,601 INFO : runtime                   0.00000
2017-09-04 17:22:06,604 INFO :
2017-09-04 17:22:06,605 INFO : New best valid_misclass: 0.500000
2017-09-04 17:22:06,607 INFO :
2017-09-04 17:22:08,272 INFO : Time only for training updates: 1.66s
2017-09-04 17:22:09,160 INFO : Epoch 1
2017-09-04 17:22:09,163 INFO : train_loss                2.33626
2017-09-04 17:22:09,165 INFO : valid_loss                2.31771
2017-09-04 17:22:09,167 INFO : test_loss                 2.14077
2017-09-04 17:22:09,170 INFO : train_sample_misclass     0.48279
2017-09-04 17:22:09,172 INFO : valid_sample_misclass     0.50000
2017-09-04 17:22:09,174 INFO : test_sample_misclass      0.46667
2017-09-04 17:22:09,176 INFO : train_misclass            0.50000
2017-09-04 17:22:09,179 INFO : valid_misclass            0.50000
2017-09-04 17:22:09,181 INFO : test_misclass             0.46667
2017-09-04 17:22:09,183 INFO : runtime                   2.61826
2017-09-04 17:22:09,186 INFO :
2017-09-04 17:22:09,187 INFO : New best valid_misclass: 0.500000
2017-09-04 17:22:09,190 INFO :
2017-09-04 17:22:10,530 INFO : Time only for training updates: 1.33s
2017-09-04 17:22:11,518 INFO : Epoch 2
2017-09-04 17:22:11,525 INFO : train_loss                0.59815
2017-09-04 17:22:11,526 INFO : valid_loss                0.78503
2017-09-04 17:22:11,527 INFO : test_loss                 0.70060
2017-09-04 17:22:11,528 INFO : train_sample_misclass     0.33918
2017-09-04 17:22:11,529 INFO : valid_sample_misclass     0.47995
2017-09-04 17:22:11,530 INFO : test_sample_misclass      0.41996
2017-09-04 17:22:11,531 INFO : train_misclass            0.22917
2017-09-04 17:22:11,532 INFO : valid_misclass            0.41667
2017-09-04 17:22:11,533 INFO : test_misclass             0.43333
2017-09-04 17:22:11,534 INFO : runtime                   2.25772
2017-09-04 17:22:11,535 INFO :
2017-09-04 17:22:11,537 INFO : New best valid_misclass: 0.416667
2017-09-04 17:22:11,539 INFO :
2017-09-04 17:22:13,335 INFO : Time only for training updates: 1.78s
2017-09-04 17:22:14,262 INFO : Epoch 3
2017-09-04 17:22:14,266 INFO : train_loss                0.53122
2017-09-04 17:22:14,268 INFO : valid_loss                0.87284
2017-09-04 17:22:14,270 INFO : test_loss                 0.69774
2017-09-04 17:22:14,272 INFO : train_sample_misclass     0.24588
2017-09-04 17:22:14,275 INFO : valid_sample_misclass     0.55548
2017-09-04 17:22:14,277 INFO : test_sample_misclass      0.42709
2017-09-04 17:22:14,279 INFO : train_misclass            0.22917
2017-09-04 17:22:14,281 INFO : valid_misclass            0.50000
2017-09-04 17:22:14,283 INFO : test_misclass             0.36667
2017-09-04 17:22:14,286 INFO : runtime                   2.80540
2017-09-04 17:22:14,288 INFO :
2017-09-04 17:22:15,854 INFO : Time only for training updates: 1.56s
2017-09-04 17:22:16,758 INFO : Epoch 4
2017-09-04 17:22:16,761 INFO : train_loss                0.51574
2017-09-04 17:22:16,764 INFO : valid_loss                1.10377
2017-09-04 17:22:16,766 INFO : test_loss                 0.80095
2017-09-04 17:22:16,768 INFO : train_sample_misclass     0.25869
2017-09-04 17:22:16,770 INFO : valid_sample_misclass     0.60094
2017-09-04 17:22:16,773 INFO : test_sample_misclass      0.42727
2017-09-04 17:22:16,775 INFO : train_misclass            0.27083
2017-09-04 17:22:16,777 INFO : valid_misclass            0.58333
2017-09-04 17:22:16,779 INFO : test_misclass             0.46667
2017-09-04 17:22:16,781 INFO : runtime                   2.51832
2017-09-04 17:22:16,784 INFO :
2017-09-04 17:22:18,497 INFO : Time only for training updates: 1.70s
2017-09-04 17:22:19,489 INFO : Epoch 5
2017-09-04 17:22:19,491 INFO : train_loss                0.52613
2017-09-04 17:22:19,492 INFO : valid_loss                1.22322
2017-09-04 17:22:19,492 INFO : test_loss                 0.86285
2017-09-04 17:22:19,493 INFO : train_sample_misclass     0.27635
2017-09-04 17:22:19,494 INFO : valid_sample_misclass     0.58445
2017-09-04 17:22:19,495 INFO : test_sample_misclass      0.43841
2017-09-04 17:22:19,495 INFO : train_misclass            0.33333
2017-09-04 17:22:19,496 INFO : valid_misclass            0.58333
2017-09-04 17:22:19,497 INFO : test_misclass             0.46667
2017-09-04 17:22:19,497 INFO : runtime                   2.64486
2017-09-04 17:22:19,498 INFO :
2017-09-04 17:22:21,486 INFO : Time only for training updates: 1.98s
2017-09-04 17:22:22,394 INFO : Epoch 6
2017-09-04 17:22:22,395 INFO : train_loss                0.54906
2017-09-04 17:22:22,396 INFO : valid_loss                1.23573
2017-09-04 17:22:22,397 INFO : test_loss                 0.92210
2017-09-04 17:22:22,398 INFO : train_sample_misclass     0.28816
2017-09-04 17:22:22,399 INFO : valid_sample_misclass     0.53810
2017-09-04 17:22:22,399 INFO : test_sample_misclass      0.45205
2017-09-04 17:22:22,400 INFO : train_misclass            0.33333
2017-09-04 17:22:22,401 INFO : valid_misclass            0.58333
2017-09-04 17:22:22,402 INFO : test_misclass             0.46667
2017-09-04 17:22:22,403 INFO : runtime                   2.98571
2017-09-04 17:22:22,404 INFO :
2017-09-04 17:22:23,994 INFO : Time only for training updates: 1.58s
2017-09-04 17:22:24,873 INFO : Epoch 7
2017-09-04 17:22:24,877 INFO : train_loss                0.59627
2017-09-04 17:22:24,879 INFO : valid_loss                1.16602
2017-09-04 17:22:24,881 INFO : test_loss                 0.95655
2017-09-04 17:22:24,884 INFO : train_sample_misclass     0.32253
2017-09-04 17:22:24,886 INFO : valid_sample_misclass     0.53053
2017-09-04 17:22:24,888 INFO : test_sample_misclass      0.46346
2017-09-04 17:22:24,890 INFO : train_misclass            0.37500
2017-09-04 17:22:24,893 INFO : valid_misclass            0.58333
2017-09-04 17:22:24,895 INFO : test_misclass             0.46667
2017-09-04 17:22:24,897 INFO : runtime                   2.50811
2017-09-04 17:22:24,899 INFO :
2017-09-04 17:22:26,537 INFO : Time only for training updates: 1.63s
2017-09-04 17:22:27,515 INFO : Epoch 8
2017-09-04 17:22:27,517 INFO : train_loss                0.40527
2017-09-04 17:22:27,518 INFO : valid_loss                0.95821
2017-09-04 17:22:27,518 INFO : test_loss                 0.79267
2017-09-04 17:22:27,519 INFO : train_sample_misclass     0.19112
2017-09-04 17:22:27,520 INFO : valid_sample_misclass     0.52607
2017-09-04 17:22:27,521 INFO : test_sample_misclass      0.43351
2017-09-04 17:22:27,521 INFO : train_misclass            0.16667
2017-09-04 17:22:27,522 INFO : valid_misclass            0.58333
2017-09-04 17:22:27,523 INFO : test_misclass             0.40000
2017-09-04 17:22:27,523 INFO : runtime                   2.54855
2017-09-04 17:22:27,524 INFO :
2017-09-04 17:22:29,047 INFO : Time only for training updates: 1.51s
2017-09-04 17:22:29,938 INFO : Epoch 9
2017-09-04 17:22:29,946 INFO : train_loss                0.30290
2017-09-04 17:22:29,949 INFO : valid_loss                0.89596
2017-09-04 17:22:29,951 INFO : test_loss                 0.75205
2017-09-04 17:22:29,954 INFO : train_sample_misclass     0.10968
2017-09-04 17:22:29,956 INFO : valid_sample_misclass     0.56684
2017-09-04 17:22:29,959 INFO : test_sample_misclass      0.43119
2017-09-04 17:22:29,961 INFO : train_misclass            0.08333
2017-09-04 17:22:29,964 INFO : valid_misclass            0.58333
2017-09-04 17:22:29,966 INFO : test_misclass             0.36667
2017-09-04 17:22:29,969 INFO : runtime                   2.50595
2017-09-04 17:22:29,971 INFO :
2017-09-04 17:22:31,466 INFO : Time only for training updates: 1.48s
2017-09-04 17:22:32,449 INFO : Epoch 10
2017-09-04 17:22:32,451 INFO : train_loss                0.25623
2017-09-04 17:22:32,451 INFO : valid_loss                0.89555
2017-09-04 17:22:32,452 INFO : test_loss                 0.75208
2017-09-04 17:22:32,453 INFO : train_sample_misclass     0.06088
2017-09-04 17:22:32,454 INFO : valid_sample_misclass     0.55637
2017-09-04 17:22:32,455 INFO : test_sample_misclass      0.41765
2017-09-04 17:22:32,455 INFO : train_misclass            0.02083
2017-09-04 17:22:32,456 INFO : valid_misclass            0.58333
2017-09-04 17:22:32,457 INFO : test_misclass             0.33333
2017-09-04 17:22:32,458 INFO : runtime                   2.41746
2017-09-04 17:22:32,459 INFO :
2017-09-04 17:22:34,045 INFO : Time only for training updates: 1.58s
2017-09-04 17:22:34,974 INFO : Epoch 11
2017-09-04 17:22:34,977 INFO : train_loss                0.24021
2017-09-04 17:22:34,980 INFO : valid_loss                0.90581
2017-09-04 17:22:34,982 INFO : test_loss                 0.75648
2017-09-04 17:22:34,984 INFO : train_sample_misclass     0.06205
2017-09-04 17:22:34,986 INFO : valid_sample_misclass     0.54256
2017-09-04 17:22:34,988 INFO : test_sample_misclass      0.39804
2017-09-04 17:22:34,991 INFO : train_misclass            0.02083
2017-09-04 17:22:34,993 INFO : valid_misclass            0.58333
2017-09-04 17:22:34,995 INFO : test_misclass             0.33333
2017-09-04 17:22:34,997 INFO : runtime                   2.57857
2017-09-04 17:22:34,999 INFO :
2017-09-04 17:22:36,386 INFO : Time only for training updates: 1.38s
2017-09-04 17:22:37,282 INFO : Epoch 12
2017-09-04 17:22:37,285 INFO : train_loss                0.20491
2017-09-04 17:22:37,287 INFO : valid_loss                0.90257
2017-09-04 17:22:37,290 INFO : test_loss                 0.75600
2017-09-04 17:22:37,292 INFO : train_sample_misclass     0.05041
2017-09-04 17:22:37,294 INFO : valid_sample_misclass     0.54055
2017-09-04 17:22:37,296 INFO : test_sample_misclass      0.39501
2017-09-04 17:22:37,299 INFO : train_misclass            0.00000
2017-09-04 17:22:37,301 INFO : valid_misclass            0.58333
2017-09-04 17:22:37,303 INFO : test_misclass             0.33333
2017-09-04 17:22:37,305 INFO : runtime                   2.34322
2017-09-04 17:22:37,308 INFO :
2017-09-04 17:22:38,822 INFO : Time only for training updates: 1.50s
2017-09-04 17:22:39,740 INFO : Epoch 13
2017-09-04 17:22:39,743 INFO : train_loss                0.17244
2017-09-04 17:22:39,745 INFO : valid_loss                0.90562
2017-09-04 17:22:39,748 INFO : test_loss                 0.76539
2017-09-04 17:22:39,750 INFO : train_sample_misclass     0.03793
2017-09-04 17:22:39,752 INFO : valid_sample_misclass     0.56194
2017-09-04 17:22:39,755 INFO : test_sample_misclass      0.38752
2017-09-04 17:22:39,757 INFO : train_misclass            0.00000
2017-09-04 17:22:39,759 INFO : valid_misclass            0.66667
2017-09-04 17:22:39,761 INFO : test_misclass             0.36667
2017-09-04 17:22:39,764 INFO : runtime                   2.43360
2017-09-04 17:22:39,766 INFO :
2017-09-04 17:22:41,482 INFO : Time only for training updates: 1.71s
2017-09-04 17:22:42,480 INFO : Epoch 14
2017-09-04 17:22:42,482 INFO : train_loss                0.15207
2017-09-04 17:22:42,483 INFO : valid_loss                0.90600
2017-09-04 17:22:42,483 INFO : test_loss                 0.76428
2017-09-04 17:22:42,484 INFO : train_sample_misclass     0.02969
2017-09-04 17:22:42,485 INFO : valid_sample_misclass     0.54924
2017-09-04 17:22:42,485 INFO : test_sample_misclass      0.36551
2017-09-04 17:22:42,486 INFO : train_misclass            0.00000
2017-09-04 17:22:42,487 INFO : valid_misclass            0.58333
2017-09-04 17:22:42,487 INFO : test_misclass             0.36667
2017-09-04 17:22:42,488 INFO : runtime                   2.66681
2017-09-04 17:22:42,489 INFO :
2017-09-04 17:22:44,108 INFO : Time only for training updates: 1.61s
2017-09-04 17:22:45,078 INFO : Epoch 15
2017-09-04 17:22:45,086 INFO : train_loss                0.14998
2017-09-04 17:22:45,087 INFO : valid_loss                0.96410
2017-09-04 17:22:45,088 INFO : test_loss                 0.81256
2017-09-04 17:22:45,089 INFO : train_sample_misclass     0.04027
2017-09-04 17:22:45,090 INFO : valid_sample_misclass     0.48061
2017-09-04 17:22:45,091 INFO : test_sample_misclass      0.35811
2017-09-04 17:22:45,092 INFO : train_misclass            0.02083
2017-09-04 17:22:45,093 INFO : valid_misclass            0.50000
2017-09-04 17:22:45,094 INFO : test_misclass             0.33333
2017-09-04 17:22:45,095 INFO : runtime                   2.62210
2017-09-04 17:22:45,096 INFO :
2017-09-04 17:22:46,828 INFO : Time only for training updates: 1.72s
2017-09-04 17:22:47,772 INFO : Epoch 16
2017-09-04 17:22:47,776 INFO : train_loss                0.10915
2017-09-04 17:22:47,778 INFO : valid_loss                0.91489
2017-09-04 17:22:47,780 INFO : test_loss                 0.80608
2017-09-04 17:22:47,782 INFO : train_sample_misclass     0.01588
2017-09-04 17:22:47,784 INFO : valid_sample_misclass     0.54234
2017-09-04 17:22:47,787 INFO : test_sample_misclass      0.34537
2017-09-04 17:22:47,789 INFO : train_misclass            0.00000
2017-09-04 17:22:47,791 INFO : valid_misclass            0.33333
2017-09-04 17:22:47,793 INFO : test_misclass             0.33333
2017-09-04 17:22:47,796 INFO : runtime                   2.71886
2017-09-04 17:22:47,798 INFO :
2017-09-04 17:22:47,800 INFO : New best valid_misclass: 0.333333
2017-09-04 17:22:47,802 INFO :
2017-09-04 17:22:49,144 INFO : Time only for training updates: 1.33s
2017-09-04 17:22:50,049 INFO : Epoch 17
2017-09-04 17:22:50,052 INFO : train_loss                0.15003
2017-09-04 17:22:50,054 INFO : valid_loss                0.91323
2017-09-04 17:22:50,057 INFO : test_loss                 0.81002
2017-09-04 17:22:50,060 INFO : train_sample_misclass     0.05403
2017-09-04 17:22:50,062 INFO : valid_sample_misclass     0.51337
2017-09-04 17:22:50,064 INFO : test_sample_misclass      0.34403
2017-09-04 17:22:50,066 INFO : train_misclass            0.04167
2017-09-04 17:22:50,069 INFO : valid_misclass            0.50000
2017-09-04 17:22:50,071 INFO : test_misclass             0.23333
2017-09-04 17:22:50,073 INFO : runtime                   2.31651
2017-09-04 17:22:50,075 INFO :
2017-09-04 17:22:51,381 INFO : Time only for training updates: 1.30s
2017-09-04 17:22:52,371 INFO : Epoch 18
2017-09-04 17:22:52,377 INFO : train_loss                0.09315
2017-09-04 17:22:52,379 INFO : valid_loss                0.89064
2017-09-04 17:22:52,380 INFO : test_loss                 0.77360
2017-09-04 17:22:52,381 INFO : train_sample_misclass     0.01025
2017-09-04 17:22:52,382 INFO : valid_sample_misclass     0.49666
2017-09-04 17:22:52,382 INFO : test_sample_misclass      0.30873
2017-09-04 17:22:52,383 INFO : train_misclass            0.00000
2017-09-04 17:22:52,384 INFO : valid_misclass            0.33333
2017-09-04 17:22:52,385 INFO : test_misclass             0.33333
2017-09-04 17:22:52,386 INFO : runtime                   2.23636
2017-09-04 17:22:52,387 INFO :
2017-09-04 17:22:52,389 INFO : New best valid_misclass: 0.333333
2017-09-04 17:22:52,391 INFO :
2017-09-04 17:22:54,084 INFO : Time only for training updates: 1.68s
2017-09-04 17:22:55,054 INFO : Epoch 19
2017-09-04 17:22:55,056 INFO : train_loss                0.09407
2017-09-04 17:22:55,056 INFO : valid_loss                0.96349
2017-09-04 17:22:55,057 INFO : test_loss                 0.84831
2017-09-04 17:22:55,058 INFO : train_sample_misclass     0.02078
2017-09-04 17:22:55,059 INFO : valid_sample_misclass     0.49042
2017-09-04 17:22:55,059 INFO : test_sample_misclass      0.33137
2017-09-04 17:22:55,060 INFO : train_misclass            0.00000
2017-09-04 17:22:55,061 INFO : valid_misclass            0.50000
2017-09-04 17:22:55,061 INFO : test_misclass             0.30000
2017-09-04 17:22:55,062 INFO : runtime                   2.70544
2017-09-04 17:22:55,063 INFO :
2017-09-04 17:22:56,888 INFO : Time only for training updates: 1.82s
2017-09-04 17:22:57,767 INFO : Epoch 20
2017-09-04 17:22:57,769 INFO : train_loss                0.06822
2017-09-04 17:22:57,769 INFO : valid_loss                1.05598
2017-09-04 17:22:57,770 INFO : test_loss                 0.88760
2017-09-04 17:22:57,771 INFO : train_sample_misclass     0.00847
2017-09-04 17:22:57,772 INFO : valid_sample_misclass     0.51448
2017-09-04 17:22:57,772 INFO : test_sample_misclass      0.33066
2017-09-04 17:22:57,773 INFO : train_misclass            0.00000
2017-09-04 17:22:57,774 INFO : valid_misclass            0.50000
2017-09-04 17:22:57,774 INFO : test_misclass             0.36667
2017-09-04 17:22:57,775 INFO : runtime                   2.80020
2017-09-04 17:22:57,776 INFO :
2017-09-04 17:22:57,777 INFO : Setup for second stop...
2017-09-04 17:22:57,780 INFO : Train loss to reach 0.09315
2017-09-04 17:22:57,781 INFO : Run until second stop...
2017-09-04 17:22:58,777 INFO : Epoch 19
2017-09-04 17:22:58,781 INFO : train_loss                0.25265
2017-09-04 17:22:58,782 INFO : valid_loss                0.89064
2017-09-04 17:22:58,783 INFO : test_loss                 0.77360
2017-09-04 17:22:58,784 INFO : train_sample_misclass     0.10753
2017-09-04 17:22:58,785 INFO : valid_sample_misclass     0.49666
2017-09-04 17:22:58,786 INFO : test_sample_misclass      0.30873
2017-09-04 17:22:58,787 INFO : train_misclass            0.06667
2017-09-04 17:22:58,788 INFO : valid_misclass            0.33333
2017-09-04 17:22:58,789 INFO : test_misclass             0.33333
2017-09-04 17:22:58,790 INFO : runtime                   0.89386
2017-09-04 17:22:58,792 INFO :
2017-09-04 17:23:00,869 INFO : Time only for training updates: 2.06s
2017-09-04 17:23:01,868 INFO : Epoch 20
2017-09-04 17:23:01,871 INFO : train_loss                0.21080
2017-09-04 17:23:01,873 INFO : valid_loss                0.68103
2017-09-04 17:23:01,875 INFO : test_loss                 0.73508
2017-09-04 17:23:01,877 INFO : train_sample_misclass     0.08324
2017-09-04 17:23:01,879 INFO : valid_sample_misclass     0.34915
2017-09-04 17:23:01,882 INFO : test_sample_misclass      0.31025
2017-09-04 17:23:01,884 INFO : train_misclass            0.10000
2017-09-04 17:23:01,886 INFO : valid_misclass            0.50000
2017-09-04 17:23:01,888 INFO : test_misclass             0.26667
2017-09-04 17:23:01,890 INFO : runtime                   3.08739
2017-09-04 17:23:01,893 INFO :
2017-09-04 17:23:03,871 INFO : Time only for training updates: 1.97s
2017-09-04 17:23:04,949 INFO : Epoch 21
2017-09-04 17:23:04,952 INFO : train_loss                0.18816
2017-09-04 17:23:04,954 INFO : valid_loss                0.46174
2017-09-04 17:23:04,956 INFO : test_loss                 0.66965
2017-09-04 17:23:04,958 INFO : train_sample_misclass     0.07406
2017-09-04 17:23:04,961 INFO : valid_sample_misclass     0.24643
2017-09-04 17:23:04,963 INFO : test_sample_misclass      0.28066
2017-09-04 17:23:04,965 INFO : train_misclass            0.05000
2017-09-04 17:23:04,967 INFO : valid_misclass            0.16667
2017-09-04 17:23:04,970 INFO : test_misclass             0.26667
2017-09-04 17:23:04,972 INFO : runtime                   3.00350
2017-09-04 17:23:04,974 INFO :
2017-09-04 17:23:06,900 INFO : Time only for training updates: 1.92s
2017-09-04 17:23:07,891 INFO : Epoch 22
2017-09-04 17:23:07,893 INFO : train_loss                0.13663
2017-09-04 17:23:07,893 INFO : valid_loss                0.28807
2017-09-04 17:23:07,894 INFO : test_loss                 0.63335
2017-09-04 17:23:07,895 INFO : train_sample_misclass     0.02567
2017-09-04 17:23:07,896 INFO : valid_sample_misclass     0.06796
2017-09-04 17:23:07,896 INFO : test_sample_misclass      0.25677
2017-09-04 17:23:07,897 INFO : train_misclass            0.00000
2017-09-04 17:23:07,898 INFO : valid_misclass            0.00000
2017-09-04 17:23:07,898 INFO : test_misclass             0.23333
2017-09-04 17:23:07,899 INFO : runtime                   3.03257
2017-09-04 17:23:07,900 INFO :
2017-09-04 17:23:09,799 INFO : Time only for training updates: 1.89s
2017-09-04 17:23:10,795 INFO : Epoch 23
2017-09-04 17:23:10,798 INFO : train_loss                0.18469
2017-09-04 17:23:10,800 INFO : valid_loss                0.33505
2017-09-04 17:23:10,803 INFO : test_loss                 0.74569
2017-09-04 17:23:10,805 INFO : train_sample_misclass     0.07469
2017-09-04 17:23:10,807 INFO : valid_sample_misclass     0.15575
2017-09-04 17:23:10,809 INFO : test_sample_misclass      0.29652
2017-09-04 17:23:10,812 INFO : train_misclass            0.05000
2017-09-04 17:23:10,814 INFO : valid_misclass            0.08333
2017-09-04 17:23:10,816 INFO : test_misclass             0.26667
2017-09-04 17:23:10,819 INFO : runtime                   2.89889
2017-09-04 17:23:10,821 INFO :
2017-09-04 17:23:12,616 INFO : Time only for training updates: 1.78s
2017-09-04 17:23:13,620 INFO : Epoch 24
2017-09-04 17:23:13,623 INFO : train_loss                0.12348
2017-09-04 17:23:13,625 INFO : valid_loss                0.28361
2017-09-04 17:23:13,627 INFO : test_loss                 0.78044
2017-09-04 17:23:13,630 INFO : train_sample_misclass     0.03632
2017-09-04 17:23:13,632 INFO : valid_sample_misclass     0.10495
2017-09-04 17:23:13,634 INFO : test_sample_misclass      0.28529
2017-09-04 17:23:13,636 INFO : train_misclass            0.03333
2017-09-04 17:23:13,639 INFO : valid_misclass            0.08333
2017-09-04 17:23:13,641 INFO : test_misclass             0.26667
2017-09-04 17:23:13,643 INFO : runtime                   2.81371
2017-09-04 17:23:13,645 INFO :
2017-09-04 17:23:15,774 INFO : Time only for training updates: 2.12s
2017-09-04 17:23:16,820 INFO : Epoch 25
2017-09-04 17:23:16,821 INFO : train_loss                0.14714
2017-09-04 17:23:16,822 INFO : valid_loss                0.19252
2017-09-04 17:23:16,822 INFO : test_loss                 0.77621
2017-09-04 17:23:16,823 INFO : train_sample_misclass     0.04635
2017-09-04 17:23:16,824 INFO : valid_sample_misclass     0.05660
2017-09-04 17:23:16,825 INFO : test_sample_misclass      0.26863
2017-09-04 17:23:16,825 INFO : train_misclass            0.05000
2017-09-04 17:23:16,826 INFO : valid_misclass            0.08333
2017-09-04 17:23:16,827 INFO : test_misclass             0.23333
2017-09-04 17:23:16,827 INFO : runtime                   3.15883
2017-09-04 17:23:16,828 INFO :
2017-09-04 17:23:18,975 INFO : Time only for training updates: 2.14s
2017-09-04 17:23:19,993 INFO : Epoch 26
2017-09-04 17:23:19,996 INFO : train_loss                0.33871
2017-09-04 17:23:19,998 INFO : valid_loss                0.33737
2017-09-04 17:23:20,001 INFO : test_loss                 0.75610
2017-09-04 17:23:20,003 INFO : train_sample_misclass     0.16430
2017-09-04 17:23:20,005 INFO : valid_sample_misclass     0.16689
2017-09-04 17:23:20,007 INFO : test_sample_misclass      0.27763
2017-09-04 17:23:20,009 INFO : train_misclass            0.11667
2017-09-04 17:23:20,012 INFO : valid_misclass            0.16667
2017-09-04 17:23:20,014 INFO : test_misclass             0.26667
2017-09-04 17:23:20,016 INFO : runtime                   3.20353
2017-09-04 17:23:20,018 INFO :
2017-09-04 17:23:21,741 INFO : Time only for training updates: 1.71s
2017-09-04 17:23:22,811 INFO : Epoch 27
2017-09-04 17:23:22,814 INFO : train_loss                0.12509
2017-09-04 17:23:22,816 INFO : valid_loss                0.14953
2017-09-04 17:23:22,818 INFO : test_loss                 0.60954
2017-09-04 17:23:22,821 INFO : train_sample_misclass     0.03111
2017-09-04 17:23:22,823 INFO : valid_sample_misclass     0.02718
2017-09-04 17:23:22,825 INFO : test_sample_misclass      0.23351
2017-09-04 17:23:22,827 INFO : train_misclass            0.01667
2017-09-04 17:23:22,830 INFO : valid_misclass            0.00000
2017-09-04 17:23:22,832 INFO : test_misclass             0.16667
2017-09-04 17:23:22,834 INFO : runtime                   2.76109
2017-09-04 17:23:22,836 INFO :
2017-09-04 17:23:24,719 INFO : Time only for training updates: 1.87s
2017-09-04 17:23:25,706 INFO : Epoch 28
2017-09-04 17:23:25,709 INFO : train_loss                0.09141
2017-09-04 17:23:25,711 INFO : valid_loss                0.15032
2017-09-04 17:23:25,714 INFO : test_loss                 0.64890
2017-09-04 17:23:25,716 INFO : train_sample_misclass     0.01239
2017-09-04 17:23:25,718 INFO : valid_sample_misclass     0.03387
2017-09-04 17:23:25,720 INFO : test_sample_misclass      0.25856
2017-09-04 17:23:25,723 INFO : train_misclass            0.00000
2017-09-04 17:23:25,725 INFO : valid_misclass            0.00000
2017-09-04 17:23:25,727 INFO : test_misclass             0.26667
2017-09-04 17:23:25,729 INFO : runtime                   2.97935
2017-09-04 17:23:25,732 INFO :
2017-09-04 17:23:27,597 INFO : Time only for training updates: 1.85s
2017-09-04 17:23:28,641 INFO : Epoch 29
2017-09-04 17:23:28,644 INFO : train_loss                0.12665
2017-09-04 17:23:28,647 INFO : valid_loss                0.21719
2017-09-04 17:23:28,649 INFO : test_loss                 0.74797
2017-09-04 17:23:28,651 INFO : train_sample_misclass     0.04274
2017-09-04 17:23:28,653 INFO : valid_sample_misclass     0.08623
2017-09-04 17:23:28,656 INFO : test_sample_misclass      0.26381
2017-09-04 17:23:28,658 INFO : train_misclass            0.03333
2017-09-04 17:23:28,660 INFO : valid_misclass            0.08333
2017-09-04 17:23:28,663 INFO : test_misclass             0.23333
2017-09-04 17:23:28,665 INFO : runtime                   2.87676
2017-09-04 17:23:28,667 INFO :
2017-09-04 17:23:30,583 INFO : Time only for training updates: 1.90s
2017-09-04 17:23:31,599 INFO : Epoch 30
2017-09-04 17:23:31,602 INFO : train_loss                0.07408
2017-09-04 17:23:31,604 INFO : valid_loss                0.15271
2017-09-04 17:23:31,606 INFO : test_loss                 0.67135
2017-09-04 17:23:31,609 INFO : train_sample_misclass     0.01497
2017-09-04 17:23:31,611 INFO : valid_sample_misclass     0.06061
2017-09-04 17:23:31,613 INFO : test_sample_misclass      0.23993
2017-09-04 17:23:31,615 INFO : train_misclass            0.01667
2017-09-04 17:23:31,618 INFO : valid_misclass            0.08333
2017-09-04 17:23:31,620 INFO : test_misclass             0.20000
2017-09-04 17:23:31,622 INFO : runtime                   2.98598
2017-09-04 17:23:31,624 INFO :
2017-09-04 17:23:33,344 INFO : Time only for training updates: 1.71s
2017-09-04 17:23:34,354 INFO : Epoch 31
2017-09-04 17:23:34,357 INFO : train_loss                0.05036
2017-09-04 17:23:34,359 INFO : valid_loss                0.09103
2017-09-04 17:23:34,362 INFO : test_loss                 0.66770
2017-09-04 17:23:34,364 INFO : train_sample_misclass     0.00744
2017-09-04 17:23:34,366 INFO : valid_sample_misclass     0.02317
2017-09-04 17:23:34,368 INFO : test_sample_misclass      0.20677
2017-09-04 17:23:34,371 INFO : train_misclass            0.00000
2017-09-04 17:23:34,373 INFO : valid_misclass            0.00000
2017-09-04 17:23:34,375 INFO : test_misclass             0.20000
2017-09-04 17:23:34,378 INFO : runtime                   2.76268
2017-09-04 17:23:34,380 INFO :
</pre></div></div>
</div>
<p>In this case, we arrive at 80.0% accuracy, the training stops after the
validation loss decreases below the training loss at the best epoch of
0.09315.</p>
</div>
<div class="section" id="Dataset-References">
<h2>Dataset References<a class="headerlink" href="#Dataset-References" title="Permalink to this headline">Â¶</a></h2>
<p>This dataset was created and contributed to PhysioNet by the developers
of the <a class="reference external" href="http://www.schalklab.org/research/bci2000">BCI2000</a>
instrumentation system, which they used in making these recordings. The
system is described in:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Schalk</span><span class="p">,</span> <span class="n">G</span><span class="o">.</span><span class="p">,</span> <span class="n">McFarland</span><span class="p">,</span> <span class="n">D</span><span class="o">.</span><span class="n">J</span><span class="o">.</span><span class="p">,</span> <span class="n">Hinterberger</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="p">,</span> <span class="n">Birbaumer</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="p">,</span> <span class="n">Wolpaw</span><span class="p">,</span> <span class="n">J</span><span class="o">.</span><span class="n">R</span><span class="o">.</span> <span class="p">(</span><span class="mi">2004</span><span class="p">)</span> <span class="n">BCI2000</span><span class="p">:</span> <span class="n">A</span> <span class="n">General</span><span class="o">-</span><span class="n">Purpose</span> <span class="n">Brain</span><span class="o">-</span><span class="n">Computer</span> <span class="n">Interface</span> <span class="p">(</span><span class="n">BCI</span><span class="p">)</span> <span class="n">System</span><span class="o">.</span> <span class="n">IEEE</span> <span class="n">TBME</span> <span class="mi">51</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span><span class="mi">1034</span><span class="o">-</span><span class="mf">1043.</span>
</pre></div>
</div>
<p><a class="reference external" href="https://physionet.org/physiobank/">PhysioBank</a> is a large and
growing archive of well-characterized digital recordings of physiologic
signals and related data for use by the biomedical research community
and further described in:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Goldberger</span> <span class="n">AL</span><span class="p">,</span> <span class="n">Amaral</span> <span class="n">LAN</span><span class="p">,</span> <span class="n">Glass</span> <span class="n">L</span><span class="p">,</span> <span class="n">Hausdorff</span> <span class="n">JM</span><span class="p">,</span> <span class="n">Ivanov</span> <span class="n">PCh</span><span class="p">,</span> <span class="n">Mark</span> <span class="n">RG</span><span class="p">,</span> <span class="n">Mietus</span> <span class="n">JE</span><span class="p">,</span> <span class="n">Moody</span> <span class="n">GB</span><span class="p">,</span> <span class="n">Peng</span> <span class="n">C</span><span class="o">-</span><span class="n">K</span><span class="p">,</span> <span class="n">Stanley</span> <span class="n">HE</span><span class="o">.</span> <span class="p">(</span><span class="mi">2000</span><span class="p">)</span> <span class="n">PhysioBank</span><span class="p">,</span> <span class="n">PhysioToolkit</span><span class="p">,</span> <span class="ow">and</span> <span class="n">PhysioNet</span><span class="p">:</span> <span class="n">Components</span> <span class="n">of</span> <span class="n">a</span> <span class="n">New</span> <span class="n">Research</span> <span class="n">Resource</span> <span class="k">for</span> <span class="n">Complex</span> <span class="n">Physiologic</span> <span class="n">Signals</span><span class="o">.</span> <span class="n">Circulation</span> <span class="mi">101</span><span class="p">(</span><span class="mi">23</span><span class="p">):</span><span class="n">e215</span><span class="o">-</span><span class="n">e220</span><span class="o">.</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="visualization/Perturbation.html" class="btn btn-neutral float-right" title="Amplitude Perturbation Visualization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Cropped_Decoding.html" class="btn btn-neutral" title="Cropped Decoding" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Robin Tibor Schirrmeister.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1.8',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>