

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using the Experiment Class &mdash; Braindecode 0.1.5 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Braindecode 0.1.5 documentation" href="../index.html"/>
        <link rel="next" title="braindecode.datautil package" href="../source/braindecode.datautil.html"/>
        <link rel="prev" title="Cropped Decoding" href="Cropped_Decoding.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Braindecode
          

          
          </a>

          
            
            
              <div class="version">
                0.1.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="TrialWise_Decoding.html">Trialwise Decoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cropped_Decoding.html">Cropped Decoding</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using the Experiment Class</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Load-data">Load data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Convert-data-to-Braindecode-Format">Convert data to Braindecode Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Create-the-model">Create the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Setup-Experiment">Setup Experiment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Run-experiment">Run experiment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Dataset-References">Dataset References</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.datautil.html">braindecode.datautil package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.experiments.html">braindecode.experiments package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.mne_ext.html">braindecode.mne_ext package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.models.html">braindecode.models package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/braindecode.torch_ext.html">braindecode.torch_ext package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Braindecode</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Using the Experiment Class</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/Experiment_Class.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Using-the-Experiment-Class">
<h1>Using the Experiment Class<a class="headerlink" href="#Using-the-Experiment-Class" title="Permalink to this headline">¶</a></h1>
<p>Braindecode provides a convenience <code class="docutils literal"><span class="pre">Experiment</span></code> class, which removes
the necessity to write your own training loop. It expects a training, a
validation and a test set and trains as follows:</p>
<ol class="arabic simple">
<li>Train on training set until a given stop criterion is fulfilled</li>
<li>Reset to the best epoch, i.e. reset parameters of the model and the
optimizer to the state at the best epoch (“best” according to a given
criterion)</li>
<li>Continue training on the combined training + validation set until the
loss on the validation set is as low as it was on the best epoch for
the training set. (or until the ConvNet was trained twice as many
epochs as the best epoch to prevent infinite training)</li>
</ol>
<div class="admonition warning">
It is not necessary to use the Experiment class to use the remaning
functionality of Braindecode. Feel free to ignore it :)</div>
<div class="section" id="Load-data">
<h2>Load data<a class="headerlink" href="#Load-data" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">from</span> <span class="nn">mne.io</span> <span class="k">import</span> <span class="n">concatenate_raws</span>

<span class="c1"># 5,6,7,10,13,14 are codes for executed and imagined hands/feet</span>
<span class="n">subject_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">event_codes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">]</span>

<span class="c1"># This will download the files if you don&#39;t have them yet,</span>
<span class="c1"># and then return the paths to the files.</span>
<span class="n">physionet_paths</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">eegbci</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">subject_id</span><span class="p">,</span> <span class="n">event_codes</span><span class="p">)</span>

<span class="c1"># Load each of the files</span>
<span class="n">parts</span> <span class="o">=</span> <span class="p">[</span><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_edf</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="s1">&#39;WARNING&#39;</span><span class="p">)</span>
         <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">physionet_paths</span><span class="p">]</span>

<span class="c1"># Concatenate them</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">concatenate_raws</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span>

<span class="c1"># Find the events in this dataset</span>
<span class="n">events</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">find_events</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">shortest_event</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;STI 014&#39;</span><span class="p">)</span>

<span class="c1"># Use only EEG channels</span>
<span class="n">eeg_channel_inds</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">exclude</span><span class="o">=</span><span class="s1">&#39;bads&#39;</span><span class="p">)</span>

<span class="c1"># Extract trials, only using EEG channels</span>
<span class="n">epoched</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">hands</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">feet</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span> <span class="n">tmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">4.1</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">eeg_channel_inds</span><span class="p">,</span>
                <span class="n">baseline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Removing orphaned offset at the beginning of the file.
179 events found
Events id: [1 2 3]
90 matching events found
Loading data for 90 events and 497 original time points ...
0 bad epochs dropped
</pre></div></div>
</div>
</div>
<div class="section" id="Convert-data-to-Braindecode-Format">
<h2>Convert data to Braindecode Format<a class="headerlink" href="#Convert-data-to-Braindecode-Format" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">braindecode.datautil.signal_target</span> <span class="k">import</span> <span class="n">SignalAndTarget</span>
<span class="kn">from</span> <span class="nn">braindecode.datautil.splitters</span> <span class="k">import</span> <span class="n">split_into_two_sets</span>
<span class="c1"># Convert data from volt to millivolt</span>
<span class="c1"># Pytorch expects float32 for input and int64 for labels.</span>
<span class="n">X</span> <span class="o">=</span> <span class="p">(</span><span class="n">epoched</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">epoched</span><span class="o">.</span><span class="n">events</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span> <span class="c1">#2,3 -&gt; 0,1</span>

<span class="n">train_set</span> <span class="o">=</span> <span class="n">SignalAndTarget</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">60</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">[:</span><span class="mi">60</span><span class="p">])</span>
<span class="n">test_set</span> <span class="o">=</span> <span class="n">SignalAndTarget</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">60</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">60</span><span class="p">:])</span>

<span class="n">train_set</span><span class="p">,</span> <span class="n">valid_set</span> <span class="o">=</span> <span class="n">split_into_two_sets</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> <span class="n">first_set_fraction</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Create-the-model">
<h2>Create the model<a class="headerlink" href="#Create-the-model" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.models.shallow_fbcsp</span> <span class="k">import</span> <span class="n">ShallowFBCSPNet</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="k">import</span> <span class="n">nn</span>
<span class="kn">from</span> <span class="nn">braindecode.torch_ext.util</span> <span class="k">import</span> <span class="n">set_random_seeds</span>
<span class="kn">from</span> <span class="nn">braindecode.models.util</span> <span class="k">import</span> <span class="n">to_dense_prediction_model</span>

<span class="c1"># Set if you want to use GPU</span>
<span class="c1"># You can also use torch.cuda.is_available() to determine if cuda is available on your machine.</span>
<span class="n">cuda</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">set_random_seeds</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">20170629</span><span class="p">,</span> <span class="n">cuda</span><span class="o">=</span><span class="n">cuda</span><span class="p">)</span>

<span class="c1"># This will determine how many crops are processed in parallel</span>
<span class="n">input_time_length</span> <span class="o">=</span> <span class="mi">450</span>
<span class="n">n_classes</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">in_chans</span> <span class="o">=</span> <span class="n">train_set</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># final_conv_length determines the size of the receptive field of the ConvNet</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ShallowFBCSPNet</span><span class="p">(</span><span class="n">in_chans</span><span class="o">=</span><span class="n">in_chans</span><span class="p">,</span> <span class="n">n_classes</span><span class="o">=</span><span class="n">n_classes</span><span class="p">,</span> <span class="n">input_time_length</span><span class="o">=</span><span class="n">input_time_length</span><span class="p">,</span>
                        <span class="n">final_conv_length</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">create_network</span><span class="p">()</span>
<span class="n">to_dense_prediction_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="k">if</span> <span class="n">cuda</span><span class="p">:</span>
    <span class="n">model</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">torch</span> <span class="k">import</span> <span class="n">optim</span>

<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.torch_ext.util</span> <span class="k">import</span> <span class="n">np_to_var</span>
<span class="c1"># determine output size</span>
<span class="n">test_input</span> <span class="o">=</span> <span class="n">np_to_var</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">in_chans</span><span class="p">,</span> <span class="n">input_time_length</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="k">if</span> <span class="n">cuda</span><span class="p">:</span>
    <span class="n">test_input</span> <span class="o">=</span> <span class="n">test_input</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">test_input</span><span class="p">)</span>
<span class="n">n_preds_per_input</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:d}</span><span class="s2"> predictions per input/trial&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n_preds_per_input</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
187 predictions per input/trial
</pre></div></div>
</div>
</div>
<div class="section" id="Setup-Experiment">
<h2>Setup Experiment<a class="headerlink" href="#Setup-Experiment" title="Permalink to this headline">¶</a></h2>
<p>Now we need to setup everything for the experiment: Iterator, loss
function, monitors and stop criterion.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.experiments.experiment</span> <span class="k">import</span> <span class="n">Experiment</span>
<span class="kn">from</span> <span class="nn">braindecode.datautil.iterators</span> <span class="k">import</span> <span class="n">CropsFromTrialsIterator</span>
<span class="kn">from</span> <span class="nn">braindecode.experiments.monitors</span> <span class="k">import</span> <span class="n">RuntimeMonitor</span><span class="p">,</span> <span class="n">LossMonitor</span><span class="p">,</span> <span class="n">CroppedTrialMisclassMonitor</span><span class="p">,</span> <span class="n">MisclassMonitor</span>
<span class="kn">from</span> <span class="nn">braindecode.experiments.stopcriteria</span> <span class="k">import</span> <span class="n">MaxEpochs</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">torch</span> <span class="k">as</span> <span class="nn">th</span>
<span class="kn">from</span> <span class="nn">braindecode.torch_ext.modules</span> <span class="k">import</span> <span class="n">Expression</span>
<span class="c1"># Iterator is used to iterate over datasets both for training</span>
<span class="c1"># and evaluation</span>
<span class="n">iterator</span> <span class="o">=</span> <span class="n">CropsFromTrialsIterator</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span><span class="n">input_time_length</span><span class="o">=</span><span class="n">input_time_length</span><span class="p">,</span>
                                  <span class="n">n_preds_per_input</span><span class="o">=</span><span class="n">n_preds_per_input</span><span class="p">)</span>

<span class="c1"># Loss function takes predictions as they come out of the network and the targets</span>
<span class="c1"># and returns a loss</span>
<span class="n">loss_function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">preds</span><span class="p">,</span> <span class="n">targets</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)[:,:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">targets</span><span class="p">)</span>

<span class="c1"># Could be used to apply some constraint on the models, then should be object</span>
<span class="c1"># with apply method that accepts a module</span>
<span class="n">model_constraint</span> <span class="o">=</span> <span class="kc">None</span>
<span class="c1"># Monitors log the training progress</span>
<span class="n">monitors</span> <span class="o">=</span> <span class="p">[</span><span class="n">LossMonitor</span><span class="p">(),</span> <span class="n">MisclassMonitor</span><span class="p">(</span><span class="n">col_suffix</span><span class="o">=</span><span class="s1">&#39;sample_misclass&#39;</span><span class="p">),</span>
            <span class="n">CroppedTrialMisclassMonitor</span><span class="p">(</span><span class="n">input_time_length</span><span class="p">),</span> <span class="n">RuntimeMonitor</span><span class="p">(),]</span>
<span class="c1"># Stop criterion determines when the first stop happens</span>
<span class="n">stop_criterion</span> <span class="o">=</span> <span class="n">MaxEpochs</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">Experiment</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train_set</span><span class="p">,</span> <span class="n">valid_set</span><span class="p">,</span> <span class="n">test_set</span><span class="p">,</span> <span class="n">iterator</span><span class="p">,</span> <span class="n">loss_function</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">model_constraint</span><span class="p">,</span>
          <span class="n">monitors</span><span class="p">,</span> <span class="n">stop_criterion</span><span class="p">,</span> <span class="n">remember_best_column</span><span class="o">=</span><span class="s1">&#39;valid_misclass&#39;</span><span class="p">,</span>
          <span class="n">run_after_early_stop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">batch_modifier</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cuda</span><span class="o">=</span><span class="n">cuda</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Run-experiment">
<h2>Run experiment<a class="headerlink" href="#Run-experiment" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># need to setup python logging before to be able to see anything</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> </span><span class="si">%(levelname)s</span><span class="s1"> : </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
                     <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
<span class="n">exp</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2017-07-05 13:09:17,238 INFO : Run until first stop...
2017-07-05 13:09:17,568 INFO : Epoch 0
2017-07-05 13:09:17,570 INFO : train_loss                0.86930
2017-07-05 13:09:17,572 INFO : valid_loss                0.74838
2017-07-05 13:09:17,573 INFO : test_loss                 0.69756
2017-07-05 13:09:17,575 INFO : train_sample_misclass     0.53894
2017-07-05 13:09:17,576 INFO : valid_sample_misclass     0.47103
2017-07-05 13:09:17,578 INFO : test_sample_misclass      0.44251
2017-07-05 13:09:17,579 INFO : train_misclass            0.60417
2017-07-05 13:09:17,581 INFO : valid_misclass            0.50000
2017-07-05 13:09:17,582 INFO : test_misclass             0.40000
2017-07-05 13:09:17,584 INFO : runtime                   0.00000
2017-07-05 13:09:17,585 INFO :
2017-07-05 13:09:17,588 INFO : New best valid_misclass: 0.500000
2017-07-05 13:09:17,589 INFO :
2017-07-05 13:09:19,133 INFO : Epoch 1
2017-07-05 13:09:19,136 INFO : train_loss                2.33626
2017-07-05 13:09:19,138 INFO : valid_loss                2.31771
2017-07-05 13:09:19,139 INFO : test_loss                 2.14077
2017-07-05 13:09:19,141 INFO : train_sample_misclass     0.48279
2017-07-05 13:09:19,142 INFO : valid_sample_misclass     0.50000
2017-07-05 13:09:19,144 INFO : test_sample_misclass      0.46667
2017-07-05 13:09:19,146 INFO : train_misclass            0.50000
2017-07-05 13:09:19,147 INFO : valid_misclass            0.50000
2017-07-05 13:09:19,149 INFO : test_misclass             0.46667
2017-07-05 13:09:19,150 INFO : runtime                   1.48697
2017-07-05 13:09:19,152 INFO :
2017-07-05 13:09:19,154 INFO : New best valid_misclass: 0.500000
2017-07-05 13:09:19,156 INFO :
2017-07-05 13:09:20,640 INFO : Epoch 2
2017-07-05 13:09:20,642 INFO : train_loss                0.59815
2017-07-05 13:09:20,644 INFO : valid_loss                0.78503
2017-07-05 13:09:20,645 INFO : test_loss                 0.70060
2017-07-05 13:09:20,647 INFO : train_sample_misclass     0.33918
2017-07-05 13:09:20,648 INFO : valid_sample_misclass     0.47995
2017-07-05 13:09:20,650 INFO : test_sample_misclass      0.41996
2017-07-05 13:09:20,651 INFO : train_misclass            0.22917
2017-07-05 13:09:20,653 INFO : valid_misclass            0.41667
2017-07-05 13:09:20,654 INFO : test_misclass             0.43333
2017-07-05 13:09:20,656 INFO : runtime                   1.47383
2017-07-05 13:09:20,658 INFO :
2017-07-05 13:09:20,660 INFO : New best valid_misclass: 0.416667
2017-07-05 13:09:20,661 INFO :
2017-07-05 13:09:22,229 INFO : Epoch 3
2017-07-05 13:09:22,232 INFO : train_loss                0.53121
2017-07-05 13:09:22,233 INFO : valid_loss                0.87284
2017-07-05 13:09:22,235 INFO : test_loss                 0.69774
2017-07-05 13:09:22,236 INFO : train_sample_misclass     0.24588
2017-07-05 13:09:22,238 INFO : valid_sample_misclass     0.55548
2017-07-05 13:09:22,240 INFO : test_sample_misclass      0.42709
2017-07-05 13:09:22,241 INFO : train_misclass            0.22917
2017-07-05 13:09:22,243 INFO : valid_misclass            0.50000
2017-07-05 13:09:22,244 INFO : test_misclass             0.36667
2017-07-05 13:09:22,246 INFO : runtime                   1.59794
2017-07-05 13:09:22,247 INFO :
2017-07-05 13:09:23,915 INFO : Epoch 4
2017-07-05 13:09:23,918 INFO : train_loss                0.51574
2017-07-05 13:09:23,919 INFO : valid_loss                1.10377
2017-07-05 13:09:23,921 INFO : test_loss                 0.80095
2017-07-05 13:09:23,922 INFO : train_sample_misclass     0.25869
2017-07-05 13:09:23,924 INFO : valid_sample_misclass     0.60094
2017-07-05 13:09:23,925 INFO : test_sample_misclass      0.42727
2017-07-05 13:09:23,927 INFO : train_misclass            0.27083
2017-07-05 13:09:23,928 INFO : valid_misclass            0.58333
2017-07-05 13:09:23,930 INFO : test_misclass             0.46667
2017-07-05 13:09:23,931 INFO : runtime                   1.68490
2017-07-05 13:09:23,933 INFO :
2017-07-05 13:09:25,516 INFO : Epoch 5
2017-07-05 13:09:25,522 INFO : train_loss                0.52613
2017-07-05 13:09:25,523 INFO : valid_loss                1.22322
2017-07-05 13:09:25,523 INFO : test_loss                 0.86285
2017-07-05 13:09:25,524 INFO : train_sample_misclass     0.27635
2017-07-05 13:09:25,525 INFO : valid_sample_misclass     0.58445
2017-07-05 13:09:25,526 INFO : test_sample_misclass      0.43841
2017-07-05 13:09:25,527 INFO : train_misclass            0.33333
2017-07-05 13:09:25,527 INFO : valid_misclass            0.58333
2017-07-05 13:09:25,528 INFO : test_misclass             0.46667
2017-07-05 13:09:25,530 INFO : runtime                   1.59985
2017-07-05 13:09:25,531 INFO :
2017-07-05 13:09:27,121 INFO : Epoch 6
2017-07-05 13:09:27,122 INFO : train_loss                0.54906
2017-07-05 13:09:27,123 INFO : valid_loss                1.23573
2017-07-05 13:09:27,124 INFO : test_loss                 0.92210
2017-07-05 13:09:27,125 INFO : train_sample_misclass     0.28816
2017-07-05 13:09:27,126 INFO : valid_sample_misclass     0.53810
2017-07-05 13:09:27,126 INFO : test_sample_misclass      0.45205
2017-07-05 13:09:27,127 INFO : train_misclass            0.33333
2017-07-05 13:09:27,128 INFO : valid_misclass            0.58333
2017-07-05 13:09:27,129 INFO : test_misclass             0.46667
2017-07-05 13:09:27,131 INFO : runtime                   1.59520
2017-07-05 13:09:27,132 INFO :
2017-07-05 13:09:28,768 INFO : Epoch 7
2017-07-05 13:09:28,771 INFO : train_loss                0.59627
2017-07-05 13:09:28,772 INFO : valid_loss                1.16602
2017-07-05 13:09:28,774 INFO : test_loss                 0.95655
2017-07-05 13:09:28,775 INFO : train_sample_misclass     0.32253
2017-07-05 13:09:28,777 INFO : valid_sample_misclass     0.53053
2017-07-05 13:09:28,778 INFO : test_sample_misclass      0.46346
2017-07-05 13:09:28,780 INFO : train_misclass            0.37500
2017-07-05 13:09:28,782 INFO : valid_misclass            0.58333
2017-07-05 13:09:28,783 INFO : test_misclass             0.46667
2017-07-05 13:09:28,785 INFO : runtime                   1.64261
2017-07-05 13:09:28,786 INFO :
2017-07-05 13:09:30,340 INFO : Epoch 8
2017-07-05 13:09:30,342 INFO : train_loss                0.40527
2017-07-05 13:09:30,344 INFO : valid_loss                0.95821
2017-07-05 13:09:30,345 INFO : test_loss                 0.79267
2017-07-05 13:09:30,347 INFO : train_sample_misclass     0.19112
2017-07-05 13:09:30,348 INFO : valid_sample_misclass     0.52607
2017-07-05 13:09:30,350 INFO : test_sample_misclass      0.43351
2017-07-05 13:09:30,351 INFO : train_misclass            0.16667
2017-07-05 13:09:30,353 INFO : valid_misclass            0.58333
2017-07-05 13:09:30,354 INFO : test_misclass             0.40000
2017-07-05 13:09:30,356 INFO : runtime                   1.57786
2017-07-05 13:09:30,357 INFO :
2017-07-05 13:09:32,001 INFO : Epoch 9
2017-07-05 13:09:32,005 INFO : train_loss                0.30290
2017-07-05 13:09:32,006 INFO : valid_loss                0.89596
2017-07-05 13:09:32,008 INFO : test_loss                 0.75205
2017-07-05 13:09:32,009 INFO : train_sample_misclass     0.10968
2017-07-05 13:09:32,011 INFO : valid_sample_misclass     0.56684
2017-07-05 13:09:32,012 INFO : test_sample_misclass      0.43119
2017-07-05 13:09:32,014 INFO : train_misclass            0.08333
2017-07-05 13:09:32,015 INFO : valid_misclass            0.58333
2017-07-05 13:09:32,017 INFO : test_misclass             0.36667
2017-07-05 13:09:32,018 INFO : runtime                   1.66996
2017-07-05 13:09:32,020 INFO :
2017-07-05 13:09:33,502 INFO : Epoch 10
2017-07-05 13:09:33,504 INFO : train_loss                0.25623
2017-07-05 13:09:33,506 INFO : valid_loss                0.89555
2017-07-05 13:09:33,508 INFO : test_loss                 0.75208
2017-07-05 13:09:33,510 INFO : train_sample_misclass     0.06088
2017-07-05 13:09:33,511 INFO : valid_sample_misclass     0.55637
2017-07-05 13:09:33,513 INFO : test_sample_misclass      0.41765
2017-07-05 13:09:33,514 INFO : train_misclass            0.02083
2017-07-05 13:09:33,516 INFO : valid_misclass            0.58333
2017-07-05 13:09:33,517 INFO : test_misclass             0.33333
2017-07-05 13:09:33,519 INFO : runtime                   1.50552
2017-07-05 13:09:33,520 INFO :
2017-07-05 13:09:35,158 INFO : Epoch 11
2017-07-05 13:09:35,161 INFO : train_loss                0.24021
2017-07-05 13:09:35,163 INFO : valid_loss                0.90581
2017-07-05 13:09:35,164 INFO : test_loss                 0.75648
2017-07-05 13:09:35,166 INFO : train_sample_misclass     0.06205
2017-07-05 13:09:35,167 INFO : valid_sample_misclass     0.54256
2017-07-05 13:09:35,169 INFO : test_sample_misclass      0.39804
2017-07-05 13:09:35,170 INFO : train_misclass            0.02083
2017-07-05 13:09:35,171 INFO : valid_misclass            0.58333
2017-07-05 13:09:35,173 INFO : test_misclass             0.33333
2017-07-05 13:09:35,174 INFO : runtime                   1.64930
2017-07-05 13:09:35,176 INFO :
2017-07-05 13:09:36,638 INFO : Epoch 12
2017-07-05 13:09:36,640 INFO : train_loss                0.20491
2017-07-05 13:09:36,642 INFO : valid_loss                0.90257
2017-07-05 13:09:36,643 INFO : test_loss                 0.75600
2017-07-05 13:09:36,645 INFO : train_sample_misclass     0.05041
2017-07-05 13:09:36,646 INFO : valid_sample_misclass     0.54055
2017-07-05 13:09:36,648 INFO : test_sample_misclass      0.39501
2017-07-05 13:09:36,650 INFO : train_misclass            0.00000
2017-07-05 13:09:36,651 INFO : valid_misclass            0.58333
2017-07-05 13:09:36,653 INFO : test_misclass             0.33333
2017-07-05 13:09:36,654 INFO : runtime                   1.50060
2017-07-05 13:09:36,656 INFO :
2017-07-05 13:09:37,985 INFO : Epoch 13
2017-07-05 13:09:37,988 INFO : train_loss                0.17244
2017-07-05 13:09:37,989 INFO : valid_loss                0.90562
2017-07-05 13:09:37,991 INFO : test_loss                 0.76539
2017-07-05 13:09:37,992 INFO : train_sample_misclass     0.03793
2017-07-05 13:09:37,994 INFO : valid_sample_misclass     0.56194
2017-07-05 13:09:37,995 INFO : test_sample_misclass      0.38752
2017-07-05 13:09:37,997 INFO : train_misclass            0.00000
2017-07-05 13:09:37,998 INFO : valid_misclass            0.66667
2017-07-05 13:09:38,000 INFO : test_misclass             0.36667
2017-07-05 13:09:38,001 INFO : runtime                   1.36125
2017-07-05 13:09:38,003 INFO :
2017-07-05 13:09:39,333 INFO : Epoch 14
2017-07-05 13:09:39,335 INFO : train_loss                0.15207
2017-07-05 13:09:39,337 INFO : valid_loss                0.90600
2017-07-05 13:09:39,338 INFO : test_loss                 0.76428
2017-07-05 13:09:39,340 INFO : train_sample_misclass     0.02969
2017-07-05 13:09:39,341 INFO : valid_sample_misclass     0.54924
2017-07-05 13:09:39,343 INFO : test_sample_misclass      0.36551
2017-07-05 13:09:39,345 INFO : train_misclass            0.00000
2017-07-05 13:09:39,346 INFO : valid_misclass            0.58333
2017-07-05 13:09:39,348 INFO : test_misclass             0.36667
2017-07-05 13:09:39,349 INFO : runtime                   1.34709
2017-07-05 13:09:39,351 INFO :
2017-07-05 13:09:40,677 INFO : Epoch 15
2017-07-05 13:09:40,679 INFO : train_loss                0.14998
2017-07-05 13:09:40,681 INFO : valid_loss                0.96411
2017-07-05 13:09:40,682 INFO : test_loss                 0.81256
2017-07-05 13:09:40,684 INFO : train_sample_misclass     0.04027
2017-07-05 13:09:40,685 INFO : valid_sample_misclass     0.48061
2017-07-05 13:09:40,687 INFO : test_sample_misclass      0.35811
2017-07-05 13:09:40,688 INFO : train_misclass            0.02083
2017-07-05 13:09:40,690 INFO : valid_misclass            0.50000
2017-07-05 13:09:40,691 INFO : test_misclass             0.33333
2017-07-05 13:09:40,693 INFO : runtime                   1.34376
2017-07-05 13:09:40,694 INFO :
2017-07-05 13:09:42,074 INFO : Epoch 16
2017-07-05 13:09:42,077 INFO : train_loss                0.10915
2017-07-05 13:09:42,078 INFO : valid_loss                0.91490
2017-07-05 13:09:42,080 INFO : test_loss                 0.80608
2017-07-05 13:09:42,082 INFO : train_sample_misclass     0.01588
2017-07-05 13:09:42,083 INFO : valid_sample_misclass     0.54234
2017-07-05 13:09:42,085 INFO : test_sample_misclass      0.34537
2017-07-05 13:09:42,086 INFO : train_misclass            0.00000
2017-07-05 13:09:42,088 INFO : valid_misclass            0.33333
2017-07-05 13:09:42,089 INFO : test_misclass             0.33333
2017-07-05 13:09:42,091 INFO : runtime                   1.34378
2017-07-05 13:09:42,092 INFO :
2017-07-05 13:09:42,095 INFO : New best valid_misclass: 0.333333
2017-07-05 13:09:42,097 INFO :
2017-07-05 13:09:43,990 INFO : Epoch 17
2017-07-05 13:09:43,992 INFO : train_loss                0.15003
2017-07-05 13:09:43,994 INFO : valid_loss                0.91323
2017-07-05 13:09:43,995 INFO : test_loss                 0.81002
2017-07-05 13:09:43,997 INFO : train_sample_misclass     0.05403
2017-07-05 13:09:43,998 INFO : valid_sample_misclass     0.51337
2017-07-05 13:09:44,000 INFO : test_sample_misclass      0.34403
2017-07-05 13:09:44,001 INFO : train_misclass            0.04167
2017-07-05 13:09:44,003 INFO : valid_misclass            0.50000
2017-07-05 13:09:44,004 INFO : test_misclass             0.23333
2017-07-05 13:09:44,006 INFO : runtime                   1.87296
2017-07-05 13:09:44,007 INFO :
2017-07-05 13:09:45,338 INFO : Epoch 18
2017-07-05 13:09:45,340 INFO : train_loss                0.09315
2017-07-05 13:09:45,342 INFO : valid_loss                0.89064
2017-07-05 13:09:45,344 INFO : test_loss                 0.77360
2017-07-05 13:09:45,345 INFO : train_sample_misclass     0.01025
2017-07-05 13:09:45,347 INFO : valid_sample_misclass     0.49666
2017-07-05 13:09:45,348 INFO : test_sample_misclass      0.30873
2017-07-05 13:09:45,350 INFO : train_misclass            0.00000
2017-07-05 13:09:45,352 INFO : valid_misclass            0.33333
2017-07-05 13:09:45,353 INFO : test_misclass             0.33333
2017-07-05 13:09:45,355 INFO : runtime                   1.44523
2017-07-05 13:09:45,356 INFO :
2017-07-05 13:09:45,359 INFO : New best valid_misclass: 0.333333
2017-07-05 13:09:45,361 INFO :
2017-07-05 13:09:47,065 INFO : Epoch 19
2017-07-05 13:09:47,067 INFO : train_loss                0.09407
2017-07-05 13:09:47,068 INFO : valid_loss                0.96350
2017-07-05 13:09:47,069 INFO : test_loss                 0.84831
2017-07-05 13:09:47,071 INFO : train_sample_misclass     0.02078
2017-07-05 13:09:47,072 INFO : valid_sample_misclass     0.49042
2017-07-05 13:09:47,074 INFO : test_sample_misclass      0.33137
2017-07-05 13:09:47,075 INFO : train_misclass            0.00000
2017-07-05 13:09:47,077 INFO : valid_misclass            0.50000
2017-07-05 13:09:47,079 INFO : test_misclass             0.30000
2017-07-05 13:09:47,080 INFO : runtime                   1.55673
2017-07-05 13:09:47,082 INFO :
2017-07-05 13:09:48,563 INFO : Epoch 20
2017-07-05 13:09:48,566 INFO : train_loss                0.06822
2017-07-05 13:09:48,567 INFO : valid_loss                1.05598
2017-07-05 13:09:48,569 INFO : test_loss                 0.88760
2017-07-05 13:09:48,570 INFO : train_sample_misclass     0.00847
2017-07-05 13:09:48,572 INFO : valid_sample_misclass     0.51448
2017-07-05 13:09:48,573 INFO : test_sample_misclass      0.33066
2017-07-05 13:09:48,575 INFO : train_misclass            0.00000
2017-07-05 13:09:48,576 INFO : valid_misclass            0.50000
2017-07-05 13:09:48,578 INFO : test_misclass             0.36667
2017-07-05 13:09:48,579 INFO : runtime                   1.64454
2017-07-05 13:09:48,581 INFO :
2017-07-05 13:09:48,583 INFO : Setup for second stop...
2017-07-05 13:09:48,586 INFO : Train loss to reach 0.09315
2017-07-05 13:09:48,588 INFO : Run until second stop...
2017-07-05 13:09:48,959 INFO : Epoch 19
2017-07-05 13:09:48,961 INFO : train_loss                0.25265
2017-07-05 13:09:48,963 INFO : valid_loss                0.89064
2017-07-05 13:09:48,964 INFO : test_loss                 0.77360
2017-07-05 13:09:48,966 INFO : train_sample_misclass     0.10753
2017-07-05 13:09:48,967 INFO : valid_sample_misclass     0.49666
2017-07-05 13:09:48,969 INFO : test_sample_misclass      0.30873
2017-07-05 13:09:48,970 INFO : train_misclass            0.06667
2017-07-05 13:09:48,972 INFO : valid_misclass            0.33333
2017-07-05 13:09:48,973 INFO : test_misclass             0.33333
2017-07-05 13:09:48,975 INFO : runtime                   0.45209
2017-07-05 13:09:48,976 INFO :
2017-07-05 13:09:50,412 INFO : Epoch 20
2017-07-05 13:09:50,415 INFO : train_loss                0.21080
2017-07-05 13:09:50,416 INFO : valid_loss                0.68103
2017-07-05 13:09:50,418 INFO : test_loss                 0.73508
2017-07-05 13:09:50,420 INFO : train_sample_misclass     0.08324
2017-07-05 13:09:50,422 INFO : valid_sample_misclass     0.34915
2017-07-05 13:09:50,423 INFO : test_sample_misclass      0.31025
2017-07-05 13:09:50,425 INFO : train_misclass            0.10000
2017-07-05 13:09:50,426 INFO : valid_misclass            0.50000
2017-07-05 13:09:50,428 INFO : test_misclass             0.26667
2017-07-05 13:09:50,429 INFO : runtime                   1.37581
2017-07-05 13:09:50,431 INFO :
2017-07-05 13:09:52,410 INFO : Epoch 21
2017-07-05 13:09:52,412 INFO : train_loss                0.18816
2017-07-05 13:09:52,414 INFO : valid_loss                0.46174
2017-07-05 13:09:52,416 INFO : test_loss                 0.66965
2017-07-05 13:09:52,417 INFO : train_sample_misclass     0.07406
2017-07-05 13:09:52,419 INFO : valid_sample_misclass     0.24643
2017-07-05 13:09:52,420 INFO : test_sample_misclass      0.28066
2017-07-05 13:09:52,422 INFO : train_misclass            0.05000
2017-07-05 13:09:52,423 INFO : valid_misclass            0.16667
2017-07-05 13:09:52,425 INFO : test_misclass             0.26667
2017-07-05 13:09:52,426 INFO : runtime                   1.94951
2017-07-05 13:09:52,428 INFO :
2017-07-05 13:09:54,146 INFO : Epoch 22
2017-07-05 13:09:54,148 INFO : train_loss                0.13663
2017-07-05 13:09:54,150 INFO : valid_loss                0.28806
2017-07-05 13:09:54,151 INFO : test_loss                 0.63335
2017-07-05 13:09:54,153 INFO : train_sample_misclass     0.02567
2017-07-05 13:09:54,154 INFO : valid_sample_misclass     0.06796
2017-07-05 13:09:54,156 INFO : test_sample_misclass      0.25677
2017-07-05 13:09:54,157 INFO : train_misclass            0.00000
2017-07-05 13:09:54,159 INFO : valid_misclass            0.00000
2017-07-05 13:09:54,160 INFO : test_misclass             0.23333
2017-07-05 13:09:54,162 INFO : runtime                   1.75455
2017-07-05 13:09:54,164 INFO :
2017-07-05 13:09:56,176 INFO : Epoch 23
2017-07-05 13:09:56,178 INFO : train_loss                0.18469
2017-07-05 13:09:56,180 INFO : valid_loss                0.33505
2017-07-05 13:09:56,182 INFO : test_loss                 0.74569
2017-07-05 13:09:56,183 INFO : train_sample_misclass     0.07469
2017-07-05 13:09:56,185 INFO : valid_sample_misclass     0.15575
2017-07-05 13:09:56,186 INFO : test_sample_misclass      0.29652
2017-07-05 13:09:56,188 INFO : train_misclass            0.05000
2017-07-05 13:09:56,189 INFO : valid_misclass            0.08333
2017-07-05 13:09:56,191 INFO : test_misclass             0.26667
2017-07-05 13:09:56,192 INFO : runtime                   2.01753
2017-07-05 13:09:56,194 INFO :
2017-07-05 13:09:58,098 INFO : Epoch 24
2017-07-05 13:09:58,101 INFO : train_loss                0.12348
2017-07-05 13:09:58,102 INFO : valid_loss                0.28360
2017-07-05 13:09:58,104 INFO : test_loss                 0.78044
2017-07-05 13:09:58,105 INFO : train_sample_misclass     0.03632
2017-07-05 13:09:58,107 INFO : valid_sample_misclass     0.10495
2017-07-05 13:09:58,108 INFO : test_sample_misclass      0.28529
2017-07-05 13:09:58,110 INFO : train_misclass            0.03333
2017-07-05 13:09:58,112 INFO : valid_misclass            0.08333
2017-07-05 13:09:58,113 INFO : test_misclass             0.26667
2017-07-05 13:09:58,115 INFO : runtime                   1.91925
2017-07-05 13:09:58,116 INFO :
2017-07-05 13:09:59,840 INFO : Epoch 25
2017-07-05 13:09:59,842 INFO : train_loss                0.14715
2017-07-05 13:09:59,844 INFO : valid_loss                0.19253
2017-07-05 13:09:59,845 INFO : test_loss                 0.77622
2017-07-05 13:09:59,847 INFO : train_sample_misclass     0.04635
2017-07-05 13:09:59,848 INFO : valid_sample_misclass     0.05660
2017-07-05 13:09:59,850 INFO : test_sample_misclass      0.26863
2017-07-05 13:09:59,851 INFO : train_misclass            0.05000
2017-07-05 13:09:59,853 INFO : valid_misclass            0.08333
2017-07-05 13:09:59,854 INFO : test_misclass             0.23333
2017-07-05 13:09:59,856 INFO : runtime                   1.78454
2017-07-05 13:09:59,857 INFO :
2017-07-05 13:10:01,991 INFO : Epoch 26
2017-07-05 13:10:01,995 INFO : train_loss                0.33871
2017-07-05 13:10:01,996 INFO : valid_loss                0.33738
2017-07-05 13:10:01,998 INFO : test_loss                 0.75611
2017-07-05 13:10:01,999 INFO : train_sample_misclass     0.16430
2017-07-05 13:10:02,001 INFO : valid_sample_misclass     0.16689
2017-07-05 13:10:02,002 INFO : test_sample_misclass      0.27763
2017-07-05 13:10:02,004 INFO : train_misclass            0.11667
2017-07-05 13:10:02,006 INFO : valid_misclass            0.16667
2017-07-05 13:10:02,007 INFO : test_misclass             0.26667
2017-07-05 13:10:02,009 INFO : runtime                   2.02184
2017-07-05 13:10:02,011 INFO :
2017-07-05 13:10:04,383 INFO : Epoch 27
2017-07-05 13:10:04,385 INFO : train_loss                0.12510
2017-07-05 13:10:04,385 INFO : valid_loss                0.14954
2017-07-05 13:10:04,386 INFO : test_loss                 0.60954
2017-07-05 13:10:04,387 INFO : train_sample_misclass     0.03111
2017-07-05 13:10:04,387 INFO : valid_sample_misclass     0.02718
2017-07-05 13:10:04,388 INFO : test_sample_misclass      0.23351
2017-07-05 13:10:04,389 INFO : train_misclass            0.01667
2017-07-05 13:10:04,390 INFO : valid_misclass            0.00000
2017-07-05 13:10:04,390 INFO : test_misclass             0.16667
2017-07-05 13:10:04,391 INFO : runtime                   2.44422
2017-07-05 13:10:04,392 INFO :
2017-07-05 13:10:06,833 INFO : Epoch 28
2017-07-05 13:10:06,835 INFO : train_loss                0.09142
2017-07-05 13:10:06,837 INFO : valid_loss                0.15033
2017-07-05 13:10:06,838 INFO : test_loss                 0.64889
2017-07-05 13:10:06,840 INFO : train_sample_misclass     0.01239
2017-07-05 13:10:06,841 INFO : valid_sample_misclass     0.03387
2017-07-05 13:10:06,843 INFO : test_sample_misclass      0.25856
2017-07-05 13:10:06,844 INFO : train_misclass            0.00000
2017-07-05 13:10:06,846 INFO : valid_misclass            0.00000
2017-07-05 13:10:06,847 INFO : test_misclass             0.26667
2017-07-05 13:10:06,849 INFO : runtime                   2.37887
2017-07-05 13:10:06,850 INFO :
2017-07-05 13:10:08,969 INFO : Epoch 29
2017-07-05 13:10:08,971 INFO : train_loss                0.12668
2017-07-05 13:10:08,973 INFO : valid_loss                0.21722
2017-07-05 13:10:08,975 INFO : test_loss                 0.74796
2017-07-05 13:10:08,976 INFO : train_sample_misclass     0.04274
2017-07-05 13:10:08,978 INFO : valid_sample_misclass     0.08623
2017-07-05 13:10:08,979 INFO : test_sample_misclass      0.26399
2017-07-05 13:10:08,981 INFO : train_misclass            0.03333
2017-07-05 13:10:08,982 INFO : valid_misclass            0.08333
2017-07-05 13:10:08,984 INFO : test_misclass             0.23333
2017-07-05 13:10:08,985 INFO : runtime                   2.10714
2017-07-05 13:10:08,987 INFO :
2017-07-05 13:10:10,983 INFO : Epoch 30
2017-07-05 13:10:10,985 INFO : train_loss                0.07407
2017-07-05 13:10:10,986 INFO : valid_loss                0.15270
2017-07-05 13:10:10,988 INFO : test_loss                 0.67133
2017-07-05 13:10:10,989 INFO : train_sample_misclass     0.01497
2017-07-05 13:10:10,991 INFO : valid_sample_misclass     0.06061
2017-07-05 13:10:10,992 INFO : test_sample_misclass      0.23975
2017-07-05 13:10:10,994 INFO : train_misclass            0.01667
2017-07-05 13:10:10,995 INFO : valid_misclass            0.08333
2017-07-05 13:10:10,997 INFO : test_misclass             0.20000
2017-07-05 13:10:10,998 INFO : runtime                   2.06612
2017-07-05 13:10:11,000 INFO :
2017-07-05 13:10:13,107 INFO : Epoch 31
2017-07-05 13:10:13,109 INFO : train_loss                0.05036
2017-07-05 13:10:13,111 INFO : valid_loss                0.09103
2017-07-05 13:10:13,112 INFO : test_loss                 0.66769
2017-07-05 13:10:13,114 INFO : train_sample_misclass     0.00744
2017-07-05 13:10:13,115 INFO : valid_sample_misclass     0.02317
2017-07-05 13:10:13,117 INFO : test_sample_misclass      0.20677
2017-07-05 13:10:13,118 INFO : train_misclass            0.00000
2017-07-05 13:10:13,120 INFO : valid_misclass            0.00000
2017-07-05 13:10:13,121 INFO : test_misclass             0.20000
2017-07-05 13:10:13,123 INFO : runtime                   2.15274
2017-07-05 13:10:13,124 INFO :
</pre></div></div>
</div>
<p>In this case, we arrive at 80.0% accuracy, the training stops after the
validation loss decreases below the training loss at the best epoch of
0.03722.</p>
</div>
<div class="section" id="Dataset-References">
<h2>Dataset References<a class="headerlink" href="#Dataset-References" title="Permalink to this headline">¶</a></h2>
<p>This dataset was created and contributed to PhysioNet by the developers
of the <a class="reference external" href="http://www.schalklab.org/research/bci2000">BCI2000</a>
instrumentation system, which they used in making these recordings. The
system is described in:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Schalk</span><span class="p">,</span> <span class="n">G</span><span class="o">.</span><span class="p">,</span> <span class="n">McFarland</span><span class="p">,</span> <span class="n">D</span><span class="o">.</span><span class="n">J</span><span class="o">.</span><span class="p">,</span> <span class="n">Hinterberger</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="p">,</span> <span class="n">Birbaumer</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="p">,</span> <span class="n">Wolpaw</span><span class="p">,</span> <span class="n">J</span><span class="o">.</span><span class="n">R</span><span class="o">.</span> <span class="p">(</span><span class="mi">2004</span><span class="p">)</span> <span class="n">BCI2000</span><span class="p">:</span> <span class="n">A</span> <span class="n">General</span><span class="o">-</span><span class="n">Purpose</span> <span class="n">Brain</span><span class="o">-</span><span class="n">Computer</span> <span class="n">Interface</span> <span class="p">(</span><span class="n">BCI</span><span class="p">)</span> <span class="n">System</span><span class="o">.</span> <span class="n">IEEE</span> <span class="n">TBME</span> <span class="mi">51</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span><span class="mi">1034</span><span class="o">-</span><span class="mf">1043.</span>
</pre></div>
</div>
<p><a class="reference external" href="https://physionet.org/physiobank/">PhysioBank</a> is a large and
growing archive of well-characterized digital recordings of physiologic
signals and related data for use by the biomedical research community
and further described in:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Goldberger</span> <span class="n">AL</span><span class="p">,</span> <span class="n">Amaral</span> <span class="n">LAN</span><span class="p">,</span> <span class="n">Glass</span> <span class="n">L</span><span class="p">,</span> <span class="n">Hausdorff</span> <span class="n">JM</span><span class="p">,</span> <span class="n">Ivanov</span> <span class="n">PCh</span><span class="p">,</span> <span class="n">Mark</span> <span class="n">RG</span><span class="p">,</span> <span class="n">Mietus</span> <span class="n">JE</span><span class="p">,</span> <span class="n">Moody</span> <span class="n">GB</span><span class="p">,</span> <span class="n">Peng</span> <span class="n">C</span><span class="o">-</span><span class="n">K</span><span class="p">,</span> <span class="n">Stanley</span> <span class="n">HE</span><span class="o">.</span> <span class="p">(</span><span class="mi">2000</span><span class="p">)</span> <span class="n">PhysioBank</span><span class="p">,</span> <span class="n">PhysioToolkit</span><span class="p">,</span> <span class="ow">and</span> <span class="n">PhysioNet</span><span class="p">:</span> <span class="n">Components</span> <span class="n">of</span> <span class="n">a</span> <span class="n">New</span> <span class="n">Research</span> <span class="n">Resource</span> <span class="k">for</span> <span class="n">Complex</span> <span class="n">Physiologic</span> <span class="n">Signals</span><span class="o">.</span> <span class="n">Circulation</span> <span class="mi">101</span><span class="p">(</span><span class="mi">23</span><span class="p">):</span><span class="n">e215</span><span class="o">-</span><span class="n">e220</span><span class="o">.</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../source/braindecode.datautil.html" class="btn btn-neutral float-right" title="braindecode.datautil package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Cropped_Decoding.html" class="btn btn-neutral" title="Cropped Decoding" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Robin Tibor Schirrmeister.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1.5',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>