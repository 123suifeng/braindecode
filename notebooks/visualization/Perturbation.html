

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Amplitude Perturbation Visualization &mdash; Braindecode 0.1.6 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Braindecode 0.1.6 documentation" href="../../index.html"/>
        <link rel="next" title="braindecode.datautil package" href="../../source/braindecode.datautil.html"/>
        <link rel="prev" title="Using the Experiment Class" href="../Experiment_Class.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Braindecode
          

          
          </a>

          
            
            
              <div class="version">
                0.1.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../TrialWise_Decoding.html">Trialwise Decoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Cropped_Decoding.html">Cropped Decoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Experiment_Class.html">Using the Experiment Class</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Amplitude Perturbation Visualization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Load-data">Load data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Create-the-model,-optimizer,-iterator">Create the model, optimizer, iterator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Training-loop">Training loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Compute-amplitude-perturbation---prediction-change-correlation">Compute amplitude perturbation - prediction change correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Plot-correlations">Plot correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Plot-with-mne">Plot with mne</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Plot-with-Braindecode">Plot with Braindecode</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Dataset-References">Dataset References</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../source/braindecode.datautil.html">braindecode.datautil package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../source/braindecode.experiments.html">braindecode.experiments package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../source/braindecode.mne_ext.html">braindecode.mne_ext package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../source/braindecode.models.html">braindecode.models package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../source/braindecode.torch_ext.html">braindecode.torch_ext package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Braindecode</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Amplitude Perturbation Visualization</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/notebooks/visualization/Perturbation.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Amplitude-Perturbation-Visualization">
<h1>Amplitude Perturbation Visualization<a class="headerlink" href="#Amplitude-Perturbation-Visualization" title="Permalink to this headline">¶</a></h1>
<p>First we will do some cross-subject decoding, again using the
<a class="reference external" href="https://www.physionet.org/physiobank/database/eegmmidb/">Physiobank EEG Motor Movement/Imagery
Dataset</a>,
this time to decode imagined left hand vs. imagined right hand movement.</p>
<div class="section" id="Load-data">
<h2>Load data<a class="headerlink" href="#Load-data" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1">#%%capture</span>
<span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">mne.io</span> <span class="k">import</span> <span class="n">concatenate_raws</span>
<span class="kn">from</span> <span class="nn">braindecode.datautil.signal_target</span> <span class="k">import</span> <span class="n">SignalAndTarget</span>

<span class="c1"># First 50 subjects as train</span>
<span class="n">physionet_paths</span> <span class="o">=</span> <span class="p">[</span> <span class="n">mne</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">eegbci</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">sub_id</span><span class="p">,[</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">,])</span> <span class="k">for</span> <span class="n">sub_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">51</span><span class="p">)]</span>
<span class="n">physionet_paths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">physionet_paths</span><span class="p">)</span>
<span class="n">parts</span> <span class="o">=</span> <span class="p">[</span><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_edf</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
         <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">physionet_paths</span><span class="p">]</span>

<span class="n">raw</span> <span class="o">=</span> <span class="n">concatenate_raws</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span>

<span class="n">picks</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">exclude</span><span class="o">=</span><span class="s1">&#39;bads&#39;</span><span class="p">)</span>

<span class="n">events</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">find_events</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">shortest_event</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;STI 014&#39;</span><span class="p">)</span>

<span class="c1"># Read epochs (train will be done only between 1 and 2s)</span>
<span class="c1"># Testing will be done with a running classifier</span>
<span class="n">epoched</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">hands</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">feet</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span> <span class="n">tmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">4.1</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">picks</span><span class="p">,</span>
                <span class="n">baseline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Next 5 subjects as test</span>
<span class="n">physionet_paths_test</span> <span class="o">=</span> <span class="p">[</span><span class="n">mne</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">eegbci</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">sub_id</span><span class="p">,[</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">,])</span> <span class="k">for</span> <span class="n">sub_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">51</span><span class="p">,</span><span class="mi">56</span><span class="p">)]</span>
<span class="n">physionet_paths_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">physionet_paths_test</span><span class="p">)</span>
<span class="n">parts_test</span> <span class="o">=</span> <span class="p">[</span><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_edf</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
         <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">physionet_paths_test</span><span class="p">]</span>
<span class="n">raw_test</span> <span class="o">=</span> <span class="n">concatenate_raws</span><span class="p">(</span><span class="n">parts_test</span><span class="p">)</span>

<span class="n">picks_test</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">raw_test</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">exclude</span><span class="o">=</span><span class="s1">&#39;bads&#39;</span><span class="p">)</span>

<span class="n">events_test</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">find_events</span><span class="p">(</span><span class="n">raw_test</span><span class="p">,</span> <span class="n">shortest_event</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;STI 014&#39;</span><span class="p">)</span>

<span class="c1"># Read epochs (train will be done only between 1 and 2s)</span>
<span class="c1"># Testing will be done with a running classifier</span>
<span class="n">epoched_test</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span><span class="p">(</span><span class="n">raw_test</span><span class="p">,</span> <span class="n">events_test</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">hands</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">feet</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span> <span class="n">tmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">4.1</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">picks_test</span><span class="p">,</span>
                <span class="n">baseline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">train_X</span> <span class="o">=</span> <span class="p">(</span><span class="n">epoched</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">train_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">epoched</span><span class="o">.</span><span class="n">events</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span> <span class="c1">#2,3 -&gt; 0,1</span>
<span class="n">test_X</span> <span class="o">=</span> <span class="p">(</span><span class="n">epoched_test</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">test_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">epoched_test</span><span class="o">.</span><span class="n">events</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span> <span class="c1">#2,3 -&gt; 0,1</span>
<span class="n">train_set</span> <span class="o">=</span> <span class="n">SignalAndTarget</span><span class="p">(</span><span class="n">train_X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">train_y</span><span class="p">)</span>
<span class="n">test_set</span> <span class="o">=</span> <span class="n">SignalAndTarget</span><span class="p">(</span><span class="n">test_X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">test_y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S001/S001R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19999  =      0.000 ...   124.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S001/S001R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19999  =      0.000 ...   124.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S001/S001R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19999  =      0.000 ...   124.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S002/S002R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S002/S002R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S002/S002R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S003/S003R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19999  =      0.000 ...   124.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S003/S003R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19999  =      0.000 ...   124.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S003/S003R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19999  =      0.000 ...   124.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S004/S004R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S004/S004R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S004/S004R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S005/S005R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S005/S005R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S005/S005R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S006/S006R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S006/S006R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S006/S006R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S007/S007R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19999  =      0.000 ...   124.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S007/S007R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19999  =      0.000 ...   124.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S007/S007R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19999  =      0.000 ...   124.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S008/S008R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S008/S008R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S008/S008R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S009/S009R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S009/S009R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S009/S009R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S010/S010R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S010/S010R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S010/S010R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S011/S011R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S011/S011R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S011/S011R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S012/S012R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S012/S012R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S012/S012R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S013/S013R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S013/S013R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S013/S013R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S014/S014R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S014/S014R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S014/S014R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S015/S015R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S015/S015R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S015/S015R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S016/S016R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S016/S016R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S016/S016R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S017/S017R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S017/S017R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S017/S017R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S018/S018R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S018/S018R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S018/S018R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S019/S019R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S019/S019R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S019/S019R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S020/S020R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S020/S020R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S020/S020R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S021/S021R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19999  =      0.000 ...   124.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S021/S021R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19999  =      0.000 ...   124.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S021/S021R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19999  =      0.000 ...   124.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S022/S022R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19999  =      0.000 ...   124.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S022/S022R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19999  =      0.000 ...   124.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S022/S022R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19999  =      0.000 ...   124.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S023/S023R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S023/S023R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S023/S023R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S024/S024R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S024/S024R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S024/S024R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S025/S025R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S025/S025R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S025/S025R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S026/S026R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S026/S026R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S026/S026R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S027/S027R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S027/S027R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S027/S027R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S028/S028R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S028/S028R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S028/S028R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S029/S029R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19839  =      0.000 ...   123.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S029/S029R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19839  =      0.000 ...   123.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S029/S029R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19839  =      0.000 ...   123.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S030/S030R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19839  =      0.000 ...   123.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S030/S030R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19839  =      0.000 ...   123.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S030/S030R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19839  =      0.000 ...   123.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S031/S031R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S031/S031R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S031/S031R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S032/S032R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19999  =      0.000 ...   124.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S032/S032R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19999  =      0.000 ...   124.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S032/S032R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19999  =      0.000 ...   124.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S033/S033R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S033/S033R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S033/S033R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S034/S034R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19839  =      0.000 ...   123.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S034/S034R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S034/S034R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S035/S035R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19999  =      0.000 ...   124.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S035/S035R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19999  =      0.000 ...   124.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S035/S035R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19999  =      0.000 ...   124.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S036/S036R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S036/S036R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S036/S036R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S037/S037R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19839  =      0.000 ...   123.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S037/S037R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S037/S037R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S038/S038R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S038/S038R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S038/S038R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S039/S039R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S039/S039R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S039/S039R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S040/S040R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S040/S040R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S040/S040R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S041/S041R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19839  =      0.000 ...   123.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S041/S041R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S041/S041R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19839  =      0.000 ...   123.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S042/S042R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S042/S042R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S042/S042R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S043/S043R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S043/S043R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S043/S043R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S044/S044R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S044/S044R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S044/S044R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S045/S045R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S045/S045R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S045/S045R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S046/S046R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19999  =      0.000 ...   124.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S046/S046R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19999  =      0.000 ...   124.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S046/S046R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19999  =      0.000 ...   124.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S047/S047R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S047/S047R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S047/S047R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S048/S048R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S048/S048R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S048/S048R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S049/S049R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S049/S049R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S049/S049R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S050/S050R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S050/S050R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S050/S050R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Removing orphaned offset at the beginning of the file.
4499 events found
Events id: [1 2 3]
2250 matching events found
Loading data for 2250 events and 497 original time points ...
125 bad epochs dropped
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S051/S051R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19839  =      0.000 ...   123.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S051/S051R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19839  =      0.000 ...   123.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S051/S051R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19839  =      0.000 ...   123.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S052/S052R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S052/S052R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S052/S052R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S053/S053R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S053/S053R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S053/S053R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S054/S054R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S054/S054R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S054/S054R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S055/S055R04.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S055/S055R08.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Extracting edf Parameters from /home/schirrmr/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S055/S055R12.edf...
EDF file detected
Setting channel info structure...
Created Raw.info structure...
Reading 0 ... 19679  =      0.000 ...   122.994 secs...
Ready.
Removing orphaned offset at the beginning of the file.
449 events found
Events id: [1 2 3]
225 matching events found
Loading data for 225 events and 497 original time points ...
12 bad epochs dropped
</pre></div></div>
</div>
</div>
<div class="section" id="Create-the-model,-optimizer,-iterator">
<h2>Create the model, optimizer, iterator<a class="headerlink" href="#Create-the-model,-optimizer,-iterator" title="Permalink to this headline">¶</a></h2>
<p>We use the deep ConvNet from <a class="reference external" href="https://arxiv.org/abs/1703.05051">Deep learning with convolutional neural
networks for brain mapping and decoding of movement-related information
from the human EEG</a> Section 2.4.2).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.models.deep4</span> <span class="k">import</span> <span class="n">Deep4Net</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="k">import</span> <span class="n">nn</span>
<span class="kn">from</span> <span class="nn">braindecode.torch_ext.util</span> <span class="k">import</span> <span class="n">set_random_seeds</span>
<span class="kn">from</span> <span class="nn">braindecode.models.util</span> <span class="k">import</span> <span class="n">to_dense_prediction_model</span>

<span class="c1"># Set if you want to use GPU</span>
<span class="c1"># You can also use torch.cuda.is_available() to determine if cuda is available on your machine.</span>
<span class="n">cuda</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">set_random_seeds</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">20170629</span><span class="p">,</span> <span class="n">cuda</span><span class="o">=</span><span class="n">cuda</span><span class="p">)</span>

<span class="c1"># This will determine how many crops are processed in parallel</span>
<span class="n">input_time_length</span> <span class="o">=</span> <span class="mi">450</span>
<span class="c1"># final_conv_length determines the size of the receptive field of the ConvNet</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Deep4Net</span><span class="p">(</span><span class="n">in_chans</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">n_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">input_time_length</span><span class="o">=</span><span class="n">input_time_length</span><span class="p">,</span>
                 <span class="n">filter_length_3</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">filter_length_4</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                 <span class="n">pool_time_stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">final_conv_length</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">create_network</span><span class="p">()</span>
<span class="n">to_dense_prediction_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="k">if</span> <span class="n">cuda</span><span class="p">:</span>
    <span class="n">model</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">torch</span> <span class="k">import</span> <span class="n">optim</span>

<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

<span class="kn">from</span> <span class="nn">braindecode.torch_ext.util</span> <span class="k">import</span> <span class="n">np_to_var</span>
<span class="c1"># determine output size</span>
<span class="n">test_input</span> <span class="o">=</span> <span class="n">np_to_var</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="n">input_time_length</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="k">if</span> <span class="n">cuda</span><span class="p">:</span>
    <span class="n">test_input</span> <span class="o">=</span> <span class="n">test_input</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">test_input</span><span class="p">)</span>
<span class="n">n_preds_per_input</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:d}</span><span class="s2"> predictions per input/trial&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n_preds_per_input</span><span class="p">))</span>

<span class="kn">from</span> <span class="nn">braindecode.datautil.iterators</span> <span class="k">import</span> <span class="n">CropsFromTrialsIterator</span>
<span class="n">iterator</span> <span class="o">=</span> <span class="n">CropsFromTrialsIterator</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span><span class="n">input_time_length</span><span class="o">=</span><span class="n">input_time_length</span><span class="p">,</span>
                                  <span class="n">n_preds_per_input</span><span class="o">=</span><span class="n">n_preds_per_input</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
315 predictions per input/trial
</pre></div></div>
</div>
</div>
<div class="section" id="Training-loop">
<h2>Training loop<a class="headerlink" href="#Training-loop" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.torch_ext.util</span> <span class="k">import</span> <span class="n">np_to_var</span><span class="p">,</span> <span class="n">var_to_np</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="k">import</span> <span class="n">RandomState</span>
<span class="kn">import</span> <span class="nn">torch</span> <span class="k">as</span> <span class="nn">th</span>
<span class="kn">from</span> <span class="nn">braindecode.experiments.monitors</span> <span class="k">import</span> <span class="n">compute_preds_per_trial_for_set</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">RandomState</span><span class="p">((</span><span class="mi">2017</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">30</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i_epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Epoch </span><span class="si">{:d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i_epoch</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train....&quot;</span><span class="p">)</span>
    <span class="c1"># Set model to training mode</span>
    <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">batch_X</span><span class="p">,</span> <span class="n">batch_y</span> <span class="ow">in</span> <span class="n">iterator</span><span class="o">.</span><span class="n">get_batches</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">net_in</span> <span class="o">=</span> <span class="n">np_to_var</span><span class="p">(</span><span class="n">batch_X</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cuda</span><span class="p">:</span>
            <span class="n">net_in</span> <span class="o">=</span> <span class="n">net_in</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
        <span class="n">net_target</span> <span class="o">=</span> <span class="n">np_to_var</span><span class="p">(</span><span class="n">batch_y</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cuda</span><span class="p">:</span>
            <span class="n">net_target</span> <span class="o">=</span> <span class="n">net_target</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
        <span class="c1"># Remove gradients of last backward pass from all parameters</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">net_in</span><span class="p">)</span>
        <span class="c1"># Mean predictions across trial</span>
        <span class="c1"># Note that this will give identical gradients to computing</span>
        <span class="c1"># a per-prediction loss (at least for the combination of log softmax activation</span>
        <span class="c1"># and negative log likelihood loss which we are using here)</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)[:,:,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">net_target</span><span class="p">)</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

    <span class="c1"># Print some statistics each epoch</span>
    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">setname</span><span class="p">,</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="p">((</span><span class="s1">&#39;Train&#39;</span><span class="p">,</span> <span class="n">train_set</span><span class="p">),(</span><span class="s1">&#39;Test&#39;</span><span class="p">,</span> <span class="n">test_set</span><span class="p">)):</span>
        <span class="c1"># Collect all predictions and losses</span>
        <span class="n">all_preds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">all_losses</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">batch_sizes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">batch_X</span><span class="p">,</span> <span class="n">batch_y</span> <span class="ow">in</span> <span class="n">iterator</span><span class="o">.</span><span class="n">get_batches</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="n">net_in</span> <span class="o">=</span> <span class="n">np_to_var</span><span class="p">(</span><span class="n">batch_X</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cuda</span><span class="p">:</span>
                <span class="n">net_in</span> <span class="o">=</span> <span class="n">net_in</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
            <span class="n">net_target</span> <span class="o">=</span> <span class="n">np_to_var</span><span class="p">(</span><span class="n">batch_y</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cuda</span><span class="p">:</span>
                <span class="n">net_target</span> <span class="o">=</span> <span class="n">net_target</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">net_in</span><span class="p">)</span>
            <span class="n">all_preds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var_to_np</span><span class="p">(</span><span class="n">outputs</span><span class="p">))</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)[:,:,</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">net_target</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">var_to_np</span><span class="p">(</span><span class="n">loss</span><span class="p">))</span>
            <span class="n">all_losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>
            <span class="n">batch_sizes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">batch_X</span><span class="p">))</span>
        <span class="c1"># Compute mean per-input loss</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">all_losses</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">batch_sizes</span><span class="p">)</span> <span class="o">/</span>
                       <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">batch_sizes</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:6s}</span><span class="s2"> Loss: </span><span class="si">{:.5f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">setname</span><span class="p">,</span> <span class="n">loss</span><span class="p">))</span>
        <span class="n">preds_per_trial</span> <span class="o">=</span> <span class="n">compute_preds_per_trial_for_set</span><span class="p">(</span><span class="n">all_preds</span><span class="p">,</span>
                                                          <span class="n">input_time_length</span><span class="p">,</span>
                                                          <span class="n">dataset</span><span class="p">)</span>
        <span class="c1"># preds per trial are now trials x classes x timesteps/predictions</span>
        <span class="c1"># Now mean across timesteps for each trial to get per-trial predictions</span>
        <span class="n">meaned_preds_per_trial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">preds_per_trial</span><span class="p">])</span>
        <span class="n">predicted_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">meaned_preds_per_trial</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">accuracy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">predicted_labels</span> <span class="o">==</span> <span class="n">dataset</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:6s}</span><span class="s2"> Accuracy: </span><span class="si">{:.1f}</span><span class="s2">%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">setname</span><span class="p">,</span> <span class="n">accuracy</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 0
Train....
Train  Loss: 0.71860
Train  Accuracy: 52.6%
Test   Loss: 0.71723
Test   Accuracy: 49.3%
Epoch 1
Train....
Train  Loss: 0.66520
Train  Accuracy: 62.8%
Test   Loss: 0.64034
Test   Accuracy: 66.7%
Epoch 2
Train....
Train  Loss: 0.64316
Train  Accuracy: 68.7%
Test   Loss: 0.58749
Test   Accuracy: 79.3%
Epoch 3
Train....
Train  Loss: 0.63189
Train  Accuracy: 70.0%
Test   Loss: 0.57858
Test   Accuracy: 83.6%
Epoch 4
Train....
Train  Loss: 0.63453
Train  Accuracy: 70.1%
Test   Loss: 0.57909
Test   Accuracy: 87.3%
Epoch 5
Train....
Train  Loss: 0.62692
Train  Accuracy: 71.2%
Test   Loss: 0.56124
Test   Accuracy: 85.9%
Epoch 6
Train....
Train  Loss: 0.62656
Train  Accuracy: 68.8%
Test   Loss: 0.55466
Test   Accuracy: 81.7%
Epoch 7
Train....
Train  Loss: 0.62640
Train  Accuracy: 70.8%
Test   Loss: 0.54085
Test   Accuracy: 88.3%
Epoch 8
Train....
Train  Loss: 0.63163
Train  Accuracy: 71.5%
Test   Loss: 0.54154
Test   Accuracy: 86.4%
Epoch 9
Train....
Train  Loss: 0.63460
Train  Accuracy: 70.8%
Test   Loss: 0.54066
Test   Accuracy: 89.2%
Epoch 10
Train....
Train  Loss: 0.63438
Train  Accuracy: 69.9%
Test   Loss: 0.53821
Test   Accuracy: 86.4%
Epoch 11
Train....
Train  Loss: 0.64796
Train  Accuracy: 67.2%
Test   Loss: 0.56196
Test   Accuracy: 77.0%
Epoch 12
Train....
Train  Loss: 0.64398
Train  Accuracy: 68.5%
Test   Loss: 0.54973
Test   Accuracy: 78.9%
Epoch 13
Train....
Train  Loss: 0.64609
Train  Accuracy: 68.9%
Test   Loss: 0.55409
Test   Accuracy: 79.3%
Epoch 14
Train....
Train  Loss: 0.65195
Train  Accuracy: 68.7%
Test   Loss: 0.56381
Test   Accuracy: 79.8%
Epoch 15
Train....
Train  Loss: 0.63691
Train  Accuracy: 69.6%
Test   Loss: 0.55206
Test   Accuracy: 81.7%
Epoch 16
Train....
Train  Loss: 0.65735
Train  Accuracy: 67.5%
Test   Loss: 0.58762
Test   Accuracy: 76.1%
Epoch 17
Train....
Train  Loss: 0.63858
Train  Accuracy: 69.7%
Test   Loss: 0.56295
Test   Accuracy: 80.3%
Epoch 18
Train....
Train  Loss: 0.62446
Train  Accuracy: 70.8%
Test   Loss: 0.54655
Test   Accuracy: 83.1%
Epoch 19
Train....
Train  Loss: 0.62495
Train  Accuracy: 70.5%
Test   Loss: 0.54267
Test   Accuracy: 85.0%
</pre></div></div>
</div>
</div>
<div class="section" id="Compute-amplitude-perturbation---prediction-change-correlation">
<h2>Compute amplitude perturbation - prediction change correlation<a class="headerlink" href="#Compute-amplitude-perturbation---prediction-change-correlation" title="Permalink to this headline">¶</a></h2>
<p>First collect all batches and concatenate them into one array of
examples:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">train_batches</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">iterator</span><span class="o">.</span><span class="n">get_batches</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="n">train_X_batches</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">train_batches</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Next, create a prediction function that that wraps the model prediction
function and returns the predictions as numpy arrays.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">();</span>
<span class="n">pred_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">var_to_np</span><span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">np_to_var</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">cuda</span><span class="p">()),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)[:,:,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Setup logging and compute the correlations!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.visualization.perturbation</span> <span class="k">import</span> <span class="n">compute_amplitude_prediction_correlations</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> </span><span class="si">%(levelname)s</span><span class="s1"> : </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
                     <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>

<span class="n">amp_pred_corrs</span> <span class="o">=</span> <span class="n">compute_amplitude_prediction_correlations</span><span class="p">(</span><span class="n">pred_fn</span><span class="p">,</span> <span class="n">train_X_batches</span><span class="p">,</span> <span class="n">n_iterations</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                                         <span class="n">batch_size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2017-07-10 12:39:02,918 INFO : Compute original predictions...
2017-07-10 12:39:11,031 INFO : Iteration 0...
2017-07-10 12:39:11,032 INFO : Sample perturbation...
2017-07-10 12:39:14,606 INFO : Compute new amplitudes...
2017-07-10 12:39:15,203 INFO : Compute new  complex inputs...
2017-07-10 12:39:21,443 INFO : Compute new real inputs...
2017-07-10 12:39:24,534 INFO : Compute new predictions...
2017-07-10 12:39:25,556 INFO : Compute correlation...
2017-07-10 12:39:26,362 INFO : Iteration 1...
2017-07-10 12:39:26,363 INFO : Sample perturbation...
2017-07-10 12:39:29,938 INFO : Compute new amplitudes...
2017-07-10 12:39:30,535 INFO : Compute new  complex inputs...
2017-07-10 12:39:36,784 INFO : Compute new real inputs...
2017-07-10 12:39:39,883 INFO : Compute new predictions...
2017-07-10 12:39:40,881 INFO : Compute correlation...
2017-07-10 12:39:41,688 INFO : Iteration 2...
2017-07-10 12:39:41,689 INFO : Sample perturbation...
2017-07-10 12:39:45,264 INFO : Compute new amplitudes...
2017-07-10 12:39:45,861 INFO : Compute new  complex inputs...
2017-07-10 12:39:52,109 INFO : Compute new real inputs...
2017-07-10 12:39:55,204 INFO : Compute new predictions...
2017-07-10 12:39:56,202 INFO : Compute correlation...
2017-07-10 12:39:57,008 INFO : Iteration 3...
2017-07-10 12:39:57,009 INFO : Sample perturbation...
2017-07-10 12:40:00,586 INFO : Compute new amplitudes...
2017-07-10 12:40:01,186 INFO : Compute new  complex inputs...
2017-07-10 12:40:07,436 INFO : Compute new real inputs...
2017-07-10 12:40:10,533 INFO : Compute new predictions...
2017-07-10 12:40:11,561 INFO : Compute correlation...
2017-07-10 12:40:12,369 INFO : Iteration 4...
2017-07-10 12:40:12,369 INFO : Sample perturbation...
2017-07-10 12:40:15,947 INFO : Compute new amplitudes...
2017-07-10 12:40:16,543 INFO : Compute new  complex inputs...
2017-07-10 12:40:22,792 INFO : Compute new real inputs...
2017-07-10 12:40:25,889 INFO : Compute new predictions...
2017-07-10 12:40:26,887 INFO : Compute correlation...
2017-07-10 12:40:27,695 INFO : Iteration 5...
2017-07-10 12:40:27,696 INFO : Sample perturbation...
2017-07-10 12:40:31,274 INFO : Compute new amplitudes...
2017-07-10 12:40:31,872 INFO : Compute new  complex inputs...
2017-07-10 12:40:38,119 INFO : Compute new real inputs...
2017-07-10 12:40:41,219 INFO : Compute new predictions...
2017-07-10 12:40:42,217 INFO : Compute correlation...
2017-07-10 12:40:43,026 INFO : Iteration 6...
2017-07-10 12:40:43,027 INFO : Sample perturbation...
2017-07-10 12:40:46,606 INFO : Compute new amplitudes...
2017-07-10 12:40:47,203 INFO : Compute new  complex inputs...
2017-07-10 12:40:53,464 INFO : Compute new real inputs...
2017-07-10 12:40:56,559 INFO : Compute new predictions...
2017-07-10 12:40:57,576 INFO : Compute correlation...
2017-07-10 12:40:58,383 INFO : Iteration 7...
2017-07-10 12:40:58,384 INFO : Sample perturbation...
2017-07-10 12:41:01,962 INFO : Compute new amplitudes...
2017-07-10 12:41:02,557 INFO : Compute new  complex inputs...
2017-07-10 12:41:08,815 INFO : Compute new real inputs...
2017-07-10 12:41:11,911 INFO : Compute new predictions...
2017-07-10 12:41:12,912 INFO : Compute correlation...
2017-07-10 12:41:13,720 INFO : Iteration 8...
2017-07-10 12:41:13,721 INFO : Sample perturbation...
2017-07-10 12:41:17,301 INFO : Compute new amplitudes...
2017-07-10 12:41:17,897 INFO : Compute new  complex inputs...
2017-07-10 12:41:24,148 INFO : Compute new real inputs...
2017-07-10 12:41:27,242 INFO : Compute new predictions...
2017-07-10 12:41:28,244 INFO : Compute correlation...
2017-07-10 12:41:29,050 INFO : Iteration 9...
2017-07-10 12:41:29,050 INFO : Sample perturbation...
2017-07-10 12:41:32,628 INFO : Compute new amplitudes...
2017-07-10 12:41:33,227 INFO : Compute new  complex inputs...
2017-07-10 12:41:39,488 INFO : Compute new real inputs...
2017-07-10 12:41:42,585 INFO : Compute new predictions...
2017-07-10 12:41:43,608 INFO : Compute correlation...
2017-07-10 12:41:44,412 INFO : Iteration 10...
2017-07-10 12:41:44,413 INFO : Sample perturbation...
2017-07-10 12:41:47,992 INFO : Compute new amplitudes...
2017-07-10 12:41:48,588 INFO : Compute new  complex inputs...
2017-07-10 12:41:54,835 INFO : Compute new real inputs...
2017-07-10 12:41:57,931 INFO : Compute new predictions...
2017-07-10 12:41:58,930 INFO : Compute correlation...
2017-07-10 12:41:59,736 INFO : Iteration 11...
2017-07-10 12:41:59,737 INFO : Sample perturbation...
2017-07-10 12:42:03,314 INFO : Compute new amplitudes...
2017-07-10 12:42:03,912 INFO : Compute new  complex inputs...
2017-07-10 12:42:10,168 INFO : Compute new real inputs...
2017-07-10 12:42:13,265 INFO : Compute new predictions...
2017-07-10 12:42:14,264 INFO : Compute correlation...
</pre></div></div>
</div>
</div>
<div class="section" id="Plot-correlations">
<h2>Plot correlations<a class="headerlink" href="#Plot-correlations" title="Permalink to this headline">¶</a></h2>
<p>Compute the mean correlations across iterations.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">mean_corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">amp_pred_corrs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Pick out one frequency range and mean correlations within that frequency
range to make a scalp plot. Here we use the alpha frequency range.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>

<span></span><span class="n">fs</span> <span class="o">=</span> <span class="n">epoched</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;sfreq&#39;</span><span class="p">]</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">train_X_batches</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">d</span><span class="o">=</span><span class="mf">1.0</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
<span class="n">start_freq</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">stop_freq</span> <span class="o">=</span> <span class="mi">14</span>

<span class="n">i_start</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span><span class="n">start_freq</span><span class="p">)</span>
<span class="n">i_stop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">stop_freq</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

<span class="n">freq_corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mean_corr</span><span class="p">[:,</span><span class="n">i_start</span><span class="p">:</span><span class="n">i_stop</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now get approximate positions of the channels in the 10-20 system.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.datasets.sensor_positions</span> <span class="k">import</span> <span class="n">get_channelpos</span><span class="p">,</span> <span class="n">CHANNEL_10_20_APPROX</span>

<span class="n">ch_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">epoched</span><span class="o">.</span><span class="n">ch_names</span><span class="p">]</span>
<span class="n">positions</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_channelpos</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">CHANNEL_10_20_APPROX</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">ch_names</span><span class="p">]</span>
<span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Plot-with-mne">
<h2>Plot with mne<a class="headerlink" href="#Plot-with-mne" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">cm</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">max_abs_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">freq_corr</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">class_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Left Hand&#39;</span><span class="p">,</span> <span class="s1">&#39;Right Hand&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i_class</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i_class</span><span class="p">]</span>
    <span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_topomap</span><span class="p">(</span><span class="n">freq_corr</span><span class="p">[:,</span><span class="n">i_class</span><span class="p">],</span> <span class="n">positions</span><span class="p">,</span>
                     <span class="n">vmin</span><span class="o">=-</span><span class="n">max_abs_val</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">max_abs_val</span><span class="p">,</span> <span class="n">contours</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">class_names</span><span class="p">[</span><span class="n">i_class</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_visualization_Perturbation_26_0.png" src="../../_images/notebooks_visualization_Perturbation_26_0.png" />
</div>
</div>
</div>
<div class="section" id="Plot-with-Braindecode">
<h2>Plot with Braindecode<a class="headerlink" href="#Plot-with-Braindecode" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.visualization.plot</span> <span class="k">import</span> <span class="n">ax_scalp</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">class_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Left Hand&#39;</span><span class="p">,</span> <span class="s1">&#39;Right Hand&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i_class</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i_class</span><span class="p">]</span>
    <span class="n">ax_scalp</span><span class="p">(</span><span class="n">freq_corr</span><span class="p">[:,</span><span class="n">i_class</span><span class="p">],</span> <span class="n">ch_names</span><span class="p">,</span> <span class="n">chan_pos_list</span><span class="o">=</span><span class="n">CHANNEL_10_20_APPROX</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=-</span><span class="n">max_abs_val</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">max_abs_val</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">class_names</span><span class="p">[</span><span class="n">i_class</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_visualization_Perturbation_28_0.png" src="../../_images/notebooks_visualization_Perturbation_28_0.png" />
</div>
</div>
<p>From these plots we can see the ConvNet clearly learned to use the
lateralized response in the alpha band. Note that the positive
correlations for the left hand on the left side do not imply an increase
of alpha activity for the left hand in the data, see <a class="reference external" href="https://arxiv.org/abs/1703.05051">Deep learning with
convolutional neural networks for brain mapping and decoding of
movement-related information from the human
EEG</a> Result 12 for some notes on
interpretability.</p>
</div>
<div class="section" id="Dataset-References">
<h2>Dataset References<a class="headerlink" href="#Dataset-References" title="Permalink to this headline">¶</a></h2>
<p>This dataset was created and contributed to PhysioNet by the developers
of the <a class="reference external" href="http://www.schalklab.org/research/bci2000">BCI2000</a>
instrumentation system, which they used in making these recordings. The
system is described in:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Schalk</span><span class="p">,</span> <span class="n">G</span><span class="o">.</span><span class="p">,</span> <span class="n">McFarland</span><span class="p">,</span> <span class="n">D</span><span class="o">.</span><span class="n">J</span><span class="o">.</span><span class="p">,</span> <span class="n">Hinterberger</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="p">,</span> <span class="n">Birbaumer</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="p">,</span> <span class="n">Wolpaw</span><span class="p">,</span> <span class="n">J</span><span class="o">.</span><span class="n">R</span><span class="o">.</span> <span class="p">(</span><span class="mi">2004</span><span class="p">)</span> <span class="n">BCI2000</span><span class="p">:</span> <span class="n">A</span> <span class="n">General</span><span class="o">-</span><span class="n">Purpose</span> <span class="n">Brain</span><span class="o">-</span><span class="n">Computer</span> <span class="n">Interface</span> <span class="p">(</span><span class="n">BCI</span><span class="p">)</span> <span class="n">System</span><span class="o">.</span> <span class="n">IEEE</span> <span class="n">TBME</span> <span class="mi">51</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span><span class="mi">1034</span><span class="o">-</span><span class="mf">1043.</span>
</pre></div>
</div>
<p><a class="reference external" href="https://physionet.org/physiobank/">PhysioBank</a> is a large and
growing archive of well-characterized digital recordings of physiologic
signals and related data for use by the biomedical research community
and further described in:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Goldberger</span> <span class="n">AL</span><span class="p">,</span> <span class="n">Amaral</span> <span class="n">LAN</span><span class="p">,</span> <span class="n">Glass</span> <span class="n">L</span><span class="p">,</span> <span class="n">Hausdorff</span> <span class="n">JM</span><span class="p">,</span> <span class="n">Ivanov</span> <span class="n">PCh</span><span class="p">,</span> <span class="n">Mark</span> <span class="n">RG</span><span class="p">,</span> <span class="n">Mietus</span> <span class="n">JE</span><span class="p">,</span> <span class="n">Moody</span> <span class="n">GB</span><span class="p">,</span> <span class="n">Peng</span> <span class="n">C</span><span class="o">-</span><span class="n">K</span><span class="p">,</span> <span class="n">Stanley</span> <span class="n">HE</span><span class="o">.</span> <span class="p">(</span><span class="mi">2000</span><span class="p">)</span> <span class="n">PhysioBank</span><span class="p">,</span> <span class="n">PhysioToolkit</span><span class="p">,</span> <span class="ow">and</span> <span class="n">PhysioNet</span><span class="p">:</span> <span class="n">Components</span> <span class="n">of</span> <span class="n">a</span> <span class="n">New</span> <span class="n">Research</span> <span class="n">Resource</span> <span class="k">for</span> <span class="n">Complex</span> <span class="n">Physiologic</span> <span class="n">Signals</span><span class="o">.</span> <span class="n">Circulation</span> <span class="mi">101</span><span class="p">(</span><span class="mi">23</span><span class="p">):</span><span class="n">e215</span><span class="o">-</span><span class="n">e220</span><span class="o">.</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../source/braindecode.datautil.html" class="btn btn-neutral float-right" title="braindecode.datautil package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../Experiment_Class.html" class="btn btn-neutral" title="Using the Experiment Class" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Robin Tibor Schirrmeister.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.1.6',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>