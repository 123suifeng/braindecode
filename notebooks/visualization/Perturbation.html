

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Amplitude Perturbation Visualization &mdash; Braindecode 0.4.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Braindecode 0.4.0 documentation" href="../../index.html"/>
        <link rel="next" title="braindecode.datautil package" href="../../source/braindecode.datautil.html"/>
        <link rel="prev" title="Cropped Manual Training Loop" href="../Cropped_Manual_Training_Loop.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Braindecode
          

          
          </a>

          
            
            
              <div class="version">
                0.4.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Trialwise_Decoding.html">Trialwise Decoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Cropped_Decoding.html">Cropped Decoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Trialwise_Manual_Training_Loop.html">Trialwise Manual Training Loop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Cropped_Manual_Training_Loop.html">Cropped Manual Training Loop</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Amplitude Perturbation Visualization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Enable-logging">Enable logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Load-data">Load data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Create-the-model">Create the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Run-the-training">Run the training</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Compute-correlation:-amplitude-perturbation---prediction-change">Compute correlation: amplitude perturbation - prediction change</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Plot-correlations">Plot correlations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Plot-with-MNE">Plot with MNE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Plot-with-Braindecode">Plot with Braindecode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Dataset-references">Dataset references</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../source/braindecode.datautil.html">braindecode.datautil package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../source/braindecode.experiments.html">braindecode.experiments package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../source/braindecode.mne_ext.html">braindecode.mne_ext package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../source/braindecode.models.html">braindecode.models package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../source/braindecode.torch_ext.html">braindecode.torch_ext package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../source/braindecode.visualization.html">braindecode.visualization package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Braindecode</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Amplitude Perturbation Visualization</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/notebooks/visualization/Perturbation.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Amplitude-Perturbation-Visualization">
<h1>Amplitude Perturbation Visualization<a class="headerlink" href="#Amplitude-Perturbation-Visualization" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial, we show how to use perturbations of the input
amplitudes to learn something about the trained convolutional networks.
For more background, see <a class="reference external" href="https://arxiv.org/abs/1703.05051">Deep learning with convolutional neural
networks for EEG decoding and
visualization</a>, Section A.5.2.</p>
<p>First we will do some cross-subject decoding, again using the
<a class="reference external" href="https://www.physionet.org/physiobank/database/eegmmidb/">Physiobank EEG Motor Movement/Imagery
Dataset</a>,
this time to decode imagined left hand vs. imagined right hand movement.</p>
<div class="admonition warning">
This tutorial might be very slow if you are not using a GPU.</div>
<div class="section" id="Enable-logging">
<h2>Enable logging<a class="headerlink" href="#Enable-logging" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">importlib</span>
<span class="n">importlib</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">logging</span><span class="p">)</span> <span class="c1"># see https://stackoverflow.com/a/21475297/1469195</span>
<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>
<span class="n">log</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="s1">&#39;INFO&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> </span><span class="si">%(levelname)s</span><span class="s1"> : </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
                     <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Load-data">
<h2>Load data<a class="headerlink" href="#Load-data" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">mne.io</span> <span class="k">import</span> <span class="n">concatenate_raws</span>
<span class="kn">from</span> <span class="nn">braindecode.datautil.signal_target</span> <span class="k">import</span> <span class="n">SignalAndTarget</span>

<span class="c1"># First 50 subjects as train</span>
<span class="n">physionet_paths</span> <span class="o">=</span> <span class="p">[</span> <span class="n">mne</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">eegbci</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">sub_id</span><span class="p">,[</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">,])</span> <span class="k">for</span> <span class="n">sub_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">51</span><span class="p">)]</span>
<span class="n">physionet_paths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">physionet_paths</span><span class="p">)</span>
<span class="n">parts</span> <span class="o">=</span> <span class="p">[</span><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_edf</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
         <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">physionet_paths</span><span class="p">]</span>

<span class="n">raw</span> <span class="o">=</span> <span class="n">concatenate_raws</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span>

<span class="n">picks</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">exclude</span><span class="o">=</span><span class="s1">&#39;bads&#39;</span><span class="p">)</span>

<span class="n">events</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">find_events</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">shortest_event</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;STI 014&#39;</span><span class="p">)</span>

<span class="c1"># Read epochs (train will be done only between 1 and 2s)</span>
<span class="c1"># Testing will be done with a running classifier</span>
<span class="n">epoched</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">hands</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">feet</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span> <span class="n">tmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">4.1</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">picks</span><span class="p">,</span>
                <span class="n">baseline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># 51-55 as validation subjects</span>
<span class="n">physionet_paths_valid</span> <span class="o">=</span> <span class="p">[</span><span class="n">mne</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">eegbci</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">sub_id</span><span class="p">,[</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">,])</span> <span class="k">for</span> <span class="n">sub_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">51</span><span class="p">,</span><span class="mi">56</span><span class="p">)]</span>
<span class="n">physionet_paths_valid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">physionet_paths_valid</span><span class="p">)</span>
<span class="n">parts_valid</span> <span class="o">=</span> <span class="p">[</span><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_edf</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
         <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">physionet_paths_valid</span><span class="p">]</span>
<span class="n">raw_valid</span> <span class="o">=</span> <span class="n">concatenate_raws</span><span class="p">(</span><span class="n">parts_valid</span><span class="p">)</span>

<span class="n">picks_valid</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">raw_valid</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">exclude</span><span class="o">=</span><span class="s1">&#39;bads&#39;</span><span class="p">)</span>

<span class="n">events_valid</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">find_events</span><span class="p">(</span><span class="n">raw_valid</span><span class="p">,</span> <span class="n">shortest_event</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;STI 014&#39;</span><span class="p">)</span>

<span class="c1"># Read epochs (train will be done only between 1 and 2s)</span>
<span class="c1"># Testing will be done with a running classifier</span>
<span class="n">epoched_valid</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span><span class="p">(</span><span class="n">raw_valid</span><span class="p">,</span> <span class="n">events_valid</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">hands</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">feet</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span> <span class="n">tmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">4.1</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">picks_valid</span><span class="p">,</span>
                <span class="n">baseline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">train_X</span> <span class="o">=</span> <span class="p">(</span><span class="n">epoched</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">train_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">epoched</span><span class="o">.</span><span class="n">events</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span> <span class="c1">#2,3 -&gt; 0,1</span>
<span class="n">valid_X</span> <span class="o">=</span> <span class="p">(</span><span class="n">epoched_valid</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">valid_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">epoched_valid</span><span class="o">.</span><span class="n">events</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span> <span class="c1">#2,3 -&gt; 0,1</span>
<span class="n">train_set</span> <span class="o">=</span> <span class="n">SignalAndTarget</span><span class="p">(</span><span class="n">train_X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">train_y</span><span class="p">)</span>
<span class="n">valid_set</span> <span class="o">=</span> <span class="n">SignalAndTarget</span><span class="p">(</span><span class="n">valid_X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">valid_y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Create-the-model">
<h2>Create the model<a class="headerlink" href="#Create-the-model" title="Permalink to this headline">¶</a></h2>
<p>We use the deep ConvNet from <a class="reference external" href="https://arxiv.org/abs/1703.05051">Deep learning with convolutional neural
networks for EEG decoding and
visualization</a> (Section 2.4.2).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.models.deep4</span> <span class="k">import</span> <span class="n">Deep4Net</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="k">import</span> <span class="n">nn</span>
<span class="kn">from</span> <span class="nn">braindecode.torch_ext.util</span> <span class="k">import</span> <span class="n">set_random_seeds</span>
<span class="kn">from</span> <span class="nn">braindecode.models.util</span> <span class="k">import</span> <span class="n">to_dense_prediction_model</span>

<span class="c1"># Set if you want to use GPU</span>
<span class="c1"># You can also use torch.cuda.is_available() to determine if cuda is available on your machine.</span>
<span class="n">cuda</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">set_random_seeds</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">20170629</span><span class="p">,</span> <span class="n">cuda</span><span class="o">=</span><span class="n">cuda</span><span class="p">)</span>

<span class="c1"># This will determine how many crops are processed in parallel</span>
<span class="n">input_time_length</span> <span class="o">=</span> <span class="mi">450</span>
<span class="c1"># final_conv_length determines the size of the receptive field of the ConvNet</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Deep4Net</span><span class="p">(</span><span class="n">in_chans</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">n_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">input_time_length</span><span class="o">=</span><span class="n">input_time_length</span><span class="p">,</span>
                 <span class="n">filter_length_3</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">filter_length_4</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                 <span class="n">pool_time_stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                 <span class="n">stride_before_pool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">final_conv_length</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">if</span> <span class="n">cuda</span><span class="p">:</span>
    <span class="n">model</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.torch_ext.optimizers</span> <span class="k">import</span> <span class="n">AdamW</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">AdamW</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mi">1</span><span class="o">*</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">weight_decay</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="mf">0.001</span><span class="p">)</span> <span class="c1"># these are good values for the deep model</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>  <span class="n">iterator_seed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cropped</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Run-the-training">
<h2>Run the training<a class="headerlink" href="#Run-the-training" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">input_time_length</span> <span class="o">=</span> <span class="mi">450</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_set</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">train_set</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">scheduler</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
          <span class="n">input_time_length</span><span class="o">=</span><span class="n">input_time_length</span><span class="p">,</span>
         <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">valid_set</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">valid_set</span><span class="o">.</span><span class="n">y</span><span class="p">),)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2018-08-08 12:15:44,713 INFO : Run until first stop...
2018-08-08 12:15:47,093 INFO : Time only for training updates: 1.97s
2018-08-08 12:15:48,635 INFO : Epoch 0
2018-08-08 12:15:48,636 INFO : train_loss                0.67985
2018-08-08 12:15:48,636 INFO : valid_loss                0.61967
2018-08-08 12:15:48,639 INFO : train_misclass            0.41846
2018-08-08 12:15:48,641 INFO : valid_misclass            0.30986
2018-08-08 12:15:48,644 INFO : runtime                   0.00000
2018-08-08 12:15:48,645 INFO :
2018-08-08 12:15:50,994 INFO : Time only for training updates: 1.93s
2018-08-08 12:15:52,434 INFO : Epoch 1
2018-08-08 12:15:52,436 INFO : train_loss                0.65534
2018-08-08 12:15:52,437 INFO : valid_loss                0.57160
2018-08-08 12:15:52,438 INFO : train_misclass            0.36551
2018-08-08 12:15:52,439 INFO : valid_misclass            0.23944
2018-08-08 12:15:52,441 INFO : runtime                   3.90013
2018-08-08 12:15:52,442 INFO :
2018-08-08 12:15:54,794 INFO : Time only for training updates: 1.93s
2018-08-08 12:15:56,235 INFO : Epoch 2
2018-08-08 12:15:56,236 INFO : train_loss                0.63754
2018-08-08 12:15:56,237 INFO : valid_loss                0.55280
2018-08-08 12:15:56,239 INFO : train_misclass            0.30647
2018-08-08 12:15:56,240 INFO : valid_misclass            0.14554
2018-08-08 12:15:56,241 INFO : runtime                   3.80040
2018-08-08 12:15:56,243 INFO :
2018-08-08 12:15:58,594 INFO : Time only for training updates: 1.93s
2018-08-08 12:16:00,033 INFO : Epoch 3
2018-08-08 12:16:00,034 INFO : train_loss                0.62171
2018-08-08 12:16:00,035 INFO : valid_loss                0.53479
2018-08-08 12:16:00,038 INFO : train_misclass            0.29475
2018-08-08 12:16:00,040 INFO : valid_misclass            0.15493
2018-08-08 12:16:00,042 INFO : runtime                   3.80015
2018-08-08 12:16:00,043 INFO :
2018-08-08 12:16:02,398 INFO : Time only for training updates: 1.93s
2018-08-08 12:16:03,834 INFO : Epoch 4
2018-08-08 12:16:03,835 INFO : train_loss                0.61266
2018-08-08 12:16:03,836 INFO : valid_loss                0.51626
2018-08-08 12:16:03,838 INFO : train_misclass            0.28444
2018-08-08 12:16:03,840 INFO : valid_misclass            0.15493
2018-08-08 12:16:03,843 INFO : runtime                   3.80434
2018-08-08 12:16:03,843 INFO :
2018-08-08 12:16:06,247 INFO : Time only for training updates: 1.98s
2018-08-08 12:16:07,686 INFO : Epoch 5
2018-08-08 12:16:07,687 INFO : train_loss                0.63827
2018-08-08 12:16:07,688 INFO : valid_loss                0.56435
2018-08-08 12:16:07,690 INFO : train_misclass            0.31912
2018-08-08 12:16:07,691 INFO : valid_misclass            0.22066
2018-08-08 12:16:07,692 INFO : runtime                   3.84877
2018-08-08 12:16:07,694 INFO :
2018-08-08 12:16:10,049 INFO : Time only for training updates: 1.94s
2018-08-08 12:16:11,494 INFO : Epoch 6
2018-08-08 12:16:11,495 INFO : train_loss                0.61253
2018-08-08 12:16:11,496 INFO : valid_loss                0.53119
2018-08-08 12:16:11,498 INFO : train_misclass            0.28725
2018-08-08 12:16:11,499 INFO : valid_misclass            0.12676
2018-08-08 12:16:11,500 INFO : runtime                   3.80202
2018-08-08 12:16:11,501 INFO :
2018-08-08 12:16:13,857 INFO : Time only for training updates: 1.94s
2018-08-08 12:16:15,309 INFO : Epoch 7
2018-08-08 12:16:15,310 INFO : train_loss                0.60483
2018-08-08 12:16:15,311 INFO : valid_loss                0.51952
2018-08-08 12:16:15,313 INFO : train_misclass            0.27366
2018-08-08 12:16:15,314 INFO : valid_misclass            0.14085
2018-08-08 12:16:15,315 INFO : runtime                   3.80774
2018-08-08 12:16:15,317 INFO :
2018-08-08 12:16:17,680 INFO : Time only for training updates: 1.94s
2018-08-08 12:16:19,116 INFO : Epoch 8
2018-08-08 12:16:19,117 INFO : train_loss                0.60557
2018-08-08 12:16:19,118 INFO : valid_loss                0.52076
2018-08-08 12:16:19,120 INFO : train_misclass            0.28444
2018-08-08 12:16:19,123 INFO : valid_misclass            0.14554
2018-08-08 12:16:19,124 INFO : runtime                   3.82277
2018-08-08 12:16:19,127 INFO :
2018-08-08 12:16:21,484 INFO : Time only for training updates: 1.94s
2018-08-08 12:16:22,916 INFO : Epoch 9
2018-08-08 12:16:22,917 INFO : train_loss                0.61126
2018-08-08 12:16:22,919 INFO : valid_loss                0.51278
2018-08-08 12:16:22,920 INFO : train_misclass            0.29100
2018-08-08 12:16:22,921 INFO : valid_misclass            0.14085
2018-08-08 12:16:22,923 INFO : runtime                   3.80450
2018-08-08 12:16:22,924 INFO :
2018-08-08 12:16:25,281 INFO : Time only for training updates: 1.94s
2018-08-08 12:16:26,714 INFO : Epoch 10
2018-08-08 12:16:26,715 INFO : train_loss                0.59270
2018-08-08 12:16:26,717 INFO : valid_loss                0.49652
2018-08-08 12:16:26,718 INFO : train_misclass            0.28210
2018-08-08 12:16:26,719 INFO : valid_misclass            0.13146
2018-08-08 12:16:26,721 INFO : runtime                   3.79689
2018-08-08 12:16:26,722 INFO :
2018-08-08 12:16:29,080 INFO : Time only for training updates: 1.94s
2018-08-08 12:16:30,512 INFO : Epoch 11
2018-08-08 12:16:30,513 INFO : train_loss                0.60264
2018-08-08 12:16:30,515 INFO : valid_loss                0.52942
2018-08-08 12:16:30,516 INFO : train_misclass            0.27366
2018-08-08 12:16:30,517 INFO : valid_misclass            0.15493
2018-08-08 12:16:30,519 INFO : runtime                   3.79896
2018-08-08 12:16:30,520 INFO :
2018-08-08 12:16:32,878 INFO : Time only for training updates: 1.94s
2018-08-08 12:16:34,317 INFO : Epoch 12
2018-08-08 12:16:34,318 INFO : train_loss                0.60054
2018-08-08 12:16:34,319 INFO : valid_loss                0.47185
2018-08-08 12:16:34,322 INFO : train_misclass            0.26523
2018-08-08 12:16:34,324 INFO : valid_misclass            0.12676
2018-08-08 12:16:34,327 INFO : runtime                   3.79843
2018-08-08 12:16:34,327 INFO :
2018-08-08 12:16:36,684 INFO : Time only for training updates: 1.93s
2018-08-08 12:16:38,128 INFO : Epoch 13
2018-08-08 12:16:38,129 INFO : train_loss                0.58812
2018-08-08 12:16:38,130 INFO : valid_loss                0.47662
2018-08-08 12:16:38,132 INFO : train_misclass            0.26148
2018-08-08 12:16:38,135 INFO : valid_misclass            0.12676
2018-08-08 12:16:38,135 INFO : runtime                   3.80523
2018-08-08 12:16:38,136 INFO :
2018-08-08 12:16:40,500 INFO : Time only for training updates: 1.94s
2018-08-08 12:16:41,996 INFO : Epoch 14
2018-08-08 12:16:41,997 INFO : train_loss                0.58033
2018-08-08 12:16:41,998 INFO : valid_loss                0.50056
2018-08-08 12:16:42,000 INFO : train_misclass            0.24695
2018-08-08 12:16:42,001 INFO : valid_misclass            0.13615
2018-08-08 12:16:42,002 INFO : runtime                   3.81588
2018-08-08 12:16:42,003 INFO :
2018-08-08 12:16:44,363 INFO : Time only for training updates: 1.94s
2018-08-08 12:16:45,798 INFO : Epoch 15
2018-08-08 12:16:45,799 INFO : train_loss                0.57061
2018-08-08 12:16:45,800 INFO : valid_loss                0.47636
2018-08-08 12:16:45,802 INFO : train_misclass            0.24133
2018-08-08 12:16:45,803 INFO : valid_misclass            0.11268
2018-08-08 12:16:45,804 INFO : runtime                   3.86312
2018-08-08 12:16:45,805 INFO :
2018-08-08 12:16:48,166 INFO : Time only for training updates: 1.94s
2018-08-08 12:16:49,596 INFO : Epoch 16
2018-08-08 12:16:49,598 INFO : train_loss                0.58647
2018-08-08 12:16:49,599 INFO : valid_loss                0.49233
2018-08-08 12:16:49,600 INFO : train_misclass            0.25070
2018-08-08 12:16:49,602 INFO : valid_misclass            0.15962
2018-08-08 12:16:49,603 INFO : runtime                   3.80350
2018-08-08 12:16:49,604 INFO :
2018-08-08 12:16:51,966 INFO : Time only for training updates: 1.94s
2018-08-08 12:16:53,400 INFO : Epoch 17
2018-08-08 12:16:53,401 INFO : train_loss                0.56631
2018-08-08 12:16:53,402 INFO : valid_loss                0.46380
2018-08-08 12:16:53,403 INFO : train_misclass            0.22446
2018-08-08 12:16:53,405 INFO : valid_misclass            0.10329
2018-08-08 12:16:53,406 INFO : runtime                   3.79971
2018-08-08 12:16:53,407 INFO :
2018-08-08 12:16:55,766 INFO : Time only for training updates: 1.94s
2018-08-08 12:16:57,195 INFO : Epoch 18
2018-08-08 12:16:57,196 INFO : train_loss                0.55825
2018-08-08 12:16:57,196 INFO : valid_loss                0.48095
2018-08-08 12:16:57,199 INFO : train_misclass            0.23477
2018-08-08 12:16:57,201 INFO : valid_misclass            0.11268
2018-08-08 12:16:57,203 INFO : runtime                   3.80030
2018-08-08 12:16:57,206 INFO :
2018-08-08 12:16:59,572 INFO : Time only for training updates: 1.94s
2018-08-08 12:17:00,985 INFO : Epoch 19
2018-08-08 12:17:00,986 INFO : train_loss                0.55626
2018-08-08 12:17:00,987 INFO : valid_loss                0.47492
2018-08-08 12:17:00,988 INFO : train_misclass            0.22680
2018-08-08 12:17:00,989 INFO : valid_misclass            0.11737
2018-08-08 12:17:00,991 INFO : runtime                   3.80620
2018-08-08 12:17:00,992 INFO :
2018-08-08 12:17:03,357 INFO : Time only for training updates: 1.94s
2018-08-08 12:17:04,755 INFO : Epoch 20
2018-08-08 12:17:04,756 INFO : train_loss                0.55149
2018-08-08 12:17:04,757 INFO : valid_loss                0.47625
2018-08-08 12:17:04,758 INFO : train_misclass            0.20572
2018-08-08 12:17:04,759 INFO : valid_misclass            0.09390
2018-08-08 12:17:04,761 INFO : runtime                   3.78421
2018-08-08 12:17:04,762 INFO :
2018-08-08 12:17:07,166 INFO : Time only for training updates: 1.98s
2018-08-08 12:17:08,573 INFO : Epoch 21
2018-08-08 12:17:08,574 INFO : train_loss                0.54888
2018-08-08 12:17:08,575 INFO : valid_loss                0.47307
2018-08-08 12:17:08,577 INFO : train_misclass            0.21837
2018-08-08 12:17:08,578 INFO : valid_misclass            0.10798
2018-08-08 12:17:08,579 INFO : runtime                   3.80945
2018-08-08 12:17:08,580 INFO :
2018-08-08 12:17:10,939 INFO : Time only for training updates: 1.94s
2018-08-08 12:17:12,341 INFO : Epoch 22
2018-08-08 12:17:12,342 INFO : train_loss                0.53812
2018-08-08 12:17:12,343 INFO : valid_loss                0.46251
2018-08-08 12:17:12,344 INFO : train_misclass            0.21087
2018-08-08 12:17:12,346 INFO : valid_misclass            0.10329
2018-08-08 12:17:12,347 INFO : runtime                   3.77332
2018-08-08 12:17:12,348 INFO :
2018-08-08 12:17:14,709 INFO : Time only for training updates: 1.94s
2018-08-08 12:17:16,106 INFO : Epoch 23
2018-08-08 12:17:16,107 INFO : train_loss                0.53869
2018-08-08 12:17:16,108 INFO : valid_loss                0.47270
2018-08-08 12:17:16,109 INFO : train_misclass            0.21462
2018-08-08 12:17:16,111 INFO : valid_misclass            0.11268
2018-08-08 12:17:16,112 INFO : runtime                   3.76946
2018-08-08 12:17:16,113 INFO :
2018-08-08 12:17:18,477 INFO : Time only for training updates: 1.94s
2018-08-08 12:17:19,916 INFO : Epoch 24
2018-08-08 12:17:19,918 INFO : train_loss                0.53126
2018-08-08 12:17:19,919 INFO : valid_loss                0.47057
2018-08-08 12:17:19,920 INFO : train_misclass            0.20572
2018-08-08 12:17:19,921 INFO : valid_misclass            0.11737
2018-08-08 12:17:19,923 INFO : runtime                   3.76820
2018-08-08 12:17:19,924 INFO :
2018-08-08 12:17:22,290 INFO : Time only for training updates: 1.94s
2018-08-08 12:17:23,729 INFO : Epoch 25
2018-08-08 12:17:23,730 INFO : train_loss                0.53584
2018-08-08 12:17:23,731 INFO : valid_loss                0.46072
2018-08-08 12:17:23,732 INFO : train_misclass            0.21275
2018-08-08 12:17:23,733 INFO : valid_misclass            0.12676
2018-08-08 12:17:23,734 INFO : runtime                   3.81273
2018-08-08 12:17:23,740 INFO :
2018-08-08 12:17:26,109 INFO : Time only for training updates: 1.95s
2018-08-08 12:17:27,548 INFO : Epoch 26
2018-08-08 12:17:27,549 INFO : train_loss                0.52778
2018-08-08 12:17:27,550 INFO : valid_loss                0.46177
2018-08-08 12:17:27,553 INFO : train_misclass            0.20056
2018-08-08 12:17:27,555 INFO : valid_misclass            0.13146
2018-08-08 12:17:27,556 INFO : runtime                   3.81958
2018-08-08 12:17:27,558 INFO :
2018-08-08 12:17:29,935 INFO : Time only for training updates: 1.95s
2018-08-08 12:17:31,376 INFO : Epoch 27
2018-08-08 12:17:31,378 INFO : train_loss                0.52820
2018-08-08 12:17:31,378 INFO : valid_loss                0.46491
2018-08-08 12:17:31,379 INFO : train_misclass            0.19822
2018-08-08 12:17:31,380 INFO : valid_misclass            0.11737
2018-08-08 12:17:31,381 INFO : runtime                   3.82546
2018-08-08 12:17:31,382 INFO :
2018-08-08 12:17:33,765 INFO : Time only for training updates: 1.95s
2018-08-08 12:17:35,211 INFO : Epoch 28
2018-08-08 12:17:35,212 INFO : train_loss                0.52475
2018-08-08 12:17:35,213 INFO : valid_loss                0.46116
2018-08-08 12:17:35,214 INFO : train_misclass            0.19166
2018-08-08 12:17:35,216 INFO : valid_misclass            0.11737
2018-08-08 12:17:35,217 INFO : runtime                   3.83004
2018-08-08 12:17:35,218 INFO :
2018-08-08 12:17:37,594 INFO : Time only for training updates: 1.95s
2018-08-08 12:17:39,032 INFO : Epoch 29
2018-08-08 12:17:39,034 INFO : train_loss                0.52271
2018-08-08 12:17:39,034 INFO : valid_loss                0.46164
2018-08-08 12:17:39,037 INFO : train_misclass            0.18978
2018-08-08 12:17:39,039 INFO : valid_misclass            0.11737
2018-08-08 12:17:39,042 INFO : runtime                   3.82876
2018-08-08 12:17:39,042 INFO :
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[6]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;braindecode.experiments.experiment.Experiment at 0x7f676c42b2b0&gt;
</pre></div>
</div>
</div>
</div>
<div class="section" id="Compute-correlation:-amplitude-perturbation---prediction-change">
<h2>Compute correlation: amplitude perturbation - prediction change<a class="headerlink" href="#Compute-correlation:-amplitude-perturbation---prediction-change" title="Permalink to this headline">¶</a></h2>
<p>First collect all batches and concatenate them into one array of
examples:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.datautil.iterators</span> <span class="k">import</span> <span class="n">CropsFromTrialsIterator</span>
<span class="kn">from</span> <span class="nn">braindecode.torch_ext.util</span> <span class="k">import</span> <span class="n">np_to_var</span>
<span class="n">test_input</span> <span class="o">=</span> <span class="n">np_to_var</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="n">input_time_length</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="k">if</span> <span class="n">cuda</span><span class="p">:</span>
    <span class="n">test_input</span> <span class="o">=</span> <span class="n">test_input</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">network</span><span class="p">(</span><span class="n">test_input</span><span class="p">)</span>
<span class="n">n_preds_per_input</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">iterator</span> <span class="o">=</span> <span class="n">CropsFromTrialsIterator</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span><span class="n">input_time_length</span><span class="o">=</span><span class="n">input_time_length</span><span class="p">,</span>
                                  <span class="n">n_preds_per_input</span><span class="o">=</span><span class="n">n_preds_per_input</span><span class="p">)</span>

<span class="n">train_batches</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">iterator</span><span class="o">.</span><span class="n">get_batches</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="n">train_X_batches</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">train_batches</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Next, create a prediction function that wraps the model prediction
function and returns the predictions as numpy arrays. We use the
predition before the softmax, so we create a new module with all the
layers of the old until before the softmax.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">torch</span> <span class="k">import</span> <span class="n">nn</span>
<span class="kn">from</span> <span class="nn">braindecode.torch_ext.util</span> <span class="k">import</span> <span class="n">var_to_np</span>
<span class="kn">import</span> <span class="nn">torch</span> <span class="k">as</span> <span class="nn">th</span>
<span class="n">new_model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">module</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">named_children</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;softmax&#39;</span><span class="p">:</span> <span class="k">break</span>
    <span class="n">new_model</span><span class="o">.</span><span class="n">add_module</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">module</span><span class="p">)</span>

<span class="n">new_model</span><span class="o">.</span><span class="n">eval</span><span class="p">();</span>
<span class="n">pred_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">var_to_np</span><span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">new_model</span><span class="p">(</span><span class="n">np_to_var</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">cuda</span><span class="p">())[:,:,:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.visualization.perturbation</span> <span class="k">import</span> <span class="n">compute_amplitude_prediction_correlations</span>


<span class="n">amp_pred_corrs</span> <span class="o">=</span> <span class="n">compute_amplitude_prediction_correlations</span><span class="p">(</span><span class="n">pred_fn</span><span class="p">,</span> <span class="n">train_X_batches</span><span class="p">,</span> <span class="n">n_iterations</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                                         <span class="n">batch_size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2018-08-08 12:19:10,049 INFO : Compute original predictions...
2018-08-08 12:19:27,871 INFO : Iteration 0...
2018-08-08 12:19:27,873 INFO : Sample perturbation...
2018-08-08 12:19:37,305 INFO : Compute perturbed complex inputs...
2018-08-08 12:19:50,788 INFO : Compute perturbed real inputs...
2018-08-08 12:20:08,863 INFO : Compute new predictions...
2018-08-08 12:20:09,609 INFO : Layer 0...
2018-08-08 12:20:09,610 INFO : Compute activation difference...
2018-08-08 12:20:09,611 INFO : Compute correlation...
2018-08-08 12:20:13,067 INFO : Iteration 1...
2018-08-08 12:20:13,068 INFO : Sample perturbation...
2018-08-08 12:20:20,858 INFO : Compute perturbed complex inputs...
2018-08-08 12:20:30,561 INFO : Compute perturbed real inputs...
2018-08-08 12:20:45,390 INFO : Compute new predictions...
2018-08-08 12:20:46,164 INFO : Layer 0...
2018-08-08 12:20:46,165 INFO : Compute activation difference...
2018-08-08 12:20:46,166 INFO : Compute correlation...
2018-08-08 12:20:49,880 INFO : Iteration 2...
2018-08-08 12:20:49,880 INFO : Sample perturbation...
2018-08-08 12:20:59,277 INFO : Compute perturbed complex inputs...
2018-08-08 12:21:11,041 INFO : Compute perturbed real inputs...
2018-08-08 12:21:32,809 INFO : Compute new predictions...
2018-08-08 12:21:33,628 INFO : Layer 0...
2018-08-08 12:21:33,629 INFO : Compute activation difference...
2018-08-08 12:21:33,631 INFO : Compute correlation...
2018-08-08 12:21:37,634 INFO : Iteration 3...
2018-08-08 12:21:37,635 INFO : Sample perturbation...
2018-08-08 12:21:47,688 INFO : Compute perturbed complex inputs...
2018-08-08 12:21:59,979 INFO : Compute perturbed real inputs...
2018-08-08 12:22:21,661 INFO : Compute new predictions...
2018-08-08 12:22:22,430 INFO : Layer 0...
2018-08-08 12:22:22,431 INFO : Compute activation difference...
2018-08-08 12:22:22,432 INFO : Compute correlation...
2018-08-08 12:22:26,532 INFO : Iteration 4...
2018-08-08 12:22:26,533 INFO : Sample perturbation...
2018-08-08 12:22:36,511 INFO : Compute perturbed complex inputs...
2018-08-08 12:22:48,632 INFO : Compute perturbed real inputs...
2018-08-08 12:23:05,148 INFO : Compute new predictions...
2018-08-08 12:23:05,920 INFO : Layer 0...
2018-08-08 12:23:05,921 INFO : Compute activation difference...
2018-08-08 12:23:05,922 INFO : Compute correlation...
2018-08-08 12:23:08,494 INFO : Iteration 5...
2018-08-08 12:23:08,495 INFO : Sample perturbation...
2018-08-08 12:23:17,066 INFO : Compute perturbed complex inputs...
2018-08-08 12:23:29,459 INFO : Compute perturbed real inputs...
2018-08-08 12:23:51,135 INFO : Compute new predictions...
2018-08-08 12:23:51,910 INFO : Layer 0...
2018-08-08 12:23:51,911 INFO : Compute activation difference...
2018-08-08 12:23:51,912 INFO : Compute correlation...
2018-08-08 12:23:52,788 INFO : Iteration 6...
2018-08-08 12:23:52,789 INFO : Sample perturbation...
2018-08-08 12:23:59,554 INFO : Compute perturbed complex inputs...
2018-08-08 12:24:11,074 INFO : Compute perturbed real inputs...
2018-08-08 12:24:31,349 INFO : Compute new predictions...
2018-08-08 12:24:32,134 INFO : Layer 0...
2018-08-08 12:24:32,135 INFO : Compute activation difference...
2018-08-08 12:24:32,135 INFO : Compute correlation...
2018-08-08 12:24:36,217 INFO : Iteration 7...
2018-08-08 12:24:36,218 INFO : Sample perturbation...
2018-08-08 12:24:45,191 INFO : Compute perturbed complex inputs...
2018-08-08 12:24:55,820 INFO : Compute perturbed real inputs...
2018-08-08 12:25:13,979 INFO : Compute new predictions...
2018-08-08 12:25:14,761 INFO : Layer 0...
2018-08-08 12:25:14,762 INFO : Compute activation difference...
2018-08-08 12:25:14,763 INFO : Compute correlation...
2018-08-08 12:25:17,312 INFO : Iteration 8...
2018-08-08 12:25:17,313 INFO : Sample perturbation...
2018-08-08 12:25:25,635 INFO : Compute perturbed complex inputs...
2018-08-08 12:25:37,586 INFO : Compute perturbed real inputs...
2018-08-08 12:25:59,839 INFO : Compute new predictions...
2018-08-08 12:26:00,618 INFO : Layer 0...
2018-08-08 12:26:00,619 INFO : Compute activation difference...
2018-08-08 12:26:00,620 INFO : Compute correlation...
2018-08-08 12:26:01,544 INFO : Iteration 9...
2018-08-08 12:26:01,545 INFO : Sample perturbation...
2018-08-08 12:26:07,447 INFO : Compute perturbed complex inputs...
2018-08-08 12:26:17,042 INFO : Compute perturbed real inputs...
2018-08-08 12:26:31,921 INFO : Compute new predictions...
2018-08-08 12:26:32,650 INFO : Layer 0...
2018-08-08 12:26:32,651 INFO : Compute activation difference...
2018-08-08 12:26:32,653 INFO : Compute correlation...
2018-08-08 12:26:35,548 INFO : Iteration 10...
2018-08-08 12:26:35,549 INFO : Sample perturbation...
2018-08-08 12:26:42,538 INFO : Compute perturbed complex inputs...
2018-08-08 12:26:51,004 INFO : Compute perturbed real inputs...
2018-08-08 12:27:04,210 INFO : Compute new predictions...
2018-08-08 12:27:04,980 INFO : Layer 0...
2018-08-08 12:27:04,981 INFO : Compute activation difference...
2018-08-08 12:27:04,982 INFO : Compute correlation...
2018-08-08 12:27:07,018 INFO : Iteration 11...
2018-08-08 12:27:07,019 INFO : Sample perturbation...
2018-08-08 12:27:14,177 INFO : Compute perturbed complex inputs...
2018-08-08 12:27:24,518 INFO : Compute perturbed real inputs...
2018-08-08 12:27:40,668 INFO : Compute new predictions...
2018-08-08 12:27:41,417 INFO : Layer 0...
2018-08-08 12:27:41,418 INFO : Compute activation difference...
2018-08-08 12:27:41,419 INFO : Compute correlation...
</pre></div></div>
</div>
</div>
<div class="section" id="Plot-correlations">
<h2>Plot correlations<a class="headerlink" href="#Plot-correlations" title="Permalink to this headline">¶</a></h2>
<p>Pick out one frequency range and mean correlations within that frequency
range to make a scalp plot. Here we use the alpha frequency range.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">amp_pred_corrs</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[19]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>(64, 226, 2)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>

<span></span><span class="n">fs</span> <span class="o">=</span> <span class="n">epoched</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;sfreq&#39;</span><span class="p">]</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">train_X_batches</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">d</span><span class="o">=</span><span class="mf">1.0</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
<span class="n">start_freq</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">stop_freq</span> <span class="o">=</span> <span class="mi">14</span>

<span class="n">i_start</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span><span class="n">start_freq</span><span class="p">)</span>
<span class="n">i_stop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">stop_freq</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

<span class="n">freq_corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">amp_pred_corrs</span><span class="p">[:,</span><span class="n">i_start</span><span class="p">:</span><span class="n">i_stop</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now get approximate positions of the channels in the 10-20 system.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.datasets.sensor_positions</span> <span class="k">import</span> <span class="n">get_channelpos</span><span class="p">,</span> <span class="n">CHANNEL_10_20_APPROX</span>

<span class="n">ch_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">epoched</span><span class="o">.</span><span class="n">ch_names</span><span class="p">]</span>
<span class="n">positions</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_channelpos</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">CHANNEL_10_20_APPROX</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">ch_names</span><span class="p">]</span>
<span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="Plot-with-MNE">
<h3>Plot with MNE<a class="headerlink" href="#Plot-with-MNE" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">cm</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">max_abs_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">freq_corr</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">class_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Left Hand&#39;</span><span class="p">,</span> <span class="s1">&#39;Right Hand&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i_class</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i_class</span><span class="p">]</span>
    <span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_topomap</span><span class="p">(</span><span class="n">freq_corr</span><span class="p">[:,</span><span class="n">i_class</span><span class="p">],</span> <span class="n">positions</span><span class="p">,</span>
                     <span class="n">vmin</span><span class="o">=-</span><span class="n">max_abs_val</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">max_abs_val</span><span class="p">,</span> <span class="n">contours</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">class_names</span><span class="p">[</span><span class="n">i_class</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_visualization_Perturbation_27_0.png" src="../../_images/notebooks_visualization_Perturbation_27_0.png" />
</div>
</div>
</div>
<div class="section" id="Plot-with-Braindecode">
<h3>Plot with Braindecode<a class="headerlink" href="#Plot-with-Braindecode" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">braindecode.visualization.plot</span> <span class="k">import</span> <span class="n">ax_scalp</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">class_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Left Hand&#39;</span><span class="p">,</span> <span class="s1">&#39;Right Hand&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i_class</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i_class</span><span class="p">]</span>
    <span class="n">ax_scalp</span><span class="p">(</span><span class="n">freq_corr</span><span class="p">[:,</span><span class="n">i_class</span><span class="p">],</span> <span class="n">ch_names</span><span class="p">,</span> <span class="n">chan_pos_list</span><span class="o">=</span><span class="n">CHANNEL_10_20_APPROX</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=-</span><span class="n">max_abs_val</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">max_abs_val</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">class_names</span><span class="p">[</span><span class="n">i_class</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_visualization_Perturbation_29_0.png" src="../../_images/notebooks_visualization_Perturbation_29_0.png" />
</div>
</div>
<p>From these plots we can see the ConvNet clearly learned to use the
lateralized response in the alpha band. Note that the positive
correlations for the left hand on the left side do not imply an increase
of alpha activity for the left hand in the data, see <a class="reference external" href="https://arxiv.org/abs/1703.05051">Deep learning with
convolutional neural networks for EEG decoding and
visualization</a> Result 12 for some
notes on interpretability.</p>
</div>
</div>
<div class="section" id="Dataset-references">
<h2>Dataset references<a class="headerlink" href="#Dataset-references" title="Permalink to this headline">¶</a></h2>
<p>This dataset was created and contributed to PhysioNet by the developers
of the <a class="reference external" href="http://www.schalklab.org/research/bci2000">BCI2000</a>
instrumentation system, which they used in making these recordings. The
system is described in:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Schalk</span><span class="p">,</span> <span class="n">G</span><span class="o">.</span><span class="p">,</span> <span class="n">McFarland</span><span class="p">,</span> <span class="n">D</span><span class="o">.</span><span class="n">J</span><span class="o">.</span><span class="p">,</span> <span class="n">Hinterberger</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="p">,</span> <span class="n">Birbaumer</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="p">,</span> <span class="n">Wolpaw</span><span class="p">,</span> <span class="n">J</span><span class="o">.</span><span class="n">R</span><span class="o">.</span> <span class="p">(</span><span class="mi">2004</span><span class="p">)</span> <span class="n">BCI2000</span><span class="p">:</span> <span class="n">A</span> <span class="n">General</span><span class="o">-</span><span class="n">Purpose</span> <span class="n">Brain</span><span class="o">-</span><span class="n">Computer</span> <span class="n">Interface</span> <span class="p">(</span><span class="n">BCI</span><span class="p">)</span> <span class="n">System</span><span class="o">.</span> <span class="n">IEEE</span> <span class="n">TBME</span> <span class="mi">51</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span><span class="mi">1034</span><span class="o">-</span><span class="mf">1043.</span>
</pre></div>
</div>
<p><a class="reference external" href="https://physionet.org/physiobank/">PhysioBank</a> is a large and
growing archive of well-characterized digital recordings of physiologic
signals and related data for use by the biomedical research community
and further described in:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Goldberger</span> <span class="n">AL</span><span class="p">,</span> <span class="n">Amaral</span> <span class="n">LAN</span><span class="p">,</span> <span class="n">Glass</span> <span class="n">L</span><span class="p">,</span> <span class="n">Hausdorff</span> <span class="n">JM</span><span class="p">,</span> <span class="n">Ivanov</span> <span class="n">PCh</span><span class="p">,</span> <span class="n">Mark</span> <span class="n">RG</span><span class="p">,</span> <span class="n">Mietus</span> <span class="n">JE</span><span class="p">,</span> <span class="n">Moody</span> <span class="n">GB</span><span class="p">,</span> <span class="n">Peng</span> <span class="n">C</span><span class="o">-</span><span class="n">K</span><span class="p">,</span> <span class="n">Stanley</span> <span class="n">HE</span><span class="o">.</span> <span class="p">(</span><span class="mi">2000</span><span class="p">)</span> <span class="n">PhysioBank</span><span class="p">,</span> <span class="n">PhysioToolkit</span><span class="p">,</span> <span class="ow">and</span> <span class="n">PhysioNet</span><span class="p">:</span> <span class="n">Components</span> <span class="n">of</span> <span class="n">a</span> <span class="n">New</span> <span class="n">Research</span> <span class="n">Resource</span> <span class="k">for</span> <span class="n">Complex</span> <span class="n">Physiologic</span> <span class="n">Signals</span><span class="o">.</span> <span class="n">Circulation</span> <span class="mi">101</span><span class="p">(</span><span class="mi">23</span><span class="p">):</span><span class="n">e215</span><span class="o">-</span><span class="n">e220</span><span class="o">.</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../source/braindecode.datautil.html" class="btn btn-neutral float-right" title="braindecode.datautil package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../Cropped_Manual_Training_Loop.html" class="btn btn-neutral" title="Cropped Manual Training Loop" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Robin Tibor Schirrmeister.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.4.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>